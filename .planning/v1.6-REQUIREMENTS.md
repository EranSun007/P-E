# Requirements: P&E Manager v1.6

**Defined:** 2026-01-29
**Core Value:** Single dashboard showing health and status across all team tools without switching contexts

## v1.6 Requirements

Requirements for TeamSync Integration milestone. Each maps to roadmap phases.

### Database Schema

- [ ] **DB-01**: Extend projects table with sync item columns (category, sync_status, team_department, assigned_to_id, sprint_id, week_start_date, status_history JSONB, archived, is_sync_item, display_order)
- [ ] **DB-02**: Extend tasks table with subtask columns (project_id FK with CASCADE DELETE, is_subtask, completed, display_order)
- [ ] **DB-03**: Extend team_members table with display_order and updated_date
- [ ] **DB-04**: Create sync_settings table for user preferences (sprint config, default view, default team)
- [ ] **DB-05**: Add indexes for sync-specific queries (category, team_department, sync_status, archived, is_sync_item, project_id, is_subtask)
- [ ] **DB-06**: Add updated_date triggers for projects, team_members, sync_settings

### Backend Services

- [ ] **SVC-01**: getSyncItems retrieves projects where is_sync_item=true with team/category filtering
- [ ] **SVC-02**: createSyncItem creates project with is_sync_item=true and initial status_history
- [ ] **SVC-03**: updateSyncItem updates sync item with full change tracking in status_history JSONB
- [ ] **SVC-04**: deleteSyncItem removes sync item and cascades to subtasks
- [ ] **SVC-05**: getArchivedSyncItems returns archived=true items with date filtering
- [ ] **SVC-06**: getArchivedSyncItemsCount returns count for badge display
- [ ] **SVC-07**: restoreSyncItem sets archived=false and logs restore in status_history
- [ ] **SVC-08**: getSubtasks retrieves tasks where is_subtask=true and project_id matches
- [ ] **SVC-09**: createSubtask creates task with is_subtask=true, auto-incrementing display_order
- [ ] **SVC-10**: updateSubtask updates title/completed with automatic status mapping
- [ ] **SVC-11**: deleteSubtask removes subtask
- [ ] **SVC-12**: reorderSubtasks updates display_order for ordered list of subtask IDs
- [ ] **SVC-13**: getSyncSettings returns user sync preferences or defaults
- [ ] **SVC-14**: updateSyncSettings upserts user sync preferences

### REST API

- [ ] **API-01**: GET /api/sync returns sync items with teamDepartment, category, archived query params
- [ ] **API-02**: POST /api/sync creates new sync item
- [ ] **API-03**: GET /api/sync/:id returns single sync item
- [ ] **API-04**: PUT /api/sync/:id updates sync item
- [ ] **API-05**: DELETE /api/sync/:id deletes sync item
- [ ] **API-06**: GET /api/sync/archived returns archived sync items with date filters
- [ ] **API-07**: GET /api/sync/archived/count returns archived count for badge
- [ ] **API-08**: PUT /api/sync/:id/restore restores archived sync item
- [ ] **API-09**: GET /api/sync/:itemId/subtasks returns subtasks for sync item
- [ ] **API-10**: POST /api/sync/:itemId/subtasks creates subtask
- [ ] **API-11**: PUT /api/sync/:itemId/subtasks/:subtaskId updates subtask
- [ ] **API-12**: DELETE /api/sync/:itemId/subtasks/:subtaskId deletes subtask
- [ ] **API-13**: PUT /api/sync/:itemId/subtasks/reorder updates subtask order
- [ ] **API-14**: GET /api/sync/settings returns user sync settings
- [ ] **API-15**: PUT /api/sync/settings updates user sync settings

### Frontend State

- [ ] **CTX-01**: SyncContext provides sync items state and CRUD operations
- [ ] **CTX-02**: SyncContext provides itemsByCategory computed grouping
- [ ] **CTX-03**: SyncContext provides currentTeam state for department filtering
- [ ] **CTX-04**: SyncContext provides archivedItems and archivedCount state
- [ ] **CTX-05**: SyncContext exports TEAM_DEPARTMENTS, CATEGORIES, SYNC_STATUSES constants
- [ ] **CTX-06**: API client wraps all /api/sync endpoints

### Frontend UI

- [ ] **UI-01**: TeamSync page accessible from main navigation
- [ ] **UI-02**: Team department tabs filter items (All Teams, Metering, Reporting)
- [ ] **UI-03**: Kanban board shows 4 category columns (Goals, Blockers, Dependencies, Emphasis)
- [ ] **UI-04**: Sync item card displays title, sync_status badge, assignee name, subtask count
- [ ] **UI-05**: Clicking card opens detail/edit modal
- [ ] **UI-06**: Create button opens modal for new sync item
- [ ] **UI-07**: Modal includes category dropdown (Goals, Blockers, Dependencies, Emphasis)
- [ ] **UI-08**: Modal includes team department dropdown (Metering, Reporting, Both)
- [ ] **UI-09**: Modal includes sync status dropdown (New, In Progress, Resolved, Blocked)
- [ ] **UI-10**: Modal includes team member assignment dropdown (from existing team_members)
- [ ] **UI-11**: Modal includes sprint dropdown (from releaseCycles.js)
- [ ] **UI-12**: Modal includes subtask management section
- [ ] **UI-13**: Subtask list shows checkboxes for completion toggle
- [ ] **UI-14**: Subtask list supports drag-and-drop reordering
- [ ] **UI-15**: Subtask input allows adding new subtasks
- [ ] **UI-16**: Archive button in header shows archived count badge
- [ ] **UI-17**: Archive modal lists archived items with date filter
- [ ] **UI-18**: Archive modal allows restore action per item
- [ ] **UI-19**: Resolving an item (status=resolved) auto-archives it

## Future Requirements (v1.7+)

Deferred to future milestone. Tracked but not in current roadmap.

### Gantt View

- **GANTT-01**: Gantt view option in view toggle
- **GANTT-02**: 52-week timeline grid using releaseCycles
- **GANTT-03**: Items positioned by sprint_id on timeline
- **GANTT-04**: Drag to move items between sprints

### Status History

- **HIST-01**: Status history timeline component
- **HIST-02**: Expandable history panel on item card/modal
- **HIST-03**: Visual diff of changes (field A changed from X to Y)

### Sync Settings UI

- **SET-01**: Settings modal accessible from TeamSync page
- **SET-02**: Configure first sprint number and start date
- **SET-03**: Configure sprint duration (weeks)
- **SET-04**: Configure default view (kanban/gantt)
- **SET-05**: Configure default team filter

## Out of Scope

Explicitly excluded. Documented to prevent scope creep.

| Feature | Reason |
|---------|--------|
| Data migration from standalone TeamSync | Fresh start, no legacy data |
| Separate sync_items/subtasks tables | Reuse projects/tasks with flags |
| Real-time collaborative editing | Single-user updates sufficient |
| Item drag between categories | Edit via modal, not Kanban drag |
| Gantt view | Defer to v1.7 for scope control |
| Custom category creation | Fixed 4 categories (goals, blockers, dependencies, emphasis) |
| Bulk operations | Single item CRUD sufficient for MVP |

## Traceability

Which phases cover which requirements. Updated during roadmap creation.

| Requirement | Phase | Status |
|-------------|-------|--------|
| DB-01 | Phase 23 | Complete |
| DB-02 | Phase 23 | Complete |
| DB-03 | Phase 23 | Complete |
| DB-04 | Phase 23 | Complete |
| DB-05 | Phase 23 | Complete |
| DB-06 | Phase 23 | Complete |
| SVC-01 | Phase 23 | Complete |
| SVC-02 | Phase 23 | Complete |
| SVC-03 | Phase 23 | Complete |
| SVC-04 | Phase 23 | Complete |
| SVC-05 | Phase 23 | Complete |
| SVC-06 | Phase 23 | Complete |
| SVC-07 | Phase 23 | Complete |
| SVC-08 | Phase 23 | Complete |
| SVC-09 | Phase 23 | Complete |
| SVC-10 | Phase 23 | Complete |
| SVC-11 | Phase 23 | Complete |
| SVC-12 | Phase 23 | Complete |
| SVC-13 | Phase 23 | Complete |
| SVC-14 | Phase 23 | Complete |
| API-01 | Phase 24 | Complete |
| API-02 | Phase 24 | Complete |
| API-03 | Phase 24 | Complete |
| API-04 | Phase 24 | Complete |
| API-05 | Phase 24 | Complete |
| API-06 | Phase 24 | Complete |
| API-07 | Phase 24 | Complete |
| API-08 | Phase 24 | Complete |
| API-09 | Phase 24 | Complete |
| API-10 | Phase 24 | Complete |
| API-11 | Phase 24 | Complete |
| API-12 | Phase 24 | Complete |
| API-13 | Phase 24 | Complete |
| API-14 | Phase 24 | Complete |
| API-15 | Phase 24 | Complete |
| CTX-01 | Phase 25 | Complete |
| CTX-02 | Phase 25 | Complete |
| CTX-03 | Phase 25 | Complete |
| CTX-04 | Phase 25 | Complete |
| CTX-05 | Phase 25 | Complete |
| CTX-06 | Phase 25 | Complete |
| UI-01 | Phase 25 | Complete |
| UI-02 | Phase 25 | Complete |
| UI-03 | Phase 25 | Complete |
| UI-04 | Phase 25 | Complete |
| UI-05 | Phase 26 | Pending |
| UI-06 | Phase 26 | Pending |
| UI-07 | Phase 26 | Pending |
| UI-08 | Phase 26 | Pending |
| UI-09 | Phase 26 | Pending |
| UI-10 | Phase 26 | Pending |
| UI-11 | Phase 26 | Pending |
| UI-12 | Phase 26 | Pending |
| UI-13 | Phase 26 | Pending |
| UI-14 | Phase 26 | Pending |
| UI-15 | Phase 26 | Pending |
| UI-16 | Phase 27 | Pending |
| UI-17 | Phase 27 | Pending |
| UI-18 | Phase 27 | Pending |
| UI-19 | Phase 27 | Pending |

**Coverage:**
- v1.6 requirements: 59 total
- Mapped to phases: 59
- Unmapped: 0

---
*Requirements defined: 2026-01-29*
*Last updated: 2026-01-29 after Phase 25 completion*
