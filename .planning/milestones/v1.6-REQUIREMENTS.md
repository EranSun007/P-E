# Requirements Archive: v1.6 TeamSync Integration

**Archived:** 2026-01-29
**Status:** SHIPPED

This is the archived requirements specification for v1.6.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

# Requirements: P&E Manager v1.6

**Defined:** 2026-01-29
**Core Value:** Single dashboard showing health and status across all team tools without switching contexts

## v1.6 Requirements

Requirements for TeamSync Integration milestone. Each maps to roadmap phases.

### Database Schema

- [x] **DB-01**: Extend projects table with sync item columns (category, sync_status, team_department, assigned_to_id, sprint_id, week_start_date, status_history JSONB, archived, is_sync_item, display_order)
- [x] **DB-02**: Extend tasks table with subtask columns (project_id FK with CASCADE DELETE, is_subtask, completed, display_order)
- [x] **DB-03**: Extend team_members table with display_order and updated_date
- [x] **DB-04**: Create sync_settings table for user preferences (sprint config, default view, default team)
- [x] **DB-05**: Add indexes for sync-specific queries (category, team_department, sync_status, archived, is_sync_item, project_id, is_subtask)
- [x] **DB-06**: Add updated_date triggers for projects, team_members, sync_settings

### Backend Services

- [x] **SVC-01**: getSyncItems retrieves projects where is_sync_item=true with team/category filtering
- [x] **SVC-02**: createSyncItem creates project with is_sync_item=true and initial status_history
- [x] **SVC-03**: updateSyncItem updates sync item with full change tracking in status_history JSONB
- [x] **SVC-04**: deleteSyncItem removes sync item and cascades to subtasks
- [x] **SVC-05**: getArchivedSyncItems returns archived=true items with date filtering
- [x] **SVC-06**: getArchivedSyncItemsCount returns count for badge display
- [x] **SVC-07**: restoreSyncItem sets archived=false and logs restore in status_history
- [x] **SVC-08**: getSubtasks retrieves tasks where is_subtask=true and project_id matches
- [x] **SVC-09**: createSubtask creates task with is_subtask=true, auto-incrementing display_order
- [x] **SVC-10**: updateSubtask updates title/completed with automatic status mapping
- [x] **SVC-11**: deleteSubtask removes subtask
- [x] **SVC-12**: reorderSubtasks updates display_order for ordered list of subtask IDs
- [x] **SVC-13**: getSyncSettings returns user sync preferences or defaults
- [x] **SVC-14**: updateSyncSettings upserts user sync preferences

### REST API

- [x] **API-01**: GET /api/sync returns sync items with teamDepartment, category, archived query params
- [x] **API-02**: POST /api/sync creates new sync item
- [x] **API-03**: GET /api/sync/:id returns single sync item
- [x] **API-04**: PUT /api/sync/:id updates sync item
- [x] **API-05**: DELETE /api/sync/:id deletes sync item
- [x] **API-06**: GET /api/sync/archived returns archived sync items with date filters
- [x] **API-07**: GET /api/sync/archived/count returns archived count for badge
- [x] **API-08**: PUT /api/sync/:id/restore restores archived sync item
- [x] **API-09**: GET /api/sync/:itemId/subtasks returns subtasks for sync item
- [x] **API-10**: POST /api/sync/:itemId/subtasks creates subtask
- [x] **API-11**: PUT /api/sync/:itemId/subtasks/:subtaskId updates subtask
- [x] **API-12**: DELETE /api/sync/:itemId/subtasks/:subtaskId deletes subtask
- [x] **API-13**: PUT /api/sync/:itemId/subtasks/reorder updates subtask order
- [x] **API-14**: GET /api/sync/settings returns user sync settings
- [x] **API-15**: PUT /api/sync/settings updates user sync settings

### Frontend State

- [x] **CTX-01**: SyncContext provides sync items state and CRUD operations
- [x] **CTX-02**: SyncContext provides itemsByCategory computed grouping
- [x] **CTX-03**: SyncContext provides currentTeam state for department filtering
- [x] **CTX-04**: SyncContext provides archivedItems and archivedCount state
- [x] **CTX-05**: SyncContext exports TEAM_DEPARTMENTS, CATEGORIES, SYNC_STATUSES constants
- [x] **CTX-06**: API client wraps all /api/sync endpoints

### Frontend UI

- [x] **UI-01**: TeamSync page accessible from main navigation
- [x] **UI-02**: Team department tabs filter items (All Teams, Metering, Reporting)
- [x] **UI-03**: Kanban board shows 4 category columns (Goals, Blockers, Dependencies, Emphasis)
- [x] **UI-04**: Sync item card displays title, sync_status badge, assignee name, subtask count
- [x] **UI-05**: Clicking card opens detail/edit modal
- [x] **UI-06**: Create button opens modal for new sync item
- [x] **UI-07**: Modal includes category dropdown (Goals, Blockers, Dependencies, Emphasis)
- [x] **UI-08**: Modal includes team department dropdown (Metering, Reporting, Both)
- [x] **UI-09**: Modal includes sync status dropdown (New, In Progress, Resolved, Blocked)
- [x] **UI-10**: Modal includes team member assignment dropdown (from existing team_members)
- [x] **UI-11**: Modal includes sprint dropdown (from releaseCycles.js)
- [x] **UI-12**: Modal includes subtask management section
- [x] **UI-13**: Subtask list shows checkboxes for completion toggle
- [x] **UI-14**: Subtask list supports drag-and-drop reordering
- [x] **UI-15**: Subtask input allows adding new subtasks
- [x] **UI-16**: Archive button in header shows archived count badge
- [x] **UI-17**: Archive modal lists archived items with date filter
- [x] **UI-18**: Archive modal allows restore action per item
- [x] **UI-19**: Resolving an item (status=done) auto-archives it

## Future Requirements (v1.7+)

Deferred to future milestone.

### Gantt View

- **GANTT-01**: Gantt view option in view toggle
- **GANTT-02**: 52-week timeline grid using releaseCycles
- **GANTT-03**: Items positioned by sprint_id on timeline
- **GANTT-04**: Drag to move items between sprints

### Status History

- **HIST-01**: Status history timeline component
- **HIST-02**: Expandable history panel on item card/modal
- **HIST-03**: Visual diff of changes (field A changed from X to Y)

### Sync Settings UI

- **SET-01**: Settings modal accessible from TeamSync page
- **SET-02**: Configure first sprint number and start date
- **SET-03**: Configure sprint duration (weeks)
- **SET-04**: Configure default view (kanban/gantt)
- **SET-05**: Configure default team filter

## Out of Scope

Explicitly excluded. Documented to prevent scope creep.

| Feature | Reason |
|---------|--------|
| Data migration from standalone TeamSync | Fresh start, no legacy data |
| Separate sync_items/subtasks tables | Reuse projects/tasks with flags |
| Real-time collaborative editing | Single-user updates sufficient |
| Item drag between categories | Edit via modal, not Kanban drag |
| Gantt view | Defer to v1.7 for scope control |
| Custom category creation | Fixed 4 categories (goals, blockers, dependencies, emphasis) |
| Bulk operations | Single item CRUD sufficient for MVP |

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| DB-01 to DB-06 | Phase 23 | Complete |
| SVC-01 to SVC-14 | Phase 23 | Complete |
| API-01 to API-15 | Phase 24 | Complete |
| CTX-01 to CTX-06 | Phase 25 | Complete |
| UI-01 to UI-04 | Phase 25 | Complete |
| UI-05 to UI-15 | Phase 26 | Complete |
| UI-16 to UI-19 | Phase 27 | Complete |

**Coverage:**
- v1.6 requirements: 59 total
- Shipped: 59
- Unmapped: 0

---

## Milestone Summary

**Shipped:** 59 of 59 v1.6 requirements
**Adjusted:** None
**Dropped:** None

---
*Archived: 2026-01-29 as part of v1.6 milestone completion*
