const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TaskCreationForm-CBLLNLQi.js","assets/chunk-WPKCbDK8.js","assets/chunk-BKwDNIOR.js","assets/chunk-KzYfAQy1.js","assets/index-B5nMAt-E.js","assets/chunk-DGs6foQ1.js","assets/chunk-BwuEqr1N.js","assets/index-DOtIHvxS.css","assets/chunk-CRMqQcWA.js","assets/chunk-BRlPmrL-.js","assets/chunk-zVvAqB5a.js","assets/chunk-BdHZTqfh.js","assets/chunk-6GuMELXD.js"])))=>i.map(i=>d[i]);
import{g as Z,x as k,T as O,S as ee,M as se,C as c,j as d,B as m,h as f,i as y,s as ae,_ as te}from"./index-B5nMAt-E.js";import{j as e,N as le,aI as re,W as z,B as ne,b8 as ie,b9 as ce,Q as de,_ as oe,D as me}from"./chunk-WPKCbDK8.js";import{k as xe,a as r,L as he}from"./chunk-BKwDNIOR.js";import{I as je}from"./chunk-KzYfAQy1.js";import{B as ue}from"./chunk-zVvAqB5a.js";import{T as pe,a as ge,b as T,c as C}from"./chunk-CqsX0BiM.js";import{S as Ne,a as fe,b as ye,c as ve,d as P}from"./chunk-CRMqQcWA.js";import{T as be}from"./chunk-CgxpU_Nd.js";import{D as $,a as U,b as F,c as V}from"./chunk-g5LiUroS.js";import{A as we}from"./chunk-DwS1WR9n.js";import{b as x,p as h}from"./chunk-DGs6foQ1.js";import"./chunk-BwuEqr1N.js";import"./chunk-CBOE_DJY.js";import"./chunk-BJfv4D2P.js";import"./chunk-BdHZTqfh.js";import"./chunk-CQRLWZyN.js";function A({icon:j,title:n,subtitle:a,timestamp:u,variant:p="default"}){return e.jsxs("div",{className:"flex gap-4 pb-8 last:pb-0",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:Z("rounded-full p-2",p==="outline"?"border-2 border-gray-200":"bg-gray-100"),children:j}),e.jsx("div",{className:"flex-1 w-px bg-gray-200 my-2"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:n}),a&&e.jsx("div",{className:"text-sm text-gray-500",children:a}),e.jsx("div",{className:"text-xs text-gray-400",children:u})]})]})}function Se({children:j}){return e.jsx("div",{className:"space-y-4",children:j})}const ke=r.lazy(()=>te(()=>import("./TaskCreationForm-CBLLNLQi.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12])));function He(){const[j]=xe(),n=j.get("id"),[a,u]=r.useState(null),[p,H]=r.useState([]),[v,R]=r.useState([]),[q,D]=r.useState(!0),[Q,_]=r.useState(!1),[I,W]=r.useState([]),[o,b]=r.useState([]),[G,w]=r.useState(!1);r.useState("");const[Te,M]=r.useState(null),[B,L]=r.useState(!1);r.useEffect(()=>{n&&g()},[n]);const g=async()=>{D(!0);try{const s=await k.get(n);u(s);const l=(await O.list()).filter(N=>N.project===s.name);H(l);const[i,S]=await Promise.all([ee.list(),se.list()]);W(i),R(S),s.stakeholders&&b(s.stakeholders),E(s,l)}catch(s){console.error("Error loading project data:",s)}finally{D(!1)}},E=async(s,t)=>{L(!0);try{t.filter(N=>N.status==="done").length;const l=await je(),i={...l,date:new Date().toISOString()},S=s.analyses?[...s.analyses,i]:[i];await k.update(n,{...s,analyses:S}),u(N=>({...N,analyses:S})),M(l)}catch(l){console.error("Failed to analyze project:",l),M({currentStatus:"Analysis currently unavailable",challenges:["Unable to analyze project status"],nextSteps:["Please try again later"]})}finally{L(!1)}},J=async s=>{try{await k.update(n,{...a,status:s}),u(t=>({...t,status:s})),g()}catch(t){console.error("Error updating project status:",t)}},K=async s=>{try{await O.create({...s,project:a.name}),_(!1),g()}catch(t){console.error("Error creating task:",t)}},X=async s=>{try{await k.update(n,{...a,stakeholders:s}),b(s),w(!1),g()}catch(t){console.error("Error updating stakeholders:",t)}},Y=s=>{const t={not_started:"bg-gray-100 text-gray-800",in_progress:"bg-blue-100 text-blue-800",on_hold:"bg-yellow-100 text-yellow-800",completed:"bg-green-100 text-green-800"};return t[s]||t.not_started};return q?e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-indigo-600 border-t-transparent rounded-full mx-auto"})}):a?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(he,{to:"/projects",children:e.jsxs(m,{variant:"ghost",children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),"Back to Projects"]})}),e.jsx("h1",{className:"text-3xl font-bold",children:a.name}),e.jsx(ue,{className:Y(a.status),children:a.status.replace("_"," ").toUpperCase()})]}),e.jsxs(Ne,{value:a.status,onValueChange:J,children:[e.jsx(fe,{className:"w-[180px]",children:e.jsx(ye,{placeholder:"Change Status"})}),e.jsxs(ve,{children:[e.jsx(P,{value:"not_started",children:"Not Started"}),e.jsx(P,{value:"in_progress",children:"In Progress"}),e.jsx(P,{value:"on_hold",children:"On Hold"}),e.jsx(P,{value:"completed",children:"Completed"})]})]})]}),e.jsxs(pe,{defaultValue:"overview",className:"space-y-6",children:[e.jsxs(ge,{children:[e.jsx(T,{value:"overview",children:"Overview"}),e.jsx(T,{value:"tasks",children:"Tasks"}),e.jsx(T,{value:"timeline",children:"Timeline"}),e.jsx(T,{value:"stakeholders",children:"Stakeholders"})]}),e.jsx(C,{value:"overview",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(c,{children:[e.jsx(f,{children:e.jsx(y,{children:"Project Information"})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Description"}),e.jsx("p",{className:"mt-1",children:a.description||"No description provided"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Owner"}),e.jsx("p",{className:"mt-1",children:a.owner||"No owner assigned"})]}),v.length>0&&e.jsxs("div",{className:"pt-3 border-t border-gray-200",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Add to team member agendas:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[v.slice(0,3).map(s=>e.jsx(we,{teamMemberId:s.id,teamMemberName:s.name,sourceItem:{title:`Project: ${a.name}`,description:`${a.description||""} | Status: ${a.status}${a.owner?` | Owner: ${a.owner}`:""}`,type:"project",id:a.id,status:a.status,start_date:a.start_date,end_date:a.end_date},variant:"outline",size:"sm",showAgendaAction:!0,showPersonalFileAction:!0},s.id)),v.length>3&&e.jsxs("span",{className:"text-xs text-gray-400 self-center",children:["+",v.length-3," more"]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Dates"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(z,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{children:[a.start_date?x(h(a.start_date),"MMM d, yyyy"):"Not set"," - ",a.end_date?x(h(a.end_date),"MMM d, yyyy"):"Not set"]})]})]})]})]}),e.jsxs(c,{children:[e.jsx(f,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-5 w-5"}),"AI Analysis"]}),e.jsx(m,{onClick:()=>E(a,p),disabled:B,children:B?"Analyzing...":"Run New Analysis"})]})}),e.jsx(d,{children:e.jsx(ae,{className:"h-[400px]",children:a?.analyses?.map((s,t)=>e.jsx("div",{className:"mb-6 last:mb-0",children:e.jsxs("div",{className:"bg-blue-50 rounded-md p-4",children:[e.jsx("p",{className:"text-blue-900",children:s.currentStatus}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-medium text-blue-800",children:"Challenges:"}),e.jsx("ul",{className:"list-disc pl-4 mt-1 space-y-1",children:s.challenges.map((l,i)=>e.jsx("li",{className:"text-blue-800",children:l},i))})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-medium text-blue-800",children:"Next Steps:"}),e.jsx("ul",{className:"list-disc pl-4 mt-1 space-y-1",children:s.nextSteps.map((l,i)=>e.jsx("li",{className:"text-blue-800",children:l},i))})]}),e.jsxs("div",{className:"mt-4 text-sm text-blue-600",children:["Analysis performed: ",x(h(s.date),"PPp")]})]})},t))})})]})]})}),e.jsx(C,{value:"tasks",children:e.jsxs(c,{children:[e.jsx(f,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(y,{children:"Tasks"}),e.jsxs(m,{onClick:()=>_(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Add Task"]})]})}),e.jsx(d,{children:e.jsx(be,{tasks:p,onStatusChange:(s,t)=>{g()},groupBy:"status"})})]})}),e.jsx(C,{value:"timeline",children:e.jsxs(c,{children:[e.jsx(f,{children:e.jsx(y,{children:"Project Timeline"})}),e.jsx(d,{children:e.jsxs(Se,{children:[e.jsx(A,{icon:e.jsx(ce,{className:"h-4 w-4"}),title:"Project Created",timestamp:x(h(a.created_date),"PPpp")}),p.map(s=>e.jsx(A,{icon:e.jsx(de,{className:"h-4 w-4"}),title:s.title,subtitle:`Status: ${s.status}`,timestamp:x(h(s.updated_date),"PPpp")},s.id)),a.end_date&&e.jsx(A,{icon:e.jsx(z,{className:"h-4 w-4"}),title:"Target Completion",timestamp:x(h(a.end_date),"PPp"),variant:"outline"})]})})]})}),e.jsx(C,{value:"stakeholders",children:e.jsxs(c,{children:[e.jsx(f,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(y,{children:"Stakeholders"}),e.jsxs(m,{onClick:()=>w(!0),children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Manage Stakeholders"]})]})}),e.jsx(d,{children:o.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No stakeholders assigned"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map(s=>{const t=I.find(l=>l.id===s);return t?e.jsx(c,{children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4 text-gray-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:t.name}),e.jsx("p",{className:"text-sm text-gray-500",children:t.role})]})]})})},t.id):null})})})]})})]}),e.jsx($,{open:Q,onOpenChange:_,children:e.jsxs(U,{className:"sm:max-w-lg",children:[e.jsx(F,{children:e.jsx(V,{children:"Add New Task"})}),e.jsx(r.Suspense,{fallback:e.jsxs("div",{className:"flex items-center justify-center p-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Loading task form..."})]}),children:e.jsx(ke,{onCreateTask:K,initialTaskData:{project:a.name,status:"todo"}})})]})}),e.jsx($,{open:G,onOpenChange:w,children:e.jsxs(U,{children:[e.jsx(F,{children:e.jsx(V,{children:"Manage Stakeholders"})}),e.jsxs("div",{className:"py-4",children:[e.jsx("div",{className:"space-y-4",children:I.map(s=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:o.includes(s.id),onChange:t=>{t.target.checked?b([...o,s.id]):b(o.filter(l=>l!==s.id))},className:"rounded border-gray-300"}),e.jsxs("label",{className:"flex-1",children:[e.jsx("span",{className:"font-medium",children:s.name}),s.department&&e.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",s.department,")"]})]})]},s.id))}),e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx(m,{variant:"outline",onClick:()=>w(!1),children:"Cancel"}),e.jsx(m,{onClick:()=>X(o),children:"Save Changes"})]})]})]})})]})}):e.jsx("div",{className:"p-6",children:e.jsx(c,{children:e.jsxs(d,{className:"text-center py-6",children:[e.jsx(le,{className:"h-12 w-12 text-yellow-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Project Not Found"}),e.jsx("p",{className:"text-gray-500",children:"The requested project could not be found."})]})})})}export{He as default};
