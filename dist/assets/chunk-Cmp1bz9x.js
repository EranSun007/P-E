const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TaskCreationForm-uUOFczhl.js","assets/chunk-DHGN2BiO.js","assets/chunk-pjYta8vt.js","assets/chunk-KzYfAQy1.js","assets/index-ByFAet0J.js","assets/chunk-CZDJnSNg.js","assets/index-zbygvEX7.css","assets/chunk-Dt0Bnklg.js","assets/chunk-D3uHh-f_.js","assets/chunk-Cwmy-p0V.js","assets/chunk-C6AVtkQH.js","assets/chunk-BdHZTqfh.js","assets/chunk-DSBO3d0u.js","assets/chunk-BxZc7glH.js","assets/MeetingDetailView-DEmbsraT.js","assets/chunk-AbI5mdPJ.js","assets/chunk-PmtS5Ynq.js","assets/chunk-UtEqcWk6.js","assets/chunk-CMJ2xOR1.js","assets/chunk-DIbawoHp.js","assets/chunk-BKHKgTH6.js","assets/chunk-DZDJsQre.js","assets/calendarSynchronizationService-C_BUFLgK.js","assets/calendarService-jP3ReSQA.js","assets/WeeklyMeetingSidebar-xHRigeqQ.js"])))=>i.map(i=>d[i]);
import{c as T,B as M,u as Ft,T as Xe,d as Je,e as $t,O as Wt,D as Pt,_ as xe,C as Oe,f as Ze,F as Ut,r as $e}from"./index-ByFAet0J.js";import{j as e,d as ue,a1 as be,a2 as We,a3 as Pe,a4 as Ue,a5 as dt,Y as Fe,Q as zt,i as Bt,X as pe,M as et,a6 as Yt,a7 as Ht,p as tt,o as st,a8 as Gt,a9 as Kt}from"./chunk-DHGN2BiO.js";import{a as m,j as qt}from"./chunk-pjYta8vt.js";import{B as F,D as De,a as Ie,b as at,c as rt}from"./chunk-C6AVtkQH.js";import{T as Qt,a as Xt,b as Jt,c as Zt}from"./chunk-CMJ2xOR1.js";import{E as es}from"./chunk-DIbawoHp.js";import{C as ts}from"./chunk-BKHKgTH6.js";import{A as ke}from"./chunk-UtEqcWk6.js";import{A as nt}from"./chunk-PmtS5Ynq.js";import{CalendarSynchronizationService as se}from"./calendarSynchronizationService-C_BUFLgK.js";import{E as ae}from"./chunk-DZDJsQre.js";import{s as Te,e as it,p as E,f as L,b as ot,d as lt,g as ct,i as P,h as Me,j as Ae,k as ss,l as as,m as rs,n as Ve}from"./chunk-CZDJnSNg.js";class d{static VIEW_MODES={MEETINGS:"meetings",OUT_OF_OFFICE:"out_of_office",DUTIES:"duties",BIRTHDAYS:"birthdays",ALL_EVENTS:"all_events"};static STORAGE_KEY="calendar_view_mode_preference";static DEFAULT_VIEW_MODE=d.VIEW_MODES.ALL_EVENTS;#e=d.DEFAULT_VIEW_MODE;#t=[];constructor(){this.#e=this.loadViewPreference()}getCurrentViewMode(){return this.#e}setViewMode(t){if(!this.isValidViewMode(t))throw new Error(`Invalid view mode: ${t}. Valid modes are: ${Object.values(d.VIEW_MODES).join(", ")}`);const s=this.#e;this.#e=t,this.saveViewPreference(t),this.#l(t,s)}isValidViewMode(t){return Object.values(d.VIEW_MODES).includes(t)}filterEventsForCurrentView(t){return this.filterEventsForView(t,this.#e)}filterEventsForView(t,s){if(!this.isValidViewMode(s))throw new Error(`Invalid view mode: ${s}`);if(!Array.isArray(t))return console.warn("ViewModeManager: events parameter is not an array, returning empty array"),[];switch(s){case d.VIEW_MODES.MEETINGS:return this.#s(t);case d.VIEW_MODES.OUT_OF_OFFICE:return this.#a(t);case d.VIEW_MODES.DUTIES:return this.#r(t);case d.VIEW_MODES.BIRTHDAYS:return this.#n(t);case d.VIEW_MODES.ALL_EVENTS:return this.#i(t);default:return console.warn(`ViewModeManager: Unknown view mode ${s}, returning all events`),t}}getEventCounts(t){return Array.isArray(t)?{[d.VIEW_MODES.MEETINGS]:this.#s(t).length,[d.VIEW_MODES.OUT_OF_OFFICE]:this.#a(t).length,[d.VIEW_MODES.DUTIES]:this.#r(t).length,[d.VIEW_MODES.BIRTHDAYS]:this.#n(t).length,[d.VIEW_MODES.ALL_EVENTS]:this.#i(t).length}:this.#o()}saveViewPreference(t){try{localStorage.setItem(d.STORAGE_KEY,t)}catch(s){console.warn("ViewModeManager: Failed to save view preference to localStorage:",s)}}loadViewPreference(){try{const t=localStorage.getItem(d.STORAGE_KEY);if(t&&this.isValidViewMode(t))return t}catch(t){console.warn("ViewModeManager: Failed to load view preference from localStorage:",t)}return d.DEFAULT_VIEW_MODE}clearViewPreference(){try{localStorage.removeItem(d.STORAGE_KEY),this.#e=d.DEFAULT_VIEW_MODE}catch(t){console.warn("ViewModeManager: Failed to clear view preference from localStorage:",t)}}addViewModeChangeListener(t){if(typeof t!="function")throw new Error("Listener must be a function");return this.#t.push(t),()=>{const s=this.#t.indexOf(t);s>-1&&this.#t.splice(s,1)}}getAvailableViewModes(){return[{id:d.VIEW_MODES.MEETINGS,label:"Meetings",description:"View all scheduled meetings and one-on-ones",icon:"calendar"},{id:d.VIEW_MODES.OUT_OF_OFFICE,label:"Out of Office",description:"View team member out-of-office periods",icon:"user-x"},{id:d.VIEW_MODES.DUTIES,label:"Duties",description:"View team member duty assignments",icon:"shield"},{id:d.VIEW_MODES.BIRTHDAYS,label:"Birthdays",description:"View team member birthdays",icon:"cake"},{id:d.VIEW_MODES.ALL_EVENTS,label:"All Events",description:"View all calendar events combined",icon:"calendar-days"}]}#s(t){return t.filter(s=>s.event_type==="meeting"||s.event_type==="one_on_one")}#a(t){return t.filter(s=>s.event_type==="out_of_office")}#r(t){return t.filter(s=>s.event_type==="duty")}#n(t){return t.filter(s=>s.event_type==="birthday")}#i(t){return t}#o(){return{[d.VIEW_MODES.MEETINGS]:0,[d.VIEW_MODES.OUT_OF_OFFICE]:0,[d.VIEW_MODES.DUTIES]:0,[d.VIEW_MODES.BIRTHDAYS]:0,[d.VIEW_MODES.ALL_EVENTS]:0}}#l(t,s){this.#t.forEach(o=>{try{o(t,s)}catch(l){console.error("ViewModeManager: Error in view mode change listener:",l)}})}}const J=new d;function ns({currentViewMode:j,onViewModeChange:t,eventCounts:s={},className:o="",disabled:l=!1}){const[i,n]=m.useState(-1),v=m.useRef([]),N=p=>{switch(p){case d.VIEW_MODES.MEETINGS:return ue;case d.VIEW_MODES.OUT_OF_OFFICE:return Ue;case d.VIEW_MODES.DUTIES:return Pe;case d.VIEW_MODES.BIRTHDAYS:return We;case d.VIEW_MODES.ALL_EVENTS:return be;default:return ue}},D=d.prototype.getAvailableViewModes(),_=(p,A)=>{switch(p.key){case"ArrowLeft":p.preventDefault();const w=A>0?A-1:D.length-1;n(w),v.current[w]?.focus();break;case"ArrowRight":p.preventDefault();const V=A<D.length-1?A+1:0;n(V),v.current[V]?.focus();break;case"Enter":case" ":p.preventDefault(),l||t(D[A].id);break;case"Home":p.preventDefault(),n(0),v.current[0]?.focus();break;case"End":p.preventDefault();const z=D.length-1;n(z),v.current[z]?.focus();break}},K=p=>{l||t(p)};return m.useEffect(()=>{n(-1)},[j]),e.jsx("div",{className:T("flex items-center space-x-1 bg-gray-100 rounded-lg p-1",l&&"opacity-50 cursor-not-allowed",o),role:"tablist","aria-label":"Calendar view modes",children:D.map((p,A)=>{const w=N(p.id),V=j===p.id,z=s[p.id]||0;return e.jsxs(M,{ref:re=>v.current[A]=re,variant:V?"default":"ghost",size:"sm",className:T("relative flex items-center space-x-2 px-3 py-2 text-sm font-medium transition-all duration-200","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1",V&&"bg-white shadow-sm text-blue-600",!V&&"text-gray-600 hover:text-gray-900 hover:bg-gray-50",l&&"cursor-not-allowed opacity-50"),onClick:()=>K(p.id),onKeyDown:re=>_(re,A),disabled:l,role:"tab","aria-selected":V,"aria-controls":`calendar-panel-${p.id}`,tabIndex:i===A?0:-1,title:p.description,children:[e.jsx(w,{className:"h-4 w-4","aria-hidden":"true"}),e.jsx("span",{children:p.label}),z>0&&e.jsx(F,{variant:V?"secondary":"outline",className:T("ml-1 text-xs min-w-[1.25rem] h-5 flex items-center justify-center",V&&"bg-blue-100 text-blue-700 border-blue-200",!V&&"bg-gray-200 text-gray-600 border-gray-300"),"aria-label":`${z} ${p.label.toLowerCase()}`,children:z>99?"99+":z})]},p.id)})})}const ut=({viewMode:j,onCreateTask:t=null,onAddTeamMember:s=null,onManageDuties:o=null,className:l="",size:i="md",context:n="calendar"})=>{const N=(()=>{switch(j){case d.VIEW_MODES.MEETINGS:return{icon:ue,title:n==="sidebar"?"No meetings today":"No meetings scheduled",description:n==="sidebar"?"No meetings are scheduled for this date.":"You don't have any meetings or one-on-ones scheduled. Create a task to schedule your first meeting.",actionLabel:"Create Meeting Task",onAction:t,suggestions:["Schedule a one-on-one with a team member","Plan your next team meeting","Block time for important discussions"]};case d.VIEW_MODES.OUT_OF_OFFICE:return{icon:Ue,title:n==="sidebar"?"No one is out today":"No out-of-office periods",description:n==="sidebar"?"No team members are out of office on this date.":"No team members have scheduled out-of-office periods. Manage team availability to track time off.",actionLabel:"Manage Team",onAction:s,suggestions:["Add team members to track their availability","Schedule upcoming vacation time","Plan around team member absences"]};case d.VIEW_MODES.DUTIES:return{icon:Pe,title:n==="sidebar"?"No duties assigned today":"No duty assignments",description:n==="sidebar"?"No duty assignments are scheduled for this date.":"No team member duties are currently assigned. Set up duty rotations to track responsibilities.",actionLabel:"Manage Duties",onAction:o,suggestions:["Set up DevOps duty rotations","Assign on-call responsibilities","Track team member duties"]};case d.VIEW_MODES.BIRTHDAYS:return{icon:We,title:n==="sidebar"?"No birthdays today":"No birthdays this month",description:n==="sidebar"?"No team member birthdays are on this date.":"No team member birthdays are scheduled. Add team members with birthday information to celebrate together.",actionLabel:"Add Team Members",onAction:s,suggestions:["Add team member birthday information","Plan birthday celebrations","Never miss a team member's special day"]};case d.VIEW_MODES.ALL_EVENTS:default:return{icon:be,title:n==="sidebar"?"Nothing scheduled today":"Your calendar is empty",description:n==="sidebar"?"No tasks or events are scheduled for this date.":"You don't have any events, meetings, or tasks scheduled. Start organizing your work and team activities.",actionLabel:"Create Task",onAction:t,suggestions:["Schedule your first meeting","Add team member information","Create tasks to stay organized"]}}})();return n==="sidebar"?e.jsxs("div",{className:T("text-center p-6",l),children:[e.jsx(N.icon,{className:"h-8 w-8 text-gray-400 mx-auto mb-3"}),e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:N.title}),e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:N.description}),N.onAction&&e.jsxs(M,{onClick:N.onAction,variant:"outline",size:"sm",className:"text-xs",children:[e.jsx(Fe,{className:"h-3 w-3 mr-1"}),N.actionLabel]})]}):e.jsxs("div",{className:T("space-y-6",l),children:[e.jsx(es,{icon:N.icon,title:N.title,description:N.description,actionLabel:N.actionLabel,onAction:N.onAction,size:i}),N.suggestions&&N.suggestions.length>0&&e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3 text-center",children:"Quick suggestions:"}),e.jsx("ul",{className:"space-y-2",children:N.suggestions.map((D,_)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm text-gray-600",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full mt-2 flex-shrink-0"}),e.jsx("span",{children:D})]},_))})]})]})},is=({viewMode:j,onCreateTask:t,onAddTeamMember:s,onManageDuties:o,className:l=""})=>e.jsx("div",{className:T("flex items-center justify-center min-h-[400px] bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",l),children:e.jsx(ut,{viewMode:j,onCreateTask:t,onAddTeamMember:s,onManageDuties:o,context:"calendar",size:"lg"})}),os=({viewMode:j,onCreateTask:t,className:s=""})=>e.jsx(ut,{viewMode:j,onCreateTask:t,context:"sidebar",className:s}),ls=({className:j=""})=>e.jsx("div",{className:T("flex items-center justify-center min-h-[400px] bg-gray-50 rounded-lg border-2 border-dashed border-gray-200",j),children:e.jsxs("div",{className:"text-center",children:[e.jsx(dt,{className:"h-12 w-12 text-gray-400 mx-auto mb-4 animate-pulse"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Loading calendar..."}),e.jsx("p",{className:"text-gray-500",children:"Please wait while we load your events and tasks."})]})});class Re{static async getAgendaCountsForTeamMember(t){try{if(!t)return{count:0,unresolvedCount:0,hasUnresolved:!1};const s=await nt.getByTeamMember(t);if(!Array.isArray(s))return{count:0,unresolvedCount:0,hasUnresolved:!1};const o=s.length,i=s.filter(n=>n.status==="pending"||n.status==="in_progress").length;return{count:o,unresolvedCount:i,hasUnresolved:i>0,items:s}}catch(s){return console.error("Error getting agenda counts for team member:",s),{count:0,unresolvedCount:0,hasUnresolved:!1}}}static async getAgendaCountsForTeamMembers(t){try{if(!Array.isArray(t)||t.length===0)return{};const s={},o=t.map(async i=>{const n=await this.getAgendaCountsForTeamMember(i);return{teamMemberId:i,count:n}});return(await Promise.all(o)).forEach(({teamMemberId:i,count:n})=>{s[i]=n}),s}catch(s){return console.error("Error getting agenda counts for team members:",s),{}}}static async getAgendaCountsForCalendarEvents(t){try{if(!Array.isArray(t))return{};const s=t.filter(n=>n.event_type==="one_on_one"&&n.team_member_id);if(s.length===0)return{};const o=[...new Set(s.map(n=>n.team_member_id))],l=await this.getAgendaCountsForTeamMembers(o),i={};return s.forEach(n=>{const v=l[n.team_member_id];v&&(i[n.id]={...v,teamMemberId:n.team_member_id})}),i}catch(s){return console.error("Error getting agenda counts for calendar events:",s),{}}}static async hasAgendaItems(t){try{return!t||t.event_type!=="one_on_one"||!t.team_member_id?!1:(await this.getAgendaCountsForTeamMember(t.team_member_id)).count>0}catch(s){return console.error("Error checking if event has agenda items:",s),!1}}static async getAgendaItemsForNextMeeting(t){try{if(!t)return[];const s=await nt.getForNextMeeting(t);return Array.isArray(s)?s:[]}catch(s){return console.error("Error getting agenda items for next meeting:",s),[]}}}function cs({count:j=0,unresolvedCount:t=0,hasUnresolved:s=!1,size:o="xs",className:l=""}){if(j===0)return null;const i={xs:"text-xs px-1.5 py-0.5 h-5",sm:"text-xs px-2 py-0.5 h-6"},n={xs:"h-2.5 w-2.5",sm:"h-3 w-3"},v=T("inline-flex items-center gap-1 font-medium rounded-full border",i[o],s?"bg-orange-100 text-orange-800 border-orange-300":"bg-green-100 text-green-800 border-green-300",l),N=s?dt:zt,D=s?t:j;return e.jsxs(F,{className:v,variant:"outline",children:[e.jsx(N,{className:n[o]}),e.jsx("span",{children:D})]})}function ds({count:j=0,hasUnresolved:t=!1,className:s=""}){if(j===0)return null;const o=T("inline-flex items-center justify-center min-w-[18px] h-[18px] text-xs font-bold rounded-full border",t?"bg-orange-500 text-white border-orange-600":"bg-green-500 text-white border-green-600",s);return e.jsx("div",{className:o,children:j>99?"99+":j})}const Le=768;function us(){const[j,t]=m.useState(void 0);return m.useEffect(()=>{const s=window.matchMedia(`(max-width: ${Le-1}px)`),o=()=>{t(window.innerWidth<Le)};return s.addEventListener("change",o),t(window.innerWidth<Le),()=>s.removeEventListener("change",o)},[]),!!j}class g{static EVENT_COLORS={one_on_one:{primary:"#f97316",background:"#fed7aa",light:"#fef3c7",border:"#fb923c",text:"#ea580c",hover:"#fdba74"},meeting:{primary:"#3b82f6",background:"#bfdbfe",light:"#dbeafe",border:"#60a5fa",text:"#2563eb",hover:"#93c5fd"},birthday:{primary:"#ec4899",background:"#f9a8d4",light:"#fce7f3",border:"#f472b6",text:"#db2777",hover:"#f8bbd9"},duty:{primary:"#8b5cf6",background:"#c4b5fd",light:"#ede9fe",border:"#a78bfa",text:"#7c3aed",hover:"#ddd6fe"},out_of_office:{primary:"#f97316",background:"#fed7aa",light:"#fef3c7",border:"#fb923c",text:"#ea580c",hover:"#fdba74"},default:{primary:"#6366f1",background:"#c7d2fe",light:"#e0e7ff",border:"#818cf8",text:"#4f46e5",hover:"#a5b4fc"}};static EVENT_ICONS={one_on_one:Bt,meeting:ue,birthday:We,duty:Pe,out_of_office:Ue,default:be};static EVENT_LABELS={one_on_one:"1:1",meeting:"Meeting",birthday:"Birthday",duty:"Duty",out_of_office:"OOO",default:"Event"};static VARIANTS={DEFAULT:"default",COMPACT:"compact",SIDEBAR:"sidebar"};static getEventStyling(t,s=g.VARIANTS.DEFAULT){if(!t)throw new Error("Event object is required");const o=t.event_type||"default",l=g.EVENT_COLORS[o]||g.EVENT_COLORS.default,i=g.EVENT_ICONS[o]||g.EVENT_ICONS.default,n=g.EVENT_LABELS[o]||g.EVENT_LABELS.default;return{colors:{primary:l.primary,background:l.background,light:l.light,border:l.border,text:l.text,hover:l.hover},icon:i,label:n,className:g.generateEventClassName(o,s),style:{color:l.text,backgroundColor:l.light,borderColor:l.border},badgeStyle:{borderColor:l.primary+"50",color:l.primary},hoverStyle:{backgroundColor:l.hover}}}static generateEventClassName(t,s=g.VARIANTS.DEFAULT){const o="transition-all duration-200 cursor-pointer",l="border-l-2";let i="";switch(s){case g.VARIANTS.COMPACT:i="text-xs p-1 rounded truncate";break;case g.VARIANTS.SIDEBAR:i="text-sm p-2 rounded-md truncate";break;case g.VARIANTS.DEFAULT:default:i="text-xs p-1 rounded truncate";break}let n="";switch(t){case"one_on_one":n="bg-orange-100 text-orange-800 border-orange-400 hover:bg-orange-200 hover:shadow-sm";break;case"meeting":n="bg-blue-100 text-blue-800 border-blue-400 hover:bg-blue-200 hover:shadow-sm";break;case"birthday":n="bg-pink-100 text-pink-800 border-pink-400 hover:bg-pink-200 hover:shadow-sm";break;case"duty":n="bg-purple-100 text-purple-800 border-purple-400 hover:bg-purple-200 hover:shadow-sm";break;case"out_of_office":n="bg-orange-100 text-orange-800 border-orange-400 hover:bg-orange-200 hover:shadow-sm";break;default:n="bg-indigo-100 text-indigo-800 border-indigo-400 hover:bg-indigo-200 hover:shadow-sm";break}return`${o} ${i} ${l} ${n}`.trim()}static getEventTypeColors(){return{...g.EVENT_COLORS}}static getEventTypeIcons(){return{...g.EVENT_ICONS}}static getEventTypeLabels(){return{...g.EVENT_LABELS}}static getEventCardStyling(t){if(!t)throw new Error("Event object is required");const s=t.event_type||"default",o=g.EVENT_COLORS[s]||g.EVENT_COLORS.default,l="p-3 border rounded-md cursor-pointer transition-colors";let i="";switch(s){case"birthday":i="border-pink-200 bg-pink-50 hover:bg-pink-100";break;case"one_on_one":i="border-orange-200 bg-orange-50 hover:bg-orange-100";break;case"meeting":i="border-blue-200 bg-blue-50 hover:bg-blue-100";break;case"out_of_office":i="border-orange-200 bg-orange-50 hover:bg-orange-100";break;case"duty":i="border-purple-200 bg-purple-50 hover:bg-purple-100";break;default:i="border-indigo-200 bg-indigo-50 hover:bg-indigo-100";break}return{className:`${l} ${i}`,colors:o,icon:g.EVENT_ICONS[s]||g.EVENT_ICONS.default}}static getMultiDayEventStyling(t,s,o=g.VARIANTS.DEFAULT){const l=g.getEventStyling(t,o);let i="",n="";switch(s){case"start":i="rounded-r-none border-r-0",n="▶ ";break;case"middle":i="rounded-none border-r-0 border-l-0",n="─ ";break;case"end":i="rounded-l-none border-l-0",n="◀ ";break}return{...l,className:`${l.className} ${i}`.trim(),titlePrefix:n,isMultiDay:s!=="single",position:s}}static isValidEventType(t){return!t||typeof t!="string"||t.trim()===""?!1:Object.keys(g.EVENT_COLORS).includes(t)||t==="default"}static isValidVariant(t){return Object.values(g.VARIANTS).includes(t)}static getAccessibilityInfo(t){const s=g.EVENT_COLORS[t]||g.EVENT_COLORS.default;return{hasGoodContrast:!0,backgroundColor:s.light,textColor:s.text,borderColor:s.border,ariaLabel:`${g.EVENT_LABELS[t]||"Event"} calendar event`}}}class de{static syncStatus={isRunning:!1,lastSync:null,lastError:null,syncResults:null,periodicSyncInterval:null};static listeners=new Set;static addStatusListener(t){this.listeners.add(t)}static removeStatusListener(t){this.listeners.delete(t)}static notifyListeners(t){this.listeners.forEach(s=>{try{s(t)}catch(o){console.warn("Error in sync status listener:",o)}})}static getSyncStatus(){return{...this.syncStatus}}static updateStatus(t){this.syncStatus={...this.syncStatus,...t},this.notifyListeners(this.getSyncStatus())}static startPeriodicSync(t=5*60*1e3){this.stopPeriodicSync(),console.log(`Starting periodic calendar sync with ${t}ms interval`),this.syncStatus.periodicSyncInterval=setInterval(async()=>{try{await this.performBackgroundSync()}catch(s){console.warn("Periodic sync failed:",s),this.updateStatus({lastError:s.message,lastSync:new Date().toISOString()})}},t),this.performBackgroundSync().catch(s=>{console.warn("Initial periodic sync failed:",s)})}static stopPeriodicSync(){this.syncStatus.periodicSyncInterval&&(clearInterval(this.syncStatus.periodicSyncInterval),this.syncStatus.periodicSyncInterval=null,console.log("Stopped periodic calendar sync"))}static async performBackgroundSync(){if(this.syncStatus.isRunning)return console.log("Sync already running, skipping background sync"),this.syncStatus.syncResults;try{this.updateStatus({isRunning:!0,lastError:null});const[t,s]=await Promise.all([se.syncOneOnOneMeetings({createMissing:!0,updateExisting:!1}),se.ensureOneOnOneVisibility({createMissing:!0})]),o={timestamp:new Date().toISOString(),sync:t,visibility:s,summary:{success:t.summary.success&&s.summary.success,totalOperations:t.summary.createdCount+s.summary.createdCount,errors:[...t.errors||[],...s.errors||[]]}};return this.updateStatus({isRunning:!1,lastSync:new Date().toISOString(),syncResults:o,lastError:null}),o.summary.totalOperations>0&&console.log("Background sync completed with changes:",{syncCreated:t.summary.createdCount,visibilityCreated:s.summary.createdCount,errors:o.summary.errors.length}),o}catch(t){throw console.error("Background sync failed:",t),this.updateStatus({isRunning:!1,lastSync:new Date().toISOString(),lastError:t.message}),t}}static async manualSync(t={}){const{createMissing:s=!0,updateExisting:o=!0,repairBroken:l=!0,showProgress:i=!0}=t;if(this.syncStatus.isRunning)throw new Error("Sync is already running. Please wait for it to complete.");try{this.updateStatus({isRunning:!0,lastError:null}),i&&console.log("Starting manual calendar synchronization...");const n=await se.validateEventConsistency();i&&console.log("Validation completed:",{totalIssues:n.summary.totalIssues,isConsistent:n.summary.isConsistent});let v=null;!n.summary.isConsistent&&l&&(v=await se.repairMissingEvents({repairOrphaned:!0,repairMissing:!0,repairBroken:!0,removeDuplicates:!0}),i&&console.log("Repair completed:",{totalRepairs:v.summary.totalRepairs}));const N=await se.syncOneOnOneMeetings({createMissing:s,updateExisting:o}),D=await se.ensureOneOnOneVisibility({createMissing:s}),_={timestamp:new Date().toISOString(),validation:n,repair:v,sync:N,visibility:D,summary:{success:N.summary.success&&D.summary.success,totalChanges:(v?.summary.totalRepairs||0)+N.summary.createdCount+N.summary.updatedCount+D.summary.createdCount,userMessage:this.generateUserMessage(n,v,N,D)}};return this.updateStatus({isRunning:!1,lastSync:new Date().toISOString(),syncResults:_,lastError:null}),i&&console.log("Manual sync completed:",_.summary.userMessage),_}catch(n){throw console.error("Manual sync failed:",n),this.updateStatus({isRunning:!1,lastSync:new Date().toISOString(),lastError:n.message}),n}}static generateUserMessage(t,s,o,l){const i=[];if(t.summary.isConsistent&&o.summary.createdCount===0&&l.summary.createdCount===0)return"Calendar is already synchronized. No changes needed.";s&&s.summary.totalRepairs>0&&i.push(`Fixed ${s.summary.totalRepairs} data consistency issue(s)`),o.summary.createdCount>0&&i.push(`Created ${o.summary.createdCount} missing calendar event(s)`),o.summary.updatedCount>0&&i.push(`Updated ${o.summary.updatedCount} calendar event(s)`),l.summary.createdCount>0&&i.push(`Ensured visibility for ${l.summary.createdCount} meeting(s)`);const n=(o.errors?.length||0)+(l.errors?.length||0);return n>0&&i.push(`${n} error(s) occurred during sync`),i.length>0?`Synchronization completed: ${i.join(", ")}.`:"Synchronization completed successfully."}static getSyncStatistics(){const t=this.getSyncStatus();return{isRunning:t.isRunning,lastSync:t.lastSync,lastError:t.lastError,hasPeriodicSync:t.periodicSyncInterval!==null,lastSyncResults:t.syncResults?{success:t.syncResults.summary?.success||!1,totalChanges:t.syncResults.summary?.totalOperations||0,message:t.syncResults.summary?.userMessage||"No details available"}:null}}static initialize(){this.startPeriodicSync(),typeof window<"u"&&window.addEventListener("beforeunload",()=>{this.stopPeriodicSync()})}static cleanup(){this.stopPeriodicSync(),this.listeners.clear()}}const ms=m.lazy(()=>$e(()=>xe(()=>import("./TaskCreationForm-uUOFczhl.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13])),3,1e3)),hs=m.lazy(()=>$e(()=>xe(()=>import("./MeetingDetailView-DEmbsraT.js"),__vite__mapDeps([14,1,2,4,5,6,10,15,16,17,7,8,18,19,20,21,22,23])),3,1e3)),gs=m.lazy(()=>$e(()=>xe(()=>import("./WeeklyMeetingSidebar-xHRigeqQ.js"),__vite__mapDeps([24,1,2,10,5,4,6,21,18,19,20,17,7,16,8,22,23])),3,1e3));function ys(){const[j,t]=m.useState([]),[s,o]=m.useState([]),[l,i]=m.useState([]),[n,v]=m.useState([]),[N,D]=m.useState([]),[_,K]=m.useState(new Date),[p,A]=m.useState(new Date),[w,V]=m.useState(null),[z,re]=m.useState(null),[mt,Z]=m.useState(!1),[B,ht]=m.useState(J.getCurrentViewMode()),[R,Ee]=m.useState(!0),[me,ne]=m.useState({}),[ze,he]=m.useState(!1),[Se,ge]=m.useState(null),[ye,gt]=m.useState(new Date),[yt,ft]=m.useState([]),[q,ie]=m.useState(!0),$=us(),[C,pt]=m.useState({events:[],tasks:[],teamMembers:[],outOfOffice:[],duties:[],lastUpdated:null,loadedDateRanges:new Set}),[we,Be]=m.useState(null),[I,Ye]=m.useState(de.getSyncStatus()),[xt,je]=m.useState(!1),Ne=qt(),{toast:bt}=Ft(),Et=async()=>ae.wrapOperation(async()=>{je(!0);const a=await de.manualSync({createMissing:!0,updateExisting:!0,repairBroken:!0,showProgress:!0});return a.summary.success&&a.summary.totalChanges>0&&await ee(!0),a},{operationName:"Manual Calendar Sync",showLoading:!0,showSuccess:!0,successMessage:"Calendar synchronized successfully",retryOptions:{maxRetries:2,baseDelay:2e3,onRetry:(a,c,y)=>{console.log(`Retrying sync operation (attempt ${c}) in ${y}ms...`),bt({title:"Retrying Sync",description:`Attempting to sync again (attempt ${c})...`,duration:2e3})}},errorOptions:{severity:ae.SEVERITY.HIGH,context:{source:"manual_sync_button"}}}).catch(a=>{throw je(!0),a});m.useEffect(()=>(ee(),de.initialize(),de.addStatusListener(Ye),()=>{de.removeStatusListener(Ye)}),[]),m.useEffect(()=>{const a=_.getFullYear(),c=`${a}`;!C.loadedDateRanges.has(c)&&!C.loadedDateRanges.has(`${a-1}`)&&!C.loadedDateRanges.has(`${a+1}`)&&ee(!1,_),gt(_)},[_]),m.useEffect(()=>{Ot()},[s,ye,B]),m.useEffect(()=>{ie(!$)},[$]);const ee=async(a=!1,c=null)=>ae.wrapOperation(async()=>{Ee(!0),Be(null);const h=Date.now(),r=5*60*1e3,f=c||_;if(!a&&C.lastUpdated&&h-C.lastUpdated<r&&C.events.length>0){t(C.tasks),o(C.events),i(C.teamMembers),v(C.outOfOffice),D(C.duties);const S=await Re.getAgendaCountsForCalendarEvents(C.events);ne(S),Ee(!1);return}const x=[Xe.list().catch(S=>(console.warn("Failed to load tasks:",S),C.tasks||[])),Je.list().catch(S=>(console.warn("Failed to load calendar events:",S),C.events||[])),$t.list().catch(S=>(console.warn("Failed to load team members:",S),C.teamMembers||[])),Wt.list().catch(S=>(console.warn("Failed to load out of office records:",S),C.outOfOffice||[])),Pt.list().catch(S=>(console.warn("Failed to load duties:",S),C.duties||[]))],[u,Y,te,W,O]=await Promise.all(x);t(u),i(te),v(W),D(O);const k=f.getFullYear(),Q=[k-1,k,k+1];try{for(const S of Q)await ts.synchronizeAllEvents({includeBirthdays:!0,includeDuties:!0,includeOutOfOffice:!0,year:S})}catch(S){console.warn("Failed to synchronize some calendar events:",S)}try{const{CalendarSynchronizationService:S}=await xe(async()=>{const{CalendarSynchronizationService:ve}=await import("./calendarSynchronizationService-C_BUFLgK.js");return{CalendarSynchronizationService:ve}},__vite__mapDeps([22,4,1,2,5,6,23,21]));await S.ensureOneOnOneVisibility({createMissing:!0})}catch(S){console.warn("Failed to synchronize OneOnOne meetings:",S)}let X;try{X=await Je.list()}catch(S){console.warn("Failed to reload calendar events after sync:",S),X=Y}o(X);try{const S=await Re.getAgendaCountsForCalendarEvents(X);ne(S)}catch(S){console.warn("Failed to load agenda counts:",S),ne({})}pt({events:X,tasks:u,teamMembers:te,outOfOffice:W,duties:O,lastUpdated:h,loadedDateRanges:new Set([`${k-1}`,`${k}`,`${k+1}`])})},{operationName:"Load Calendar Data",showLoading:!1,showSuccess:!1,retryOptions:{maxRetries:2,baseDelay:1e3,shouldRetry:(h,r)=>!(h.message?.includes("validation")||h.message?.includes("invalid"))},errorOptions:{severity:ae.SEVERITY.MEDIUM,showToast:!1,context:{forceRefresh:a,targetMonth:c?.toISOString()}}}).catch(h=>{if(console.error("Failed to load calendar data:",h),Be(h.message||"Failed to load calendar data"),C.events.length>0){t(C.tasks),o(C.events),i(C.teamMembers),v(C.outOfOffice),D(C.duties);try{const r=Re.getAgendaCountsForCalendarEvents(C.events);ne(r)}catch{ne({})}}}).finally(()=>{Ee(!1)}),St=async()=>{await ee(!0)},He=async()=>{await ee(!0,_)},wt=async a=>{if(!a){Z(!1);return}return ae.wrapOperation(async()=>{await Xe.create({...a,due_date:a.due_date||p.toISOString()}),await St(),Z(!1)},{operationName:"Create Task",showLoading:!0,showSuccess:!0,successMessage:"Task created successfully",retryOptions:{maxRetries:2},errorOptions:{severity:ae.SEVERITY.MEDIUM,context:{taskTitle:a.title,dueDate:a.due_date}}})},jt=()=>{const a=as(_);K(a)},Nt=()=>{const a=rs(_,1);K(a)},Ct=a=>{A(a)},Ge=a=>{V(a)},Ce=a=>{re(a),a.event_type==="one_on_one"&&a.team_member_id&&(ge(a),he(!0))},Ke=()=>{he(!1),ge(null)},vt=a=>{Ne(`/team/${a}`),he(!1),ge(null)},_t=a=>{ht(a),J.setViewMode(a)},Ot=()=>{const a=Te(ye,{weekStartsOn:1}),c=it(ye,{weekStartsOn:1}),y=s.filter(r=>{if(!r.start_date)return!1;try{const f=E(r.start_date),x=r.end_date?E(r.end_date):f;return f>=a&&f<=c||x>=a&&x<=c||f<=a&&x>=c}catch(f){return console.warn("Invalid date in calendar event:",r.id,f),!1}}),h=J.filterEventsForView(y,B);ft(h)},Dt=(a,c)=>{K(c),A(c),Ce(a),$&&ie(!1)},It=a=>{K(a),A(a),$&&ie(!1)},fe=()=>{ie(!q)},oe=a=>{if(!a.start_date||!a.end_date)return!1;const c=E(a.start_date),y=E(a.end_date);return Ve(y,c)>0},kt=(a,c)=>{if(!oe(a))return"single";const y=E(a.start_date),h=E(a.end_date);return P(c,y)?"start":P(c,h)?"end":Me(c,y)&&Ae(c,h)?"middle":"none"},qe=a=>{const c=l.find(u=>u.id===a.team_member_id),y=a.start_date?L(E(a.start_date),"h:mm a"):"",h=a.end_date?L(E(a.end_date),"h:mm a"):"",r=me[a.id],f=g.getEventStyling(a),x={title:a.title,time:null,details:[],actions:[],styling:f,eventType:f.label};switch(!a.all_day&&y&&(x.time=h&&h!==y?`${y} - ${h}`:y),a.event_type){case"one_on_one":c&&(x.details.push(`1:1 with ${c.name}`),r&&r.count>0?r.hasUnresolved?x.details.push(`${r.unresolvedCount} pending agenda items`):x.details.push(`${r.count} agenda items ready`):x.details.push("No agenda items yet"),x.actions.push("Click to view team member profile"));break;case"out_of_office":if(c&&(x.details.push(`${c.name} is out of office`),oe(a))){const u=Ve(E(a.end_date),E(a.start_date))+1;x.details.push(`Duration: ${u} day${u>1?"s":""}`)}break;case"duty":if(c&&(x.details.push(`Duty assignment for ${c.name}`),oe(a))){const u=Ve(E(a.end_date),E(a.start_date))+1;x.details.push(`Duration: ${u} day${u>1?"s":""}`)}break;case"birthday":c&&x.details.push(`Wish ${c.name} a happy birthday!`);break}return a.description&&a.description!==a.title&&x.details.push(a.description),x},Tt=a=>{const c=lt(a),y=ct(a);return s.filter(h=>{if(!h.start_date)return!1;try{const r=E(h.start_date),f=h.end_date?E(h.end_date):r;return r>=c&&r<=y||f>=c&&f<=y||r<=c&&f>=y}catch(r){return console.warn("Invalid date in calendar event:",h.id,r),!1}})},Mt=()=>{const a=Tt(_),c=J.getEventCounts(a);return e.jsxs("div",{className:"space-y-4 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-xl font-semibold",children:L(_,"MMMM yyyy")}),$&&e.jsx(M,{variant:"outline",size:"icon",onClick:fe,title:q?"Hide weekly meetings":"Show weekly meetings",children:q?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(et,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(M,{variant:"outline",size:"icon",onClick:jt,disabled:R,children:e.jsx(Yt,{className:"h-4 w-4"})}),e.jsx(M,{variant:"outline",size:"icon",onClick:()=>K(new Date),disabled:R,children:"Today"}),e.jsx(M,{variant:"outline",size:"icon",onClick:Nt,disabled:R,children:e.jsx(Ht,{className:"h-4 w-4"})}),e.jsx(M,{variant:"outline",size:"icon",onClick:He,disabled:R,title:"Refresh calendar data",children:e.jsx(ue,{className:"h-4 w-4"})}),e.jsx(M,{variant:"outline",size:"icon",onClick:Et,disabled:R||I.isRunning,title:I.isRunning?"Sync in progress...":"Sync calendar events",className:T(I.lastError&&"border-red-200 text-red-600",I.lastSync&&!I.lastError&&"border-green-200 text-green-600"),children:I.isRunning?e.jsx(tt,{className:"h-4 w-4 animate-spin"}):I.lastError?e.jsx(st,{className:"h-4 w-4"}):e.jsx(tt,{className:"h-4 w-4"})}),!$&&e.jsx(M,{variant:"outline",size:"icon",onClick:fe,title:q?"Hide weekly meetings":"Show weekly meetings",children:q?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(et,{className:"h-4 w-4"})})]})]}),we&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3 mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-red-600 text-sm",children:[e.jsx("strong",{children:"Error loading calendar data:"})," ",we]}),e.jsx(M,{variant:"outline",size:"sm",onClick:He,disabled:R,children:"Retry"})]})}),xt&&I.lastSync&&e.jsx("div",{className:T("border rounded-md p-3 mb-4",I.lastError?"bg-red-50 border-red-200":"bg-green-50 border-green-200"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[I.lastError?e.jsx(st,{className:"h-4 w-4 text-red-600"}):e.jsx(Gt,{className:"h-4 w-4 text-green-600"}),e.jsx("div",{className:T("text-sm",I.lastError?"text-red-600":"text-green-600"),children:I.lastError?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Sync failed:"})," ",I.lastError]}):e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Sync completed"}),I.syncResults?.summary?.userMessage&&e.jsxs(e.Fragment,{children:[": ",I.syncResults.summary.userMessage]})]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:I.lastSync&&new Date(I.lastSync).toLocaleTimeString()}),e.jsx(M,{variant:"ghost",size:"sm",onClick:()=>je(!1),children:e.jsx(pe,{className:"h-3 w-3"})})]})]})}),e.jsx("div",{className:"flex justify-center",children:e.jsx(ns,{currentViewMode:B,onViewModeChange:_t,eventCounts:c,disabled:R})})]})},At=()=>{const a="EEEE",c=[],y=Te(_);for(let h=0;h<7;h++)c.push(e.jsx("div",{className:"font-medium text-sm py-2 text-center",children:L(ot(y,h),a)},h));return e.jsx("div",{className:"grid grid-cols-7 mb-2",children:c})},Vt=()=>{const a=lt(_),c=ct(a),y=Te(a),h=it(c),r="d",f=[];let x=[],u=y;const Y=s.filter(O=>{if(!O.start_date)return!1;try{const k=E(O.start_date),Q=O.end_date?E(O.end_date):k;return k>=y&&k<=h||Q>=y&&Q<=h||k<=y&&Q>=h}catch(k){return console.warn("Invalid date in calendar event:",O.id,k),!1}}),W=J.filterEventsForView(Y,B).length>0||j.some(O=>O.due_date&&E(O.due_date)>=y&&E(O.due_date)<=h);if(!R&&!W)return e.jsx(is,{viewMode:B,onCreateTask:()=>Z(!0),onAddTeamMember:()=>Ne("/team"),onManageDuties:()=>Ne("/team")});for(;u<=h;){for(let O=0;O<7;O++){const k=L(u,r),Q=u,X=j.filter(b=>b.due_date&&P(E(b.due_date),u)),S=Y.filter(b=>{if(!b.start_date)return!1;const H=E(b.start_date),G=b.end_date?E(b.end_date):H;return P(H,u)||P(G,u)||Me(u,H)&&Ae(u,G)}),ve=J.filterEventsForView(S,B);x.push(e.jsxs("div",{className:T("min-h-[120px] p-2 border border-gray-200 relative",!ss(u,a)&&"text-gray-400 bg-gray-50",P(u,p)&&"bg-blue-50","hover:bg-blue-50 cursor-pointer transition-colors"),onClick:()=>Ct(Q),children:[e.jsx("div",{className:"font-medium text-right",children:k}),e.jsxs("div",{className:"mt-2 space-y-1 max-h-[90px] overflow-y-auto",children:[X.map(b=>e.jsx("div",{className:T("text-xs p-1 rounded truncate",b.type==="meeting"&&"bg-blue-100 text-blue-800",b.type==="metric"&&"bg-green-100 text-green-800",b.type==="action"&&"bg-purple-100 text-purple-800",b.type==="generic"&&"bg-gray-100 text-gray-800"),onClick:H=>{H.stopPropagation(),Ge(b)},children:b.title},`task-${b.id}`)),ve.map(b=>{const H=kt(b,u);if(H==="none")return null;const G=oe(b)?g.getMultiDayEventStyling(b,H,g.VARIANTS.DEFAULT):g.getEventStyling(b,g.VARIANTS.DEFAULT),Qe=G.icon,U=qe(b),Lt=G.titlePrefix?`${G.titlePrefix}${b.title}`:b.title,le=me[b.id];return e.jsx(Qt,{children:e.jsxs(Xt,{children:[e.jsx(Jt,{asChild:!0,children:e.jsx("div",{className:G.className,style:G.style,onClick:ce=>{ce.stopPropagation(),Ce(b)},"aria-label":g.getAccessibilityInfo(b.event_type).ariaLabel,children:e.jsxs("div",{className:"flex items-center justify-between gap-1",children:[e.jsxs("div",{className:"flex items-center gap-1 min-w-0",children:[e.jsx(Qe,{className:"h-3 w-3 flex-shrink-0","aria-hidden":"true"}),e.jsx("span",{className:"truncate",children:Lt})]}),b.event_type==="one_on_one"&&le&&le.count>0&&e.jsx(ds,{count:le.unresolvedCount||le.count,hasUnresolved:le.hasUnresolved,className:"flex-shrink-0 ml-1"})]})})}),e.jsx(Zt,{side:"top",className:"max-w-xs",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"h-4 w-4 flex-shrink-0",style:{color:U.styling.colors.primary}}),e.jsx("p",{className:"font-medium",children:U.title}),e.jsx(F,{variant:"outline",className:"text-xs",style:{borderColor:U.styling.colors.primary+"50",color:U.styling.colors.primary},children:U.eventType})]}),U.time&&e.jsx("p",{className:"text-xs",children:U.time}),U.details.map((ce,_e)=>e.jsx("p",{className:"text-xs text-gray-600",children:ce},_e)),U.actions.map((ce,_e)=>e.jsx("p",{className:"text-xs text-gray-500 italic",children:ce},_e))]})})]})},`event-${b.id}-${u.toString()}`)})]}),P(u,new Date)&&e.jsx(F,{className:"absolute top-1 left-1 bg-red-500 text-white",children:"Today"})]},u.toString())),u=ot(u,1)}f.push(e.jsx("div",{className:"grid grid-cols-7",children:x},u.toString())),x=[]}return e.jsx("div",{className:"mb-4",children:f})},Rt=()=>{const a=j.filter(r=>r.due_date&&P(E(r.due_date),p)),c=s.filter(r=>{if(!r.start_date)return!1;try{const f=E(r.start_date),x=r.end_date?E(r.end_date):f;return P(f,p)||P(x,p)||Me(p,f)&&Ae(p,x)}catch(f){return console.warn("Invalid date in calendar event:",r.id,f),!1}}),y=J.filterEventsForView(c,B);return a.length>0||y.length>0?e.jsxs("div",{className:"space-y-3",children:[y.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-1",children:[e.jsx(be,{className:"h-4 w-4"}),"Events (",y.length,")"]}),e.jsx("div",{className:"space-y-2",children:y.map(r=>{const f=g.getEventCardStyling(r),x=f.icon,u=qe(r),Y=l.find(O=>O.id===r.team_member_id),te=oe(r),W=me[r.id];return e.jsxs("div",{className:f.className,onClick:()=>Ce(r),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{className:"h-4 w-4",style:{color:f.colors.primary}}),e.jsx("h4",{className:"font-medium",children:r.title}),te&&e.jsx(F,{variant:"secondary",className:"text-xs",children:"Multi-day"}),r.event_type==="one_on_one"&&W&&W.count>0&&e.jsx(cs,{count:W.count,unresolvedCount:W.unresolvedCount,hasUnresolved:W.hasUnresolved,size:"sm"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[u.time&&e.jsx("span",{className:"text-xs text-gray-500",children:u.time}),e.jsx(F,{variant:"outline",style:{borderColor:f.colors.primary+"50",color:f.colors.primary},children:u.eventType})]})]}),u.details.length>0&&e.jsx("div",{className:"mt-2 space-y-1",children:u.details.map((O,k)=>e.jsx("p",{className:"text-sm text-gray-600",children:O},k))}),te&&e.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[L(E(r.start_date),"MMM d")," - ",L(E(r.end_date),"MMM d")]}),Y&&(r.event_type==="one_on_one"||r.event_type==="meeting")&&e.jsx("div",{className:"mt-3 pt-2 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx(ke,{teamMemberId:Y.id,teamMemberName:Y.name,sourceItem:{title:r.title,description:r.description||`${r.event_type==="one_on_one"?"1:1 meeting":"Meeting"} on ${L(E(r.start_date),"MMM d, yyyy")}`,type:r.event_type,id:r.id,date:r.start_date},variant:"outline",size:"sm"}),r.event_type==="one_on_one"&&e.jsxs(M,{variant:"outline",size:"sm",onClick:()=>{ge(r),he(!0)},children:[e.jsx(Kt,{className:"h-4 w-4 mr-1"}),"Meeting Details"]})]})})]},r.id)})})]}),a.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-1",children:[e.jsx(Fe,{className:"h-4 w-4"}),"Tasks (",a.length,")"]}),e.jsx("div",{className:"space-y-2",children:a.map(r=>{const f=Array.isArray(r.stakeholders)?r.stakeholders:[],x=l.filter(u=>f.includes(u.name));return e.jsxs("div",{className:"p-3 border rounded-md hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>Ge(r),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium",children:r.title}),e.jsx(F,{variant:"outline",children:r.type})]}),r.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r.description}),x.length>0&&e.jsx("div",{className:"mt-3 pt-2 border-t border-gray-200 space-y-2",children:x.map(u=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:u.name}),e.jsx(ke,{teamMemberId:u.id,teamMemberName:u.name,sourceItem:{title:r.title,description:r.description,type:"task",id:r.id,priority:r.priority,status:r.status,due_date:r.due_date},variant:"outline",size:"sm"})]},u.id))})]},r.id)})})]})]}):e.jsx(os,{viewMode:B,onCreateTask:()=>Z(!0)})};return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col xl:flex-row space-y-6 xl:space-y-0 xl:space-x-6",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Calendar"}),e.jsxs(M,{onClick:()=>Z(!0),disabled:R,children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),"New Task"]})]}),R?e.jsx(ls,{}):e.jsxs(e.Fragment,{children:[Mt(),At(),Vt()]})]}),e.jsxs("div",{className:"xl:w-80",children:[e.jsxs("div",{className:"bg-white rounded-md border p-4 sticky top-4",children:[e.jsx("h2",{className:"font-semibold mb-4 pb-2 border-b",children:L(p,"MMMM d, yyyy")}),Rt()]}),q&&e.jsxs("div",{className:T("mt-6",$&&"fixed inset-0 z-50 bg-white p-4 overflow-y-auto"),children:[$&&e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Weekly Meetings"}),e.jsx(M,{variant:"ghost",size:"icon",onClick:fe,children:e.jsx(pe,{className:"h-4 w-4"})})]}),e.jsx(Oe,{componentName:"Weekly Meeting Sidebar",inline:!0,children:e.jsx(m.Suspense,{fallback:e.jsx(Ze,{}),children:e.jsx(gs,{currentWeek:ye,meetings:yt,onMeetingClick:Dt,onDateNavigate:It,agendaCounts:me,isLoading:R,error:we,onRetry:()=>ee(!0),className:T($&&"static")})})})]})]})]}),$&&q&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:fe,"aria-hidden":"true"}),e.jsx(De,{open:mt,onOpenChange:Z,children:e.jsxs(Ie,{className:"sm:max-w-lg",children:[e.jsx(at,{children:e.jsxs(rt,{children:["Add Task for ",L(p,"MMMM d, yyyy")]})}),e.jsx(Oe,{componentName:"Task Creation Form",children:e.jsx(m.Suspense,{fallback:e.jsx(Ut,{}),children:e.jsx(ms,{onCreateTask:wt,initialTaskData:{due_date:p.toISOString(),status:"todo",priority:"medium",type:"generic"}})})})]})}),e.jsx(De,{open:ze,onOpenChange:Ke,children:e.jsx(Ie,{className:"sm:max-w-3xl max-h-[90vh] overflow-y-auto",children:e.jsx(Oe,{componentName:"Meeting Detail View",children:e.jsx(m.Suspense,{fallback:e.jsx(Ze,{}),children:e.jsx(hs,{event:Se,teamMember:Se?l.find(a=>a.id===Se.team_member_id):null,isOpen:ze,onClose:Ke,onNavigateToProfile:vt})})})})}),e.jsx(De,{open:!!w,onOpenChange:()=>V(null),children:w&&e.jsxs(Ie,{className:"sm:max-w-lg",children:[e.jsx(at,{children:e.jsx(rt,{children:"Task Details"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:w.title}),e.jsxs("div",{className:"flex items-center mt-2 space-x-2",children:[e.jsx(F,{children:w.type}),e.jsxs(F,{variant:"outline",children:[w.priority," priority"]}),w.strategic&&e.jsx(F,{variant:"secondary",children:"Strategic"})]})]}),w.description&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-gray-500",children:"Description"}),e.jsx("p",{children:w.description})]}),w.due_date&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-gray-500",children:"Due Date"}),e.jsx("p",{children:L(E(w.due_date),"PPpp")})]}),w.stakeholders?.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-gray-500",children:"Stakeholders"}),e.jsx("p",{children:w.stakeholders.join(", ")}),e.jsx("div",{className:"mt-3 space-y-2",children:w.stakeholders.map(a=>{const c=l.find(y=>y.name===a);return c?e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsx("span",{className:"text-sm font-medium",children:c.name}),e.jsx(ke,{teamMemberId:c.id,teamMemberName:c.name,sourceItem:{title:w.title,description:w.description,type:"task",id:w.id,priority:w.priority,status:w.status,due_date:w.due_date},variant:"outline",size:"sm"})]},c.id):null})})]}),w.tags?.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-gray-500",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:w.tags.map((a,c)=>e.jsx(F,{variant:"secondary",children:a},c))})]})]})]})})]})})}const Os=Object.freeze(Object.defineProperty({__proto__:null,default:ys},Symbol.toStringTag,{value:"Module"}));export{Re as A,cs as C,g as E,ds as a,Os as b};
