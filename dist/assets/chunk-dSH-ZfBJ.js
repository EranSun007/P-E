import{j as e,ax as $,al as _,am as z,ay as f,az as N,Q as w,a0 as F,aA as R,d as B,g as L,ae as q,aa as H,o as G,Z as v,_ as C}from"./chunk-8WlaufA8.js";import{R as T,a as k}from"./chunk-pjYta8vt.js";import{g as K,i as Q,j as Z,B as u,h as J,L as V,e as W}from"./index-BK5E59O8.js";import{B as j,D as X,a as Y,b as ee,c as se,d as ae}from"./chunk-Cg2ZZDgQ.js";import{D as te,a as re,b as ie,d as x,e as A}from"./chunk-DvQYMAQ6.js";import{C as ce}from"./chunk-DHsBTIyN.js";import{T as le}from"./chunk-DSRmHbBO.js";import{A as ne}from"./chunk-cjCmUzJ1.js";import{f as D,p as de}from"./chunk-BQPSriyy.js";import{s as M}from"./chunk-BdHZTqfh.js";function U({task:a,onEdit:d,onDelete:h,onStatusChange:c}){const s={title:"",description:"",type:"generic",status:"todo",priority:"medium",tags:[],stakeholders:[],strategic:!1,...a},m=Array.isArray(s.tags)?s.tags:[],i=Array.isArray(s.stakeholders)?s.stakeholders:[],[l,o]=T.useState([]);T.useEffect(()=>{(async()=>{try{const t=await W.list();o(t)}catch(t){console.error("Failed to load team members:",t)}})()},[]);const p=()=>{switch(s.status){case"done":return e.jsx(w,{className:"h-5 w-5 text-green-500"});case"in_progress":return e.jsx(N,{className:"h-5 w-5 text-blue-500"});case"blocked":return e.jsx(G,{className:"h-5 w-5 text-red-500"});case"backlog":return e.jsx(H,{className:"h-5 w-5 text-gray-500"});default:return e.jsx(f,{className:"h-5 w-5 text-gray-400"})}},S=()=>{switch(s.type){case"meeting":return"bg-blue-100 text-blue-800";case"metric":return"bg-green-100 text-green-800";case"action":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},O=()=>{switch(s.priority){case"low":return"bg-blue-100 text-blue-800";case"medium":return"bg-yellow-100 text-yellow-800";case"high":return"bg-orange-100 text-orange-800";case"urgent":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},E=async(r,t)=>{const n={...a};n.subtasks=[...a.subtasks||[]],n.subtasks[r]={...n.subtasks[r],done:t},c&&c(n,a.status)},[P,g]=k.useState(!1),[y,b]=k.useState(""),I=async()=>{if(!y.trim())return;const r={...a,updates:[...a.updates||[],{text:y.trim(),date:new Date().toISOString()}]};g(!1),b(""),c&&c(r,a.status)};return e.jsxs(e.Fragment,{children:[e.jsxs(K,{className:"shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(Q,{className:"pb-2",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"mt-0.5",onClick:()=>c?.(s,s.status==="done"?"todo":"done"),children:p()}),e.jsxs("div",{children:[e.jsx(Z,{className:`text-base ${s.status==="done"?"line-through text-gray-500":""}`,children:s.title}),s.project&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1 flex items-center gap-1",children:[e.jsx($,{className:"h-3 w-3"}),s.project]})]})]}),e.jsxs(te,{children:[e.jsx(re,{asChild:!0,children:e.jsx(u,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(_,{className:"h-4 w-4"})})}),e.jsxs(ie,{align:"end",children:[e.jsxs(x,{onClick:()=>d?.(s),children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsx(A,{}),e.jsxs(x,{onClick:()=>c?.(s,"todo"),children:[e.jsx(f,{className:"mr-2 h-4 w-4"}),"Mark as Todo"]}),e.jsxs(x,{onClick:()=>c?.(s,"in_progress"),children:[e.jsx(N,{className:"mr-2 h-4 w-4"}),"Mark as In Progress"]}),e.jsxs(x,{onClick:()=>c?.(s,"done"),children:[e.jsx(w,{className:"mr-2 h-4 w-4"}),"Mark as Done"]}),e.jsx(A,{}),e.jsxs(x,{onClick:()=>h?.(s),className:"text-red-600",children:[e.jsx(F,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})}),e.jsxs(J,{children:[s.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:s.description}),Array.isArray(s.subtasks)&&s.subtasks.length>0&&e.jsxs("div",{className:"mb-3 space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Subtasks"}),e.jsx("div",{className:"space-y-2",children:s.subtasks.map((r,t)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{checked:r.done,onCheckedChange:n=>E(t,n),id:`subtask-${a.id}-${t}`}),e.jsx("label",{htmlFor:`subtask-${a.id}-${t}`,className:`text-sm ${r.done?"line-through text-gray-500":"text-gray-700"}`,children:r.title})]},t))})]}),e.jsxs("div",{className:"flex flex-wrap gap-1.5 mb-3",children:[e.jsx(j,{className:S(),children:s.type}),e.jsx(j,{className:O(),children:s.priority}),s.strategic&&e.jsxs(j,{variant:"outline",className:"flex items-center gap-1",children:[e.jsx(R,{className:"h-3 w-3"}),"Strategic"]})]}),m.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:m.map((r,t)=>e.jsx(j,{variant:"secondary",className:"text-xs",children:r},t))}),s.due_date&&e.jsxs("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[e.jsx(B,{className:"h-4 w-4 mr-1"}),e.jsxs("span",{children:["Due ",D(new Date(s.due_date),"PPp")]})]}),i.length>0&&e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(L,{className:"h-4 w-4 mr-1"}),e.jsxs("span",{children:["Stakeholders: ",i.join(", ")]})]}),i.length>0&&l.length>0&&e.jsx("div",{className:"mt-3 space-y-2",children:i.map(r=>{const t=l.find(n=>n.name===r);return t?e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsx("span",{className:"text-sm font-medium",children:t.name}),e.jsx(ne,{teamMemberId:t.id,teamMemberName:t.name,sourceItem:{title:s.title,description:s.description,type:"task",id:s.id,priority:s.priority,status:s.status},variant:"outline",size:"sm"})]},t.id):null})}),Array.isArray(a.updates)&&a.updates.length>0&&e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Updates"}),a.updates.slice(0,2).map((r,t)=>e.jsxs("div",{className:"text-sm text-gray-600 bg-gray-50 p-2 rounded",children:[e.jsx("p",{children:r.text}),e.jsx("span",{className:"text-xs text-gray-500",children:D(de(r.date),"MMM d, yyyy")})]},t))]}),e.jsxs(u,{variant:"ghost",size:"sm",className:"mt-2",onClick:()=>g(!0),children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Add Update"]})]})]}),e.jsx(X,{open:P,onOpenChange:g,children:e.jsxs(Y,{children:[e.jsx(ee,{children:e.jsx(se,{children:"Add Progress Update"})}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{children:"Update Details"}),e.jsx(le,{value:y,onChange:r=>b(r.target.value),placeholder:"Share progress, blockers, or achievements...",rows:4})]})}),e.jsxs(ae,{children:[e.jsx(u,{variant:"outline",onClick:()=>g(!1),children:"Cancel"}),e.jsx(u,{onClick:I,children:"Add Update"})]})]})})]})}function Ne({tasks:a=[],onEditTask:d,onDeleteTask:h,onStatusChange:c,groupBy:s=null}){const m=M(a);if(m.length===0)return e.jsx("div",{className:"text-center p-8 border border-dashed rounded-lg bg-gray-50",children:e.jsx("p",{className:"text-gray-500",children:"No active tasks found"})});if(s){const i={};return m.forEach(l=>{const o=oe(l,s);i[o]||(i[o]=[]),i[o].push(l)}),e.jsx("div",{className:"space-y-6",children:Object.entries(i).map(([l,o])=>e.jsxs("div",{className:"border rounded-lg p-4 bg-white",children:[e.jsx("h3",{className:"font-medium mb-4 text-lg border-b pb-2",children:l}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:e.jsx(v,{children:M(o).map(p=>e.jsx(C.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:e.jsx(U,{task:p,onEdit:d,onDelete:h,onStatusChange:c})},p.id))})})]},l))})}return e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:e.jsx(v,{children:m.map(i=>e.jsx(C.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:e.jsx(U,{task:i,onEdit:d,onDelete:h,onStatusChange:c})},i.id))})})}function oe(a,d){if(!a)return"Other";switch(d){case"strategic":return a.strategic?"Strategic":"Tactical";case"type":return a.type?.charAt(0).toUpperCase()+a.type?.slice(1)||"Other";case"priority":return a.priority?.charAt(0).toUpperCase()+a.priority?.slice(1)||"Other";default:return a[d]||"Other"}}export{Ne as T};
