const o=()=>{try{const e="__localStorage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch{return!1}},l=e=>{if(!o())return console.warn("localStorage is not available"),null;try{return localStorage.getItem(e)}catch(r){return console.warn(`Failed to get item from localStorage: ${e}`,r),null}},i=(e,r)=>{if(!o())return console.warn("localStorage is not available"),!1;try{return localStorage.setItem(e,r),!0}catch(t){return console.warn(`Failed to set item in localStorage: ${e}`,t),!1}},c=e=>{if(!o())return console.warn("localStorage is not available"),!1;try{return localStorage.removeItem(e),!0}catch(r){return console.warn(`Failed to remove item from localStorage: ${e}`,r),!1}},u=e=>{const r=l(e);if(!r)return null;try{return JSON.parse(r)}catch(t){return console.warn(`Failed to parse JSON from localStorage: ${e}`,t),c(e),null}},g=(e,r)=>{try{const t=JSON.stringify(r);return i(e,t)}catch(t){return console.warn(`Failed to stringify and store JSON in localStorage: ${e}`,t),!1}},n={username:"admin",password:"password123"},s="auth_token";class S{static validateCredentials(r,t){return!r||!t?!1:r===n.username&&t===n.password}static generateToken(r){return{value:Math.random().toString(36).substring(2)+Date.now().toString(36),timestamp:Date.now(),username:r}}static isValidToken(r){return!(!r||typeof r!="object"||!r.value||!r.timestamp||!r.username)}static clearAuthData(){if(!o())return console.warn("localStorage is not available - cannot clear authentication data"),!1;try{return c(s)}catch(r){return console.warn("Failed to clear authentication data:",r),!1}}static storeToken(r){if(!o()){const t=new Error("localStorage is not available - browser storage may be disabled");throw t.type="STORAGE_UNAVAILABLE",t}try{if(!g(s,r)){const a=new Error("Unable to store authentication data - storage may be full or restricted");throw a.type="STORAGE_QUOTA_EXCEEDED",a}}catch(t){if(t.name==="QuotaExceededError"||t.code===22){const a=new Error("Browser storage is full - please clear some data and try again");throw a.type="STORAGE_QUOTA_EXCEEDED",a}else if(t.name==="SecurityError"){const a=new Error("Browser storage access is restricted - please check your privacy settings");throw a.type="STORAGE_SECURITY_ERROR",a}else{const a=new Error("Failed to save authentication data - please try again");throw a.type="STORAGE_UNKNOWN_ERROR",a.originalError=t,a}}}static getStoredToken(){if(!o()){const r=new Error("localStorage is not available - cannot retrieve authentication token");throw r.type="STORAGE_UNAVAILABLE",r}try{const r=u(s);return this.isValidToken(r)?r:null}catch{return console.warn("Corrupted authentication token detected, clearing storage"),this.clearAuthData(),null}}static isAuthenticated(){try{return this.getStoredToken()!==null}catch(r){if(r.type==="STORAGE_UNAVAILABLE")throw r;return console.warn("Error checking authentication status:",r),!1}}static async changePassword(r,t,a){if(r!==n.username||t!==n.password)throw new Error("Incorrect current password.");n.password=a,console.log("Password for user '"+r+"' has been changed."),this.clearAuthData()}}export{S as A};
