import{j as e,bB as z,d as V,X as $,aa as q,i as I,bC as H,ae as M,Y as Q,Q as X,ay as Y,ah as G}from"./chunk-8WlaufA8.js";import{a as i}from"./chunk-pjYta8vt.js";import{c as o,g as S,i as J,j as K,B as l,h as E}from"./index-BK5E59O8.js";import{B as F}from"./chunk-Cg2ZZDgQ.js";import{S as W}from"./chunk-CkTSnDel.js";import{A as k,C as Z}from"./chunk-FXPmmNOU.js";import{A as N}from"./chunk-Bw8oe1_L.js";import{a as ee}from"./chunk-cjCmUzJ1.js";import{f,p as y}from"./chunk-BQPSriyy.js";import"./chunk-kzSEtJwL.js";import"./chunk-DTiRvVQj.js";import"./chunk-CJViCmxo.js";import"./calendarSynchronizationService-A8-_sGLl.js";import"./calendarService-BLiLHtBa.js";import"./chunk-DSRmHbBO.js";import"./chunk-DktN3Kjy.js";const w=i.forwardRef(({className:s,orientation:t="horizontal",decorative:d=!0,...m},x)=>e.jsx(z,{ref:x,decorative:d,orientation:t,className:o("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",s),...m}));w.displayName=z.displayName;function je({event:s,teamMember:t,isOpen:d=!1,onClose:m,onNavigateToProfile:x,className:B=""}){const[C,D]=i.useState([]),[n,T]=i.useState({count:0,unresolvedCount:0,hasUnresolved:!1}),[b,_]=i.useState(!1),[R,h]=i.useState(!1),[A,c]=i.useState(null);i.useEffect(()=>{d&&s&&s.event_type==="one_on_one"&&s.team_member_id&&g()},[d,s]);const g=async()=>{try{_(!0),c(null);const[a,r]=await Promise.all([k.getAgendaItemsForNextMeeting(s.team_member_id),k.getAgendaCountsForTeamMember(s.team_member_id)]);D(a),T(r)}catch(a){console.error("Error loading agenda items:",a),c("Failed to load agenda items")}finally{_(!1)}},U=async a=>{try{if(!a){h(!1);return}await N.create({...a,teamMemberId:s.team_member_id,status:"pending",targetMeetingDate:s.start_date}),await g(),h(!1)}catch(r){console.error("Error adding agenda item:",r),c("Failed to add agenda item")}},L=async(a,r)=>{try{const j=r==="completed"?"pending":"completed";await N.update(a,{status:j}),await g()}catch(j){console.error("Error updating agenda item:",j),c("Failed to update agenda item")}},P=async a=>{try{await N.update(a,{status:"moved",targetMeetingDate:null}),await g()}catch(r){console.error("Error moving agenda item:",r),c("Failed to move agenda item")}};if(!d||!s)return null;const v=s.event_type==="one_on_one",p=s.start_date?f(y(s.start_date),"h:mm a"):"",u=s.end_date?f(y(s.end_date),"h:mm a"):"",O=s.start_date?f(y(s.start_date),"EEEE, MMMM d, yyyy"):"";return e.jsxs(S,{className:o("w-full max-w-2xl mx-auto",B),children:[e.jsx(J,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(V,{className:"h-5 w-5 text-blue-600"}),e.jsx(K,{className:"text-lg",children:s.title}),v&&n.count>0&&e.jsx(Z,{count:n.count,unresolvedCount:n.unresolvedCount,hasUnresolved:n.hasUnresolved,size:"sm"})]}),e.jsx(l,{variant:"ghost",size:"sm",onClick:m,children:e.jsx($,{className:"h-4 w-4"})})]})}),e.jsxs(E,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsx("span",{children:O}),p&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:u&&u!==p?`${p} - ${u}`:p})]})]}),t&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:t.name})]}),s.location&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx("span",{children:s.location})]}),s.description&&s.description!==s.title&&e.jsx("p",{className:"text-sm text-gray-700 mt-2",children:s.description})]}),v&&t&&e.jsxs(e.Fragment,{children:[e.jsx(w,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4"}),e.jsx("h3",{className:"font-medium",children:"Meeting Agenda"}),n.count>0&&e.jsxs(F,{variant:"secondary",className:"text-xs",children:[n.count," items"]})]}),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>h(!0),disabled:b,children:[e.jsx(Q,{className:"h-4 w-4 mr-1"}),"Add Item"]})]}),A&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-2 rounded",children:A}),R&&e.jsx(S,{className:"border-dashed",children:e.jsx(E,{className:"pt-4",children:e.jsx(ee,{teamMemberId:s.team_member_id,onSubmit:U,onCancel:()=>h(!1),initialData:{targetMeetingDate:s.start_date}})})}),b?e.jsx("div",{className:"text-center py-4 text-sm text-gray-500",children:"Loading agenda items..."}):C.length>0?e.jsx(W,{className:"max-h-64",children:e.jsx("div",{className:"space-y-2",children:C.map(a=>e.jsxs("div",{className:o("flex items-start gap-3 p-3 rounded-lg border transition-colors",a.status==="completed"?"bg-green-50 border-green-200":"bg-white border-gray-200 hover:bg-gray-50"),children:[e.jsx(l,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 mt-0.5",onClick:()=>L(a.id,a.status),children:a.status==="completed"?e.jsx(X,{className:"h-4 w-4 text-green-600"}):e.jsx(Y,{className:"h-4 w-4 text-gray-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:o("font-medium text-sm",a.status==="completed"&&"line-through text-gray-500"),children:a.title}),a.description&&e.jsx("p",{className:o("text-xs text-gray-600 mt-1",a.status==="completed"&&"line-through"),children:a.description}),a.priority&&a.priority!=="medium"&&e.jsxs(F,{variant:a.priority==="high"?"destructive":"secondary",className:"text-xs mt-1",children:[a.priority," priority"]})]}),a.status!=="completed"&&e.jsx(l,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",onClick:()=>P(a.id),title:"Move to next meeting",children:e.jsx(G,{className:"h-3 w-3"})})]},a.id))})}):e.jsxs("div",{className:"text-center py-6 text-sm text-gray-500",children:[e.jsx(M,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"No agenda items yet"}),e.jsx("p",{className:"text-xs mt-1",children:"Add items to prepare for this meeting"})]})]})]}),e.jsx(w,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex gap-2",children:t&&x&&e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>x(t.id),children:[e.jsx(I,{className:"h-4 w-4 mr-1"}),"View Profile"]})}),e.jsx(l,{variant:"outline",size:"sm",onClick:m,children:"Close"})]})]})]})}export{je as default};
