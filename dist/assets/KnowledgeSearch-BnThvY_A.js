import{j as e,a$ as me,q as xe,r as E,aW as ue,av as he,X as T,L as O,a8 as k,b$ as F,b_ as pe,p as R,v as ge,b5 as $}from"./chunk-WPKCbDK8.js";import{a as u}from"./chunk-BKwDNIOR.js";import{g as L,C as y,h as K,j as v,a4 as g,a5 as je,a6 as fe,a7 as ye,a8 as ve,a9 as Ne,aa as be,ab as we,ac as Ce,ad as Se,B as ee,i as Te,m as Re,k as H,I as Le,s as M}from"./index-B5nMAt-E.js";import{P as ke,B as Pe,C as _e}from"./chunk-DGs6foQ1.js";import{T as ae,a as se,b,c as w}from"./chunk-CqsX0BiM.js";import{P as s,R as P,B as U,h as X,X as Y,Y as J,T as _,f as Q,b as Ae,c as ze,C as De,e as Be}from"./chunk-BwuEqr1N.js";import{B as p}from"./chunk-zVvAqB5a.js";import{P as qe}from"./chunk-BZGnY1WQ.js";import{S as A,a as z,b as D,c as B,d as q}from"./chunk-CRMqQcWA.js";const Ee=({className:a,...l})=>e.jsx(Pe,{className:L("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",a),...l}),W=ke,Oe=({withHandle:a,className:l,...r})=>e.jsx(_e,{className:L("relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",l),...r,children:a&&e.jsx("div",{className:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border",children:e.jsx(me,{className:"h-2.5 w-2.5"})})});function Fe(a,l){if(a&&typeof a=="string")return He(a.toLowerCase());const r=l?.split(".").pop()?.toLowerCase();return r?Ke(r):"plaintext"}function He(a){return{js:"javascript",ts:"typescript",py:"python"}[a]||a}function Ke(a){return{js:"javascript",jsx:"javascript",mjs:"javascript",ts:"typescript",tsx:"typescript",py:"python",java:"java",go:"go",rs:"rust",rb:"ruby",html:"html",css:"css",scss:"scss",json:"json",yaml:"yaml",yml:"yaml",xml:"xml",sql:"sql",md:"markdown",sh:"bash",bash:"bash"}[a]||"plaintext"}function V({score:a,showLabel:l=!0,size:r="default"}){if(a==null)return null;const o=Math.round(a*100),c=()=>a>=.8?"default":a>=.6?"secondary":"outline",m=()=>a>=.8?"bg-green-500":a>=.6?"bg-yellow-500":"bg-gray-400",x=()=>a>=.8?"text-green-600 dark:text-green-400":a>=.6?"text-yellow-600 dark:text-yellow-400":"text-muted-foreground";return r==="compact"?e.jsxs(p,{variant:c(),className:"text-xs font-mono",children:[o,"%"]}):e.jsxs("div",{className:"flex items-center gap-2",children:[l&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"Relevance:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qe,{value:o,className:L("w-16 h-2",r==="small"&&"w-12 h-1.5"),indicatorClassName:m()}),e.jsxs("span",{className:L("text-xs font-mono",x()),children:[o,"%"]})]})]})}V.propTypes={score:s.number,showLabel:s.bool,size:s.oneOf(["default","small","compact"])};g.registerLanguage("javascript",fe);g.registerLanguage("typescript",ye);g.registerLanguage("python",ve);g.registerLanguage("java",Ne);g.registerLanguage("go",be);g.registerLanguage("json",we);g.registerLanguage("yaml",Ce);g.registerLanguage("bash",Se);function te({result:a}){const l=Fe(a.language,a.filePath||a.file_path),r=a.filePath||a.file_path||"unknown",o=a.code||a.content||"",c=a.repoName||a.repo_name||"",m=a.similarity||a.score||a.similarity_score;return e.jsxs(y,{className:"mb-4",children:[e.jsx(K,{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(xe,{className:"h-4 w-4 flex-shrink-0 text-muted-foreground"}),e.jsx("code",{className:"text-sm truncate",children:r})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[m!==void 0&&e.jsx(V,{score:m,showLabel:!1,size:"small"}),c&&e.jsx(p,{variant:"outline",className:"text-xs",children:c}),e.jsx(p,{variant:"secondary",className:"text-xs",children:l})]})]})}),e.jsx(v,{className:"pt-0 px-4 pb-4",children:e.jsx(g,{language:l,style:je,showLineNumbers:!0,wrapLines:!0,customStyle:{margin:0,borderRadius:"0.5rem",fontSize:"0.75rem",maxHeight:"300px",overflow:"auto"},children:o})})]})}te.propTypes={result:s.shape({language:s.string,filePath:s.string,file_path:s.string,code:s.string,content:s.string,repoName:s.string,repo_name:s.string,similarity:s.number,score:s.number,similarity_score:s.number,id:s.oneOfType([s.string,s.number])}).isRequired};function le({result:a}){const l=a.title||a.name||"Untitled",r=a.content||a.summary||"",o=a.domain||"",c=a.category||"",m=a.url||a.source_url||"",x=a.similarity||a.score||a.similarity_score;return e.jsxs(y,{className:"mb-4",children:[e.jsx(K,{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(E,{className:"h-4 w-4 flex-shrink-0 text-muted-foreground"}),e.jsx("span",{className:"font-medium truncate",children:l})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[x!==void 0&&e.jsx(V,{score:x,showLabel:!1,size:"small"}),o&&e.jsx(p,{variant:"outline",className:"text-xs",children:o}),c&&e.jsx(p,{variant:"secondary",className:"text-xs",children:c})]})]})}),e.jsxs(v,{className:"pt-0 px-4 pb-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-4",children:r}),m&&e.jsxs("a",{href:m,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 mt-2 text-xs text-primary hover:underline",children:[e.jsx(ue,{className:"h-3 w-3"}),"View source"]})]})]})}le.propTypes={result:s.shape({title:s.string,name:s.string,content:s.string,summary:s.string,domain:s.string,category:s.string,url:s.string,source_url:s.string,similarity:s.number,score:s.number,similarity_score:s.number,id:s.oneOfType([s.string,s.number])}).isRequired};const Ve=[{value:"all",label:"All Languages"},{value:"javascript",label:"JavaScript"},{value:"typescript",label:"TypeScript"},{value:"python",label:"Python"},{value:"java",label:"Java"},{value:"go",label:"Go"},{value:"rust",label:"Rust"},{value:"html",label:"HTML"},{value:"css",label:"CSS"}],Ie=[{value:"all",label:"All Types"},{value:"component",label:"Components"},{value:"service",label:"Services"},{value:"utility",label:"Utilities"},{value:"model",label:"Models"},{value:"hook",label:"Hooks"},{value:"api",label:"API Routes"}];function re({filters:a,setFilters:l,repositories:r=[]}){const o=t=>{l({...a,repoName:t==="all"?"":t})},c=t=>{l({...a,language:t==="all"?"":t})},m=t=>{l({...a,artifactType:t==="all"?"":t})},x=()=>{l({repoName:"",language:"",artifactType:""})},h=a.repoName||a.language||a.artifactType,j=[{value:"all",label:"All Repositories"},...r.map(t=>({value:t,label:t}))];return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(he,{className:"h-4 w-4"}),e.jsx("span",{children:"Filters:"})]}),e.jsxs(A,{value:a.repoName||"all",onValueChange:o,children:[e.jsx(z,{className:"w-[180px]",children:e.jsx(D,{placeholder:"Repository"})}),e.jsx(B,{children:j.map(t=>e.jsx(q,{value:t.value,children:t.label},t.value))})]}),e.jsxs(A,{value:a.language||"all",onValueChange:c,children:[e.jsx(z,{className:"w-[160px]",children:e.jsx(D,{placeholder:"Language"})}),e.jsx(B,{children:Ve.map(t=>e.jsx(q,{value:t.value,children:t.label},t.value))})]}),e.jsxs(A,{value:a.artifactType||"all",onValueChange:m,children:[e.jsx(z,{className:"w-[160px]",children:e.jsx(D,{placeholder:"Artifact Type"})}),e.jsx(B,{children:Ie.map(t=>e.jsx(q,{value:t.value,children:t.label},t.value))})]}),h&&e.jsxs(ee,{variant:"ghost",size:"sm",onClick:x,className:"text-muted-foreground",children:[e.jsx(T,{className:"h-4 w-4 mr-1"}),"Clear"]})]}),h&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.repoName&&e.jsxs(p,{variant:"secondary",className:"text-xs",children:["Repo: ",a.repoName,e.jsx("button",{onClick:()=>l({...a,repoName:""}),className:"ml-1 hover:text-destructive",children:e.jsx(T,{className:"h-3 w-3"})})]}),a.language&&e.jsxs(p,{variant:"secondary",className:"text-xs",children:["Lang: ",a.language,e.jsx("button",{onClick:()=>l({...a,language:""}),className:"ml-1 hover:text-destructive",children:e.jsx(T,{className:"h-3 w-3"})})]}),a.artifactType&&e.jsxs(p,{variant:"secondary",className:"text-xs",children:["Type: ",a.artifactType,e.jsx("button",{onClick:()=>l({...a,artifactType:""}),className:"ml-1 hover:text-destructive",children:e.jsx(T,{className:"h-3 w-3"})})]})]})]})}re.propTypes={filters:s.shape({repoName:s.string,language:s.string,artifactType:s.string}).isRequired,setFilters:s.func.isRequired,repositories:s.arrayOf(s.string)};const Z=["#8884d8","#82ca9d","#ffc658","#ff7c43","#a855f7","#06b6d4","#f43f5e"];function Ge(){const[a,l]=u.useState(null),[r,o]=u.useState(!0),[c,m]=u.useState(null);if(u.useEffect(()=>{async function d(){try{o(!0);const n=await H.knowledge.getStats();l(n),m(null)}catch(n){console.error("Failed to load stats:",n),m(n.message||"Failed to load repository statistics")}finally{o(!1)}}d()},[]),r)return e.jsx(y,{children:e.jsx(v,{className:"flex items-center justify-center h-64",children:e.jsx(O,{className:"h-8 w-8 animate-spin text-muted-foreground"})})});if(c)return e.jsx(y,{children:e.jsx(v,{className:"flex items-center justify-center h-64 text-muted-foreground",children:e.jsxs("div",{className:"text-center",children:[e.jsx(k,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:c})]})})});if(!a)return e.jsx(y,{children:e.jsx(v,{className:"flex items-center justify-center h-64 text-muted-foreground",children:e.jsxs("div",{className:"text-center",children:[e.jsx(k,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No statistics available"})]})})});const x=Object.entries(a.byArtifactType||a.by_artifact_type||{}).map(([d,n])=>({name:d,count:n})),h=Object.entries(a.byLanguage||a.by_language||{}).map(([d,n])=>({name:d,count:n})),j=Object.entries(a.byRepository||a.by_repository||{}).map(([d,n])=>({name:d,count:n})),t=a.totalItems||a.total_items||x.reduce((d,n)=>d+n.count,0);return e.jsxs(y,{children:[e.jsx(K,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(Te,{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5"}),"Repository Statistics"]}),e.jsx(Re,{children:"Indexed content breakdown from knowledge base"})]}),e.jsxs(p,{variant:"secondary",className:"text-lg px-3 py-1",children:[t.toLocaleString()," items"]})]})}),e.jsx(v,{children:e.jsxs(ae,{defaultValue:"type",children:[e.jsxs(se,{className:"mb-4",children:[e.jsxs(b,{value:"type",className:"gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),"By Type"]}),e.jsxs(b,{value:"language",className:"gap-2",children:[e.jsx(pe,{className:"h-4 w-4"}),"By Language"]}),e.jsxs(b,{value:"repo",className:"gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),"By Repository"]})]}),e.jsx(w,{value:"type",children:x.length>0?e.jsx(P,{width:"100%",height:300,children:e.jsxs(U,{data:x,children:[e.jsx(X,{strokeDasharray:"3 3"}),e.jsx(Y,{dataKey:"name"}),e.jsx(J,{}),e.jsx(_,{}),e.jsx(Q,{dataKey:"count",fill:"#8884d8"})]})}):e.jsx("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No artifact type data available"})}),e.jsx(w,{value:"language",children:h.length>0?e.jsx(P,{width:"100%",height:300,children:e.jsxs(Ae,{children:[e.jsx(ze,{data:h,dataKey:"count",nameKey:"name",cx:"50%",cy:"50%",outerRadius:100,label:({name:d,percent:n})=>`${d} (${(n*100).toFixed(0)}%)`,children:h.map((d,n)=>e.jsx(De,{fill:Z[n%Z.length]},`cell-${n}`))}),e.jsx(_,{}),e.jsx(Be,{})]})}):e.jsx("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No language data available"})}),e.jsx(w,{value:"repo",children:j.length>0?e.jsx(P,{width:"100%",height:300,children:e.jsxs(U,{data:j,layout:"vertical",children:[e.jsx(X,{strokeDasharray:"3 3"}),e.jsx(Y,{type:"number"}),e.jsx(J,{dataKey:"name",type:"category",width:150}),e.jsx(_,{}),e.jsx(Q,{dataKey:"count",fill:"#82ca9d"})]})}):e.jsx("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"No repository data available"})})]})})]})}const ea=()=>{const[a,l]=u.useState(""),[r,o]=u.useState([]),[c,m]=u.useState([]),[x,h]=u.useState(!1),[j,t]=u.useState(null),[d,n]=u.useState(!1),[C,ne]=u.useState("search"),[N,ie]=u.useState({repoName:"",language:"",artifactType:""}),[ce,oe]=u.useState([]),I=u.useCallback(async()=>{if(a.trim()){h(!0),t(null),n(!0);try{const[i,f]=await Promise.all([H.knowledge.searchCode({query:a.trim(),limit:20,repoName:N.repoName||void 0,language:N.language||void 0,artifactType:N.artifactType||void 0}),H.knowledge.searchDocs({query:a.trim(),limit:20})]);o(i.results||i||[]),m(f.results||f||[]);const G=[...new Set((i.results||i||[]).map(S=>S.repoName||S.repo_name).filter(Boolean))];G.length>0&&oe(S=>[...new Set([...S,...G])])}catch(i){console.error("Search failed:",i),t(i.message||"Search failed. Please try again.")}finally{h(!1)}}},[a,N]),de=i=>{i.key==="Enter"&&I()};return e.jsx("div",{className:"h-full flex flex-col",children:e.jsxs(ae,{value:C,onValueChange:ne,className:"h-full flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b bg-background",children:[e.jsxs("div",{className:"flex items-center gap-4 max-w-4xl mx-auto",children:[e.jsxs(se,{children:[e.jsxs(b,{value:"search",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Search"]}),e.jsxs(b,{value:"stats",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Statistics"]})]}),C==="search"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(R,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Le,{type:"text",placeholder:"Search code and documentation...",value:a,onChange:i=>l(i.target.value),onKeyDown:de,className:"pl-10"})]}),e.jsx(ee,{onClick:I,disabled:x||!a.trim(),children:x?e.jsx(O,{className:"h-4 w-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Search"]})})]})]}),C==="search"&&d&&e.jsx("div",{className:"mt-4 max-w-4xl mx-auto",children:e.jsx(re,{filters:N,setFilters:ie,repositories:ce})})]}),j&&C==="search"&&e.jsx("div",{className:"p-4 bg-destructive/10 border-b border-destructive/20",children:e.jsxs("div",{className:"flex items-center gap-2 text-destructive max-w-4xl mx-auto",children:[e.jsx(ge,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:j})]})}),e.jsx(w,{value:"search",className:"flex-1 min-h-0 mt-0",children:d?x?e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsx(O,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsxs(Ee,{direction:"horizontal",className:"h-full",children:[e.jsx(W,{defaultSize:50,minSize:25,children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"p-4 border-b bg-muted/30",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4"}),e.jsx("h2",{className:"font-semibold",children:"Code Results"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",r.length,")"]})]})}),e.jsx(M,{className:"flex-1 p-4",children:r.length===0?e.jsxs("div",{className:"text-center text-muted-foreground py-8",children:[e.jsx($,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No code results found"})]}):r.map((i,f)=>e.jsx(te,{result:i},i.id||f))})]})}),e.jsx(Oe,{withHandle:!0}),e.jsx(W,{defaultSize:50,minSize:25,children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"p-4 border-b bg-muted/30",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4"}),e.jsx("h2",{className:"font-semibold",children:"Documentation"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",c.length,")"]})]})}),e.jsx(M,{className:"flex-1 p-4",children:c.length===0?e.jsxs("div",{className:"text-center text-muted-foreground py-8",children:[e.jsx(E,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No documentation found"})]}):c.map((i,f)=>e.jsx(le,{result:i},i.id||f))})]})})]}):e.jsx("div",{className:"h-full flex items-center justify-center text-muted-foreground",children:e.jsxs("div",{className:"text-center",children:[e.jsx(R,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Enter a query to search code and documentation"})]})})}),e.jsx(w,{value:"stats",className:"flex-1 p-4 overflow-auto mt-0",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx(Ge,{})})})]})})};export{ea as default};
