const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CjGPc2b_.js","assets/chunk-CDfVSsCp.js","assets/chunk-pjYta8vt.js","assets/chunk-DGzW4aIb.js","assets/index-DrVmT_TS.css"])))=>i.map(i=>d[i]);
import{O as a,t as d,_ as m}from"./index-CjGPc2b_.js";class u{static async getAgendaItemsForMember(i){try{const s=await a.list(),t=[];for(const e of s){if(!Array.isArray(e.notes))continue;const n=e.notes.filter(r=>!r.referenced_entity||typeof r.referenced_entity!="object"?!1:r.referenced_entity.type==="team_member"&&String(r.referenced_entity.id)===String(i));for(const r of n){if(!e.date||!e.id){console.warn("Malformed meeting data, skipping agenda item:",e.id);continue}const o={id:`${e.id}-${r.timestamp||Date.now()}`,meetingId:e.id,meetingDate:new Date(e.date),noteText:r.text||"[No text available]",referencedMemberId:i,createdBy:r.created_by||e.team_member_id||"Unknown",meetingOwner:e.team_member_id||"Unknown",isDiscussed:r.isDiscussed||!1,discussedAt:r.discussedAt||null,timestamp:r.timestamp||e.created_date||new Date().toISOString()};t.push(o)}}return t.sort((e,n)=>new Date(n.meetingDate)-new Date(e.meetingDate)),t}catch(s){return console.error("Error getting agenda items for member:",s),[]}}static async getAgendaSummaryForAllMembers(){try{const[i,s]=await Promise.all([a.list(),d.list()]),t={};for(const e of s)t[e.id]={count:0,recentItems:[],hasUnresolved:!1};for(const e of i)if(Array.isArray(e.notes)){for(const n of e.notes)if(!(!n.referenced_entity||typeof n.referenced_entity!="object"||n.referenced_entity.type!=="team_member"||!n.referenced_entity.id)&&t[n.referenced_entity.id]){const r=n.referenced_entity.id,o=n.isDiscussed||!1;t[r].count++,o||(t[r].hasUnresolved=!0);const c={id:`${e.id}-${n.timestamp||Date.now()}`,meetingId:e.id,meetingDate:new Date(e.date),noteText:n.text,isDiscussed:o,meetingOwner:e.team_member_id};t[r].recentItems.push(c)}}for(const e in t)t[e].recentItems.sort((n,r)=>new Date(r.meetingDate)-new Date(n.meetingDate)),t[e].recentItems=t[e].recentItems.slice(0,3);return t}catch(i){return console.error("Error getting agenda summary for all members:",i),{}}}static async markAgendaItemDiscussed(i,s){try{const e=(await a.list()).find(o=>o.id===i);if(!e||!Array.isArray(e.notes))throw new Error("Meeting or notes not found");const n=e.notes.findIndex(o=>o.timestamp===s);if(n===-1)throw new Error("Note not found");const r=[...e.notes];return r[n]={...r[n],isDiscussed:!0,discussedAt:new Date().toISOString()},await a.update(i,{...e,notes:r}),!0}catch(t){return console.error("Error marking agenda item as discussed:",t),!1}}static async getFilteredAgendaItems(i,s=!0){try{const t=await this.getAgendaItemsForMember(i);return s?t:t.filter(e=>!e.isDiscussed)}catch(t){return console.error("Error getting filtered agenda items:",t),[]}}static async getAgendaItemsGroupedByMeeting(i){try{const s=await this.getAgendaItemsForMember(i),t={};for(const e of s)t[e.meetingId]||(t[e.meetingId]={meetingId:e.meetingId,meetingDate:e.meetingDate,meetingOwner:e.meetingOwner,items:[]}),t[e.meetingId].items.push(e);return t}catch(s){return console.error("Error grouping agenda items by meeting:",s),{}}}static async getUnresolvedItemsCount(i){try{return(await this.getFilteredAgendaItems(i,!1)).length}catch(s){return console.error("Error getting unresolved items count:",s),0}}static async getAgendaItemsForPeer(i){try{const s=await a.list(),t=[];for(const e of s){if(!Array.isArray(e.notes))continue;const n=e.notes.filter(r=>!r.referenced_entity||typeof r.referenced_entity!="object"?!1:r.referenced_entity.type==="peer"&&String(r.referenced_entity.id)===String(i));for(const r of n){if(!e.date||!e.id)continue;const o={id:`${e.id}-${r.timestamp||Date.now()}`,meetingId:e.id,meetingDate:new Date(e.date),noteText:r.text||"[No text available]",referencedPeerId:i,createdBy:r.created_by||e.peer_id||"Unknown",meetingOwner:e.peer_id||"Unknown",isDiscussed:r.isDiscussed||!1,discussedAt:r.discussedAt||null,timestamp:r.timestamp||e.created_date||new Date().toISOString()};t.push(o)}}return t.sort((e,n)=>new Date(n.meetingDate)-new Date(e.meetingDate)),t}catch(s){return console.error("Error getting agenda items for peer:",s),[]}}static async getAgendaSummaryForAllPeers(){try{const[i,s]=await Promise.all([a.list(),m(()=>import("./index-CjGPc2b_.js").then(e=>e.G),__vite__mapDeps([0,1,2,3,4])).then(e=>e.Peer.list())]),t={};for(const e of s)t[e.id]={count:0,recentItems:[],hasUnresolved:!1};for(const e of i)if(Array.isArray(e.notes)){for(const n of e.notes)if(!(!n.referenced_entity||typeof n.referenced_entity!="object"||n.referenced_entity.type!=="peer"||!n.referenced_entity.id)&&t[n.referenced_entity.id]){const r=n.referenced_entity.id,o=n.isDiscussed||!1;t[r].count++,o||(t[r].hasUnresolved=!0);const c={id:`${e.id}-${n.timestamp||Date.now()}`,meetingId:e.id,meetingDate:new Date(e.date),noteText:n.text,isDiscussed:o,meetingOwner:e.peer_id};t[r].recentItems.push(c)}}for(const e in t)t[e].recentItems.sort((n,r)=>new Date(r.meetingDate)-new Date(n.meetingDate)),t[e].recentItems=t[e].recentItems.slice(0,3);return t}catch(i){return console.error("Error getting agenda summary for all peers:",i),{}}}static async getFilteredAgendaItemsForPeer(i,s=!0){try{const t=await this.getAgendaItemsForPeer(i);return s?t:t.filter(e=>!e.isDiscussed)}catch(t){return console.error("Error getting filtered agenda items for peer:",t),[]}}static async getAgendaItemsGroupedByMeetingForPeer(i){try{const s=await this.getAgendaItemsForPeer(i),t={};for(const e of s)t[e.meetingId]||(t[e.meetingId]={meetingId:e.meetingId,meetingDate:e.meetingDate,meetingOwner:e.meetingOwner,items:[]}),t[e.meetingId].items.push(e);return t}catch(s){return console.error("Error grouping agenda items by meeting for peer:",s),{}}}static async getUnresolvedItemsCountForPeer(i){try{return(await this.getFilteredAgendaItemsForPeer(i,!1)).length}catch(s){return console.error("Error getting unresolved items count for peer:",s),0}}}export{u as A};
