import{j as e,aE as E,aF as _,aG as q,aH as z,ag as B,ah as H,aI as N,aJ as w,Y as v,a2 as L,aK as G,d as K,h as J,ai as Y,at as Q,q as V,$ as C,a0 as k}from"./chunk-CDfVSsCp.js";import{a as b,R as T}from"./chunk-pjYta8vt.js";import{e as D,C as W,g as X,h as Z,B as u,f as ee,L as se,t as ae}from"./index-CjGPc2b_.js";import{B as j,D as te,e as re,f as ie,g as ce,h as le}from"./chunk-2Vqr1Avx.js";import{D as ne,a as de,b as oe,d as h,e as A}from"./chunk-BrWpdzOD.js";import{T as me}from"./chunk-BRoLf8OO.js";import{A as xe}from"./chunk-BaIpbNob.js";import{f as M,p as he}from"./chunk-DGzW4aIb.js";import{s as U}from"./chunk-BdHZTqfh.js";const I=b.forwardRef(({className:a,...l},m)=>e.jsx(E,{ref:m,className:D("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...l,children:e.jsx(_,{className:D("flex items-center justify-center text-current"),children:e.jsx(q,{className:"h-4 w-4"})})}));I.displayName=E.displayName;function S({task:a,onEdit:l,onDelete:m,onStatusChange:c}){const s={title:"",description:"",type:"generic",status:"todo",priority:"medium",tags:[],stakeholders:[],strategic:!1,...a},x=Array.isArray(s.tags)?s.tags:[],i=Array.isArray(s.stakeholders)?s.stakeholders:[],[n,o]=T.useState([]);T.useEffect(()=>{(async()=>{try{const t=await ae.list();o(t)}catch(t){console.error("Failed to load team members:",t)}})()},[]);const p=()=>{switch(s.status){case"done":return e.jsx(v,{className:"h-5 w-5 text-green-500"});case"in_progress":return e.jsx(w,{className:"h-5 w-5 text-blue-500"});case"blocked":return e.jsx(V,{className:"h-5 w-5 text-red-500"});case"backlog":return e.jsx(Q,{className:"h-5 w-5 text-gray-500"});default:return e.jsx(N,{className:"h-5 w-5 text-gray-400"})}},O=()=>{switch(s.type){case"meeting":return"bg-blue-100 text-blue-800";case"metric":return"bg-green-100 text-green-800";case"action":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},$=()=>{switch(s.priority){case"low":return"bg-blue-100 text-blue-800";case"medium":return"bg-yellow-100 text-yellow-800";case"high":return"bg-orange-100 text-orange-800";case"urgent":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},P=async(r,t)=>{const d={...a};d.subtasks=[...a.subtasks||[]],d.subtasks[r]={...d.subtasks[r],done:t},c&&c(d,a.status)},[F,g]=b.useState(!1),[y,f]=b.useState(""),R=async()=>{if(!y.trim())return;const r={...a,updates:[...a.updates||[],{text:y.trim(),date:new Date().toISOString()}]};g(!1),f(""),c&&c(r,a.status)};return e.jsxs(e.Fragment,{children:[e.jsxs(W,{className:"shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(X,{className:"pb-2",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"mt-0.5",onClick:()=>c?.(s,s.status==="done"?"todo":"done"),children:p()}),e.jsxs("div",{children:[e.jsx(Z,{className:`text-base ${s.status==="done"?"line-through text-gray-500":""}`,children:s.title}),s.project&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1 flex items-center gap-1",children:[e.jsx(z,{className:"h-3 w-3"}),s.project]})]})]}),e.jsxs(ne,{children:[e.jsx(de,{asChild:!0,children:e.jsx(u,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(B,{className:"h-4 w-4"})})}),e.jsxs(oe,{align:"end",children:[e.jsxs(h,{onClick:()=>l?.(s),children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsx(A,{}),e.jsxs(h,{onClick:()=>c?.(s,"todo"),children:[e.jsx(N,{className:"mr-2 h-4 w-4"}),"Mark as Todo"]}),e.jsxs(h,{onClick:()=>c?.(s,"in_progress"),children:[e.jsx(w,{className:"mr-2 h-4 w-4"}),"Mark as In Progress"]}),e.jsxs(h,{onClick:()=>c?.(s,"done"),children:[e.jsx(v,{className:"mr-2 h-4 w-4"}),"Mark as Done"]}),e.jsx(A,{}),e.jsxs(h,{onClick:()=>m?.(s),className:"text-red-600",children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})}),e.jsxs(ee,{children:[s.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:s.description}),Array.isArray(s.subtasks)&&s.subtasks.length>0&&e.jsxs("div",{className:"mb-3 space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Subtasks"}),e.jsx("div",{className:"space-y-2",children:s.subtasks.map((r,t)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{checked:r.done,onCheckedChange:d=>P(t,d),id:`subtask-${a.id}-${t}`}),e.jsx("label",{htmlFor:`subtask-${a.id}-${t}`,className:`text-sm ${r.done?"line-through text-gray-500":"text-gray-700"}`,children:r.title})]},t))})]}),e.jsxs("div",{className:"flex flex-wrap gap-1.5 mb-3",children:[e.jsx(j,{className:O(),children:s.type}),e.jsx(j,{className:$(),children:s.priority}),s.strategic&&e.jsxs(j,{variant:"outline",className:"flex items-center gap-1",children:[e.jsx(G,{className:"h-3 w-3"}),"Strategic"]})]}),x.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:x.map((r,t)=>e.jsx(j,{variant:"secondary",className:"text-xs",children:r},t))}),s.due_date&&e.jsxs("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[e.jsx(K,{className:"h-4 w-4 mr-1"}),e.jsxs("span",{children:["Due ",M(new Date(s.due_date),"PPp")]})]}),i.length>0&&e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(J,{className:"h-4 w-4 mr-1"}),e.jsxs("span",{children:["Stakeholders: ",i.join(", ")]})]}),i.length>0&&n.length>0&&e.jsx("div",{className:"mt-3 space-y-2",children:i.map(r=>{const t=n.find(d=>d.name===r);return t?e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsx("span",{className:"text-sm font-medium",children:t.name}),e.jsx(xe,{teamMemberId:t.id,teamMemberName:t.name,sourceItem:{title:s.title,description:s.description,type:"task",id:s.id,priority:s.priority,status:s.status},variant:"outline",size:"sm"})]},t.id):null})}),Array.isArray(a.updates)&&a.updates.length>0&&e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Updates"}),a.updates.slice(0,2).map((r,t)=>e.jsxs("div",{className:"text-sm text-gray-600 bg-gray-50 p-2 rounded",children:[e.jsx("p",{children:r.text}),e.jsx("span",{className:"text-xs text-gray-500",children:M(he(r.date),"MMM d, yyyy")})]},t))]}),e.jsxs(u,{variant:"ghost",size:"sm",className:"mt-2",onClick:()=>g(!0),children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Add Update"]})]})]}),e.jsx(te,{open:F,onOpenChange:g,children:e.jsxs(re,{children:[e.jsx(ie,{children:e.jsx(ce,{children:"Add Progress Update"})}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(se,{children:"Update Details"}),e.jsx(me,{value:y,onChange:r=>f(r.target.value),placeholder:"Share progress, blockers, or achievements...",rows:4})]})}),e.jsxs(le,{children:[e.jsx(u,{variant:"outline",onClick:()=>g(!1),children:"Cancel"}),e.jsx(u,{onClick:R,children:"Add Update"})]})]})})]})}function Ce({tasks:a=[],onEditTask:l,onDeleteTask:m,onStatusChange:c,groupBy:s=null}){const x=U(a);if(x.length===0)return e.jsx("div",{className:"text-center p-8 border border-dashed rounded-lg bg-gray-50",children:e.jsx("p",{className:"text-gray-500",children:"No active tasks found"})});if(s){const i={};return x.forEach(n=>{const o=pe(n,s);i[o]||(i[o]=[]),i[o].push(n)}),e.jsx("div",{className:"space-y-6",children:Object.entries(i).map(([n,o])=>e.jsxs("div",{className:"border rounded-lg p-4 bg-white",children:[e.jsx("h3",{className:"font-medium mb-4 text-lg border-b pb-2",children:n}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:e.jsx(C,{children:U(o).map(p=>e.jsx(k.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:e.jsx(S,{task:p,onEdit:l,onDelete:m,onStatusChange:c})},p.id))})})]},n))})}return e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:e.jsx(C,{children:x.map(i=>e.jsx(k.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:e.jsx(S,{task:i,onEdit:l,onDelete:m,onStatusChange:c})},i.id))})})}function pe(a,l){if(!a)return"Other";switch(l){case"strategic":return a.strategic?"Strategic":"Tactical";case"type":return a.type?.charAt(0).toUpperCase()+a.type?.slice(1)||"Other";case"priority":return a.priority?.charAt(0).toUpperCase()+a.priority?.slice(1)||"Other";default:return a[l]||"Other"}}export{Ce as T};
