const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TeamMemberDeletionDialog-BmXHMHA8.js","assets/chunk-8WlaufA8.js","assets/chunk-pjYta8vt.js","assets/chunk-Cg2ZZDgQ.js","assets/chunk-BQPSriyy.js","assets/index-BK5E59O8.js","assets/index-CO3VviEi.css","assets/chunk-Bw8oe1_L.js","assets/chunk-DHsBTIyN.js"])))=>i.map(i=>d[i]);
import{e as f,T as re,B as p,A as ne,b as ie,I as h,g as oe,i as ce,p as de,q as me,s as he,j as xe,k as ge,h as ue,l as pe,L as c,C as je,f as ve,m as ye,r as fe,_ as Ne}from"./index-BK5E59O8.js";import{j as e,Y as I,J as Ce,al as we,am as be,a0 as ke,ar as De,as as Ae,at as Me,aa as Se,au as Te}from"./chunk-8WlaufA8.js";import{j as Fe,a as r}from"./chunk-pjYta8vt.js";import{A as Ee}from"./chunk-B6BcMUO9.js";import{A as _e}from"./chunk-Dm0CwYXu.js";import{T as Pe}from"./chunk-DSRmHbBO.js";import{B as N,D as $,a as B,b as Le,c as Ie,d as $e}from"./chunk-Cg2ZZDgQ.js";import{S as Be,a as Re,b as Ue,c as Oe,d as C}from"./chunk-DktN3Kjy.js";import{D as Ve,a as ze,b as He,d as R}from"./chunk-DvQYMAQ6.js";import{T as qe}from"./chunk-UjCvYLMJ.js";import{C as A}from"./chunk-DTiRvVQj.js";import"./chunk-BQPSriyy.js";import"./chunk-BdHZTqfh.js";import"./chunk-CJViCmxo.js";const Qe=r.lazy(()=>fe(()=>Ne(()=>import("./TeamMemberDeletionDialog-BmXHMHA8.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])),3,1e3));function ca(){const U=Fe(),[Ye,O]=r.useState([]),[M,V]=r.useState([]),[Ge,z]=r.useState({}),[d,H]=r.useState(""),[q,x]=r.useState(!1),[m,S]=r.useState(null),[Q,T]=r.useState(!0),[w,g]=r.useState(!1),[Y,b]=r.useState(null),[F,j]=r.useState(null),[n,v]=r.useState({name:"",role:"",email:"",phone:"",department:"",availability:"full_time",skills:[],notes:"",avatar:""});r.useEffect(()=>{k()},[]);const k=async()=>{T(!0),j(null);try{const a=await f.list().catch(()=>[]),t=await re.list().catch(()=>[]);O(t||[]);let s={};try{s=await Ee.getAgendaSummaryForAllMembers()}catch(l){console.error("Failed to load agenda data:",l)}z(s);const i=(a||[]).map(l=>{const y=(t||[]).filter(u=>(u.metadata?.meeting?.participants||[]).includes(l.name));let D=null;y.length>0&&(D=y.reduce((u,le)=>{const L=new Date(le.created_date);return!u||L>u?L:u},null));const te=s[l.id]||{count:0,recentItems:[],hasUnresolved:!1};return{...l,tasks:y,taskCount:y.length,lastActivity:D?D.toISOString():null,agenda:te}});V(i)}catch(a){console.error("Failed to load team members:",a),j("Failed to load team members. Please try again.")}finally{T(!1)}},E=()=>{v({name:"",role:"",email:"",phone:"",department:"",availability:"full_time",skills:[],notes:"",avatar:""}),S(null),x(!0)},G=a=>{a&&(v({name:a.name||"",role:a.role||"",email:a.email||"",phone:a.phone||"",department:a.department||"",availability:a.availability||"full_time",skills:Array.isArray(a.skills)?a.skills:[],notes:a.notes||"",avatar:a.avatar||""}),S(a),x(!0))},o=(a,t)=>{if(a==="skills"){const s=Array.isArray(t)?t:[];v(i=>({...i,[a]:s}))}else v(s=>({...s,[a]:t}))},J=async()=>{try{let a;const t=m?{...m}:null;if(m){a=await f.update(m.id,n);try{await A.handleTeamMemberUpdate(m.id,a,t)}catch(s){console.error("Failed to update birthday events:",s)}}else{a=await f.create(n);try{await A.handleTeamMemberCreation(a)}catch(s){console.error("Failed to generate birthday events:",s)}}x(!1),await k()}catch(a){console.error("Failed to save team member:",a),j("Failed to save team member. Please try again.")}},K=a=>{b(a),g(!0)},W=async(a,t)=>{try{try{await A.handleTeamMemberDeletion(a)}catch(s){console.error("Failed to clean up calendar events:",s)}await f.delete(a),g(!1),b(null),await k()}catch(s){console.error("Failed to delete team member:",s),j("Failed to delete team member. Please try again.")}},X=()=>{g(!1),b(null)},_=d?M.filter(a=>a.name.toLowerCase().includes(d.toLowerCase())||(a.role||"").toLowerCase().includes(d.toLowerCase())||(a.department||"").toLowerCase().includes(d.toLowerCase())||Array.isArray(a.skills)&&a.skills.some(t=>t.toLowerCase().includes(d.toLowerCase()))):M,Z=a=>a.split(" ").map(t=>t[0]).join("").toUpperCase().substring(0,2),ee=a=>{const t=["bg-blue-100 text-blue-800","bg-green-100 text-green-800","bg-purple-100 text-purple-800","bg-pink-100 text-pink-800","bg-yellow-100 text-yellow-800","bg-indigo-100 text-indigo-800","bg-red-100 text-red-800","bg-orange-100 text-orange-800"],s=a.split("").reduce((i,l)=>i+l.charCodeAt(0),0)%t.length;return t[s]},ae=a=>{if(!a)return"No recent activity";const t=new Date(a),i=new Date-t,l=Math.floor(i/(1e3*60*60*24));return l===0?"Today":l===1?"Yesterday":l<7?`${l} days ago`:l<30?`${Math.floor(l/7)} week${Math.floor(l/7)>1?"s":""} ago`:l<365?`${Math.floor(l/30)} month${Math.floor(l/30)>1?"s":""} ago`:`${Math.floor(l/365)} year${Math.floor(l/365)>1?"s":""} ago`},se=a=>{const t={full_time:"bg-green-100 text-green-800",part_time:"bg-blue-100 text-blue-800",contractor:"bg-orange-100 text-orange-800",remote:"bg-purple-100 text-purple-800"},s={full_time:"Full-time",part_time:"Part-time",contractor:"Contractor",remote:"Remote"};return e.jsx(N,{className:t[a]||"bg-gray-100 text-gray-800",children:s[a]||a})},P=a=>{U(ye("TeamMemberProfile")+`?id=${a}`)};return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Team Members"}),e.jsxs(p,{onClick:E,children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Add Team Member"]})]}),F&&e.jsx(ne,{variant:"destructive",className:"mb-6",children:e.jsx(ie,{children:F})}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx(Ce,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(h,{placeholder:"Search team members by name, role, department, or skills...",value:d,onChange:a=>H(a.target.value),className:"pl-9"})]}),Q?e.jsxs("div",{className:"text-center p-12",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-indigo-600 border-t-transparent rounded-full mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading team members..."})]}):_.length===0?e.jsx("div",{className:"text-center p-12 border border-dashed rounded-lg",children:d?e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No team members found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your search term"})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No team members yet"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Add team members to track participants in meetings and collaboration"}),e.jsxs(p,{onClick:E,children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Add First Team Member"]})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:_.map(a=>{const t=ee(a.name);return e.jsxs(oe,{className:"overflow-hidden",children:[e.jsxs(ce,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-4 cursor-pointer group",onClick:()=>P(a.id),children:[e.jsxs(de,{className:`h-12 w-12 ${a.avatar?"":t} ring-2 ring-white transition-transform group-hover:scale-105`,children:[a.avatar?e.jsx(me,{src:a.avatar,alt:a.name}):null,e.jsx(he,{children:Z(a.name)})]}),e.jsxs("div",{children:[e.jsx(xe,{className:"group-hover:text-indigo-600 transition-colors",children:a.name}),a.role&&e.jsx(ge,{className:"mt-1",children:a.role})]})]}),e.jsxs(Ve,{children:[e.jsx(ze,{asChild:!0,children:e.jsx(p,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(we,{className:"h-4 w-4"})})}),e.jsxs(He,{align:"end",children:[e.jsxs(R,{onClick:()=>G(a),children:[e.jsx(be,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(R,{onClick:()=>K(a),className:"text-red-600",children:[e.jsx(ke,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 flex-wrap",children:[a.department&&e.jsxs(N,{variant:"outline",className:"flex items-center gap-1",children:[e.jsx(De,{className:"h-3 w-3"}),a.department]}),a.availability&&se(a.availability),a.agenda&&e.jsx(_e,{count:a.agenda.count,unresolvedCount:a.agenda.hasUnresolved?a.agenda.count:0,hasUnresolved:a.agenda.hasUnresolved,onClick:()=>P(a.id),memberName:a.name,size:"sm"})]})]}),e.jsxs(ue,{className:"space-y-4",children:[Array.isArray(a.skills)&&a.skills.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-500 mb-2 flex items-center gap-1",children:[e.jsx(Ae,{className:"h-3.5 w-3.5"}),"Skills"]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:Array.isArray(a.skills)&&a.skills.map((s,i)=>e.jsx(N,{variant:"outline",className:"text-xs",children:s},i))})]}),a.notes&&e.jsx("p",{className:"text-sm text-gray-600",children:a.notes}),Array.isArray(a.tasks)&&a.tasks.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:"Recent Meetings"}),e.jsx("div",{className:"space-y-2",children:a.tasks.filter(s=>s.type==="meeting").sort((s,i)=>new Date(i.created_date)-new Date(s.created_date)).slice(0,2).map(s=>e.jsx("div",{className:"p-2 bg-gray-50 rounded-md text-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"truncate",children:s.title}),e.jsxs(N,{variant:"outline",className:"ml-2 flex items-center gap-1 whitespace-nowrap",children:[e.jsx(Me,{className:"h-3 w-3"}),s.status]})]})},s.id))})]}),e.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Se,{className:"h-3 w-3"}),ae(a.lastActivity)]}),a.taskCount>0&&e.jsxs("span",{children:[a.taskCount," meetings"]})]})]}),a.email&&e.jsx(pe,{className:"border-t pt-4",children:e.jsxs("a",{href:`mailto:${a.email}`,className:"text-sm text-blue-600 hover:underline flex items-center gap-1",children:[e.jsx(Te,{className:"h-3.5 w-3.5"}),a.email]})})]},a.id)})})]}),e.jsx($,{open:q,onOpenChange:x,children:e.jsxs(B,{className:"sm:max-w-md",children:[e.jsx(Le,{children:e.jsx(Ie,{children:m?"Edit Team Member":"Add Team Member"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"name",children:"Name"}),e.jsx(h,{id:"name",value:n.name,onChange:a=>o("name",a.target.value),placeholder:"Full name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"role",children:"Role / Position"}),e.jsx(h,{id:"role",value:n.role,onChange:a=>o("role",a.target.value),placeholder:"e.g. Product Manager"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"department",children:"Department"}),e.jsx(h,{id:"department",value:n.department,onChange:a=>o("department",a.target.value),placeholder:"e.g. Engineering"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"email",children:"Email"}),e.jsx(h,{id:"email",type:"email",value:n.email,onChange:a=>o("email",a.target.value),placeholder:"Email address"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"phone",children:"Phone"}),e.jsx(h,{id:"phone",type:"tel",value:n.phone,onChange:a=>o("phone",a.target.value),placeholder:"Phone number"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"availability",children:"Availability"}),e.jsxs(Be,{value:n.availability,onValueChange:a=>o("availability",a),children:[e.jsx(Re,{children:e.jsx(Ue,{placeholder:"Select availability"})}),e.jsxs(Oe,{children:[e.jsx(C,{value:"full_time",children:"Full-time"}),e.jsx(C,{value:"part_time",children:"Part-time"}),e.jsx(C,{value:"contractor",children:"Contractor"}),e.jsx(C,{value:"remote",children:"Remote"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"skills",children:"Skills"}),e.jsx(qe,{value:n.skills||[],onChange:a=>o("skills",a),placeholder:"Enter skills, press Enter or comma to add"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Press Enter or comma after each skill"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"avatar",children:"Avatar URL (optional)"}),e.jsx(h,{id:"avatar",value:n.avatar,onChange:a=>o("avatar",a.target.value),placeholder:"https://example.com/avatar.jpg"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"notes",children:"Notes"}),e.jsx(Pe,{id:"notes",value:n.notes,onChange:a=>o("notes",a.target.value),placeholder:"Additional information about this team member",rows:3})]})]}),e.jsxs($e,{children:[e.jsx(p,{variant:"outline",onClick:()=>x(!1),children:"Cancel"}),e.jsx(p,{onClick:J,children:m?"Update":"Add"})]})]})}),w&&e.jsx(je,{componentName:"Team Member Deletion Dialog",children:e.jsx(r.Suspense,{fallback:e.jsx($,{open:w,onOpenChange:g,children:e.jsx(B,{children:e.jsx(ve,{})})}),children:e.jsx(Qe,{open:w,onOpenChange:g,teamMember:Y,onConfirm:W,onCancel:X})})})]})}export{ca as default};
