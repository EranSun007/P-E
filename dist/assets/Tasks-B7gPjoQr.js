const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TaskCreationForm-uUOFczhl.js","assets/chunk-DHGN2BiO.js","assets/chunk-pjYta8vt.js","assets/chunk-KzYfAQy1.js","assets/index-ByFAet0J.js","assets/chunk-CZDJnSNg.js","assets/index-zbygvEX7.css","assets/chunk-Dt0Bnklg.js","assets/chunk-D3uHh-f_.js","assets/chunk-Cwmy-p0V.js","assets/chunk-C6AVtkQH.js","assets/chunk-BdHZTqfh.js","assets/chunk-DSBO3d0u.js","assets/chunk-BxZc7glH.js"])))=>i.map(i=>d[i]);
import{I as Q,B as m,T as k,A as U,a as W,b as X,C as Y,F as Z,r as ee,_ as se}from"./index-ByFAet0J.js";import{j as e,J as ae,K as te,X as M,N as L,Q as re,W as ie,Y as le,Z as ne,_ as z,S as ce,$ as oe,a0 as de}from"./chunk-DHGN2BiO.js";import{a as h}from"./chunk-pjYta8vt.js";import{T as he}from"./chunk-BgLGKXe7.js";import{D as I,a as H,b as R,c}from"./chunk-DebkpaDS.js";import{B as S}from"./chunk-C6AVtkQH.js";import{S as V,a as G,b as me,c as $,d as y}from"./chunk-D3uHh-f_.js";import{T as xe,a as ue,b as q,c as b,d as ge,e as A}from"./chunk-BFC3YuxX.js";import{f as pe}from"./chunk-CZDJnSNg.js";import"./chunk-D7j8sKMm.js";import"./chunk-Dt0Bnklg.js";import"./chunk-UtEqcWk6.js";import"./chunk-PmtS5Ynq.js";import"./chunk-BdHZTqfh.js";function ye({filters:f={status:[],priority:[],type:[],search:"",tags:[],strategic:null,groupBy:"none"},setFilters:x,availableTags:v=[]}){const s={status:[],priority:[],type:[],search:"",tags:[],strategic:null,groupBy:"none",...f};s.status=Array.isArray(s.status)?s.status:[],s.priority=Array.isArray(s.priority)?s.priority:[],s.type=Array.isArray(s.type)?s.type:[],s.tags=Array.isArray(s.tags)?s.tags:[];const N=()=>{x({status:[],priority:[],type:[],search:"",tags:[],strategic:null,groupBy:"none"})},u=s.status.length>0||s.priority.length>0||s.type.length>0||s.tags.length>0||s.strategic!==null||s.search,r=(t,o)=>{const C=s[t]||[];x(p=>C.includes(o)?{...p,[t]:C.filter(F=>F!==o)}:{...p,[t]:[...C,o]})},j=t=>{r("tags",t)},w=t=>{x(o=>({...o,search:t.target.value}))},g=t=>{x(o=>({...o,strategic:t==="all"?null:t==="strategic"}))},l=t=>{x(o=>({...o,groupBy:t}))};return e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx(ae,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Q,{placeholder:"Search tasks...",value:s.search,onChange:w,className:"pl-9"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{children:[e.jsx(H,{asChild:!0,children:e.jsxs(m,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-4 w-4"}),"Filters",u&&e.jsx(S,{className:"h-5 w-5 p-0 flex items-center justify-center",children:s.status.length+s.type.length+s.priority.length+s.tags.length+(s.strategic!==null?1:0)})]})}),e.jsxs(R,{className:"w-56",align:"end",children:[e.jsxs("div",{className:"p-2",children:[e.jsx("h4",{className:"mb-2 font-medium text-sm",children:"Status"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(c,{checked:s.status.includes("todo"),onCheckedChange:()=>r("status","todo"),children:"Todo"}),e.jsx(c,{checked:s.status.includes("in_progress"),onCheckedChange:()=>r("status","in_progress"),children:"In Progress"}),e.jsx(c,{checked:s.status.includes("blocked"),onCheckedChange:()=>r("status","blocked"),children:"Blocked"}),e.jsx(c,{checked:s.status.includes("done"),onCheckedChange:()=>r("status","done"),children:"Done"})]})]}),e.jsx("hr",{className:"my-2"}),e.jsxs("div",{className:"p-2",children:[e.jsx("h4",{className:"mb-2 font-medium text-sm",children:"Type"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(c,{checked:s.type.includes("generic"),onCheckedChange:()=>r("type","generic"),children:"Generic"}),e.jsx(c,{checked:s.type.includes("meeting"),onCheckedChange:()=>r("type","meeting"),children:"Meeting"}),e.jsx(c,{checked:s.type.includes("metric"),onCheckedChange:()=>r("type","metric"),children:"Metric"}),e.jsx(c,{checked:s.type.includes("action"),onCheckedChange:()=>r("type","action"),children:"Action"})]})]}),e.jsx("hr",{className:"my-2"}),e.jsxs("div",{className:"p-2",children:[e.jsx("h4",{className:"mb-2 font-medium text-sm",children:"Priority"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(c,{checked:s.priority.includes("low"),onCheckedChange:()=>r("priority","low"),children:"Low"}),e.jsx(c,{checked:s.priority.includes("medium"),onCheckedChange:()=>r("priority","medium"),children:"Medium"}),e.jsx(c,{checked:s.priority.includes("high"),onCheckedChange:()=>r("priority","high"),children:"High"}),e.jsx(c,{checked:s.priority.includes("urgent"),onCheckedChange:()=>r("priority","urgent"),children:"Urgent"})]})]}),u&&e.jsx("div",{className:"border-t p-2",children:e.jsxs(m,{variant:"ghost",className:"w-full text-sm h-8 text-blue-600",onClick:N,children:[e.jsx(M,{className:"h-3.5 w-3.5 mr-1"})," Clear filters"]})})]})]}),e.jsxs(V,{value:s.strategic===null?"all":s.strategic?"strategic":"tactical",onValueChange:g,children:[e.jsx(G,{className:"w-[130px]",children:e.jsx(me,{placeholder:"Focus"})}),e.jsxs($,{children:[e.jsx(y,{value:"all",children:"All tasks"}),e.jsx(y,{value:"strategic",children:"Strategic"}),e.jsx(y,{value:"tactical",children:"Tactical"})]})]})]})]}),s.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsx(L,{className:"h-4 w-4 text-gray-500"}),s.tags.map(t=>e.jsxs(S,{variant:"secondary",className:"flex gap-1 items-center cursor-pointer",onClick:()=>j(t),children:[t,e.jsx(M,{className:"h-3 w-3"})]},t)),e.jsx(m,{variant:"ghost",size:"sm",className:"h-7 text-xs text-blue-600",onClick:()=>x(t=>({...t,tags:[]})),children:"Clear tags"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex gap-4 items-center",children:[v.length>0&&e.jsxs(I,{children:[e.jsx(H,{asChild:!0,children:e.jsxs(m,{variant:"outline",size:"sm",children:[e.jsx(L,{className:"h-3.5 w-3.5 mr-1"})," Tags"]})}),e.jsx(R,{children:e.jsx("div",{className:"grid grid-cols-2 gap-1 p-1",children:v.slice(0,10).map(t=>e.jsxs(m,{variant:"ghost",size:"sm",className:`text-xs justify-start ${s.tags.includes(t)?"bg-slate-100":""}`,onClick:()=>j(t),children:[s.tags.includes(t)&&e.jsx(re,{className:"h-3 w-3 mr-1"}),t]},t))})})]}),e.jsx("div",{children:e.jsxs(V,{value:s.groupBy,onValueChange:l,children:[e.jsx(G,{className:"text-sm h-9",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ie,{className:"h-3.5 w-3.5 mr-2"}),"Group by"]})}),e.jsxs($,{children:[e.jsx(y,{value:"none",children:"No grouping"}),e.jsx(y,{value:"type",children:"Type"}),e.jsx(y,{value:"priority",children:"Priority"}),e.jsx(y,{value:"strategic",children:"Strategic/Tactical"})]})]})})]}),u&&e.jsxs(m,{variant:"ghost",size:"sm",onClick:N,className:"text-sm text-blue-600",children:[e.jsx(M,{className:"h-3.5 w-3.5 mr-1"})," Clear all filters"]})]})]})}const je=h.lazy(()=>ee(()=>se(()=>import("./TaskCreationForm-uUOFczhl.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13])),3,1e3));function _e(){const[f,x]=h.useState([]),[v,s]=h.useState(!0),[N,u]=h.useState(!1),[r,j]=h.useState(null),[w,g]=h.useState(null),[l,t]=h.useState({status:[],priority:[],type:[],search:"",tags:[],strategic:null,groupBy:"none"}),[o,C]=h.useState([]);h.useEffect(()=>{p()},[]);const p=async()=>{s(!0),g(null);try{const a=await k.list("-created_date");x(a||[]);const n=new Set;(a||[]).forEach(i=>{Array.isArray(i.tags)&&i.tags.forEach(d=>n.add(d))}),C(Array.from(n))}catch(a){console.error("Failed to load tasks:",a),g("Failed to load tasks. Please try again.")}finally{s(!1)}},F=async a=>{if(!a){u(!1),j(null);return}try{r?await k.update(r.id,a):await k.create(a),await p(),u(!1),j(null)}catch(n){console.error("Failed to save task:",n),g("Failed to save task. Please try again.")}},_=async a=>{try{await k.delete(a.id),await p()}catch(n){console.error("Failed to delete task:",n),g("Failed to delete task. Please try again.")}},J=a=>{j(a),u(!0)},P=async(a,n)=>{try{await k.update(a.id,{...a,status:n}),await p()}catch(i){console.error("Failed to update task status:",i),g("Failed to update task status. Please try again.")}},B=(a=>{const n=Array.isArray(a)?a:[],i={...l,status:Array.isArray(l.status)?l.status:[],priority:Array.isArray(l.priority)?l.priority:[],type:Array.isArray(l.type)?l.type:[],tags:Array.isArray(l.tags)?l.tags:[]};return n.filter(d=>{if(i.status.length>0&&!i.status.includes(d.status)||i.type.length>0&&!i.type.includes(d.type)||i.priority.length>0&&!i.priority.includes(d.priority))return!1;if(i.tags.length>0){const T=Array.isArray(d.tags)?d.tags:[];if(!i.tags.some(E=>T.includes(E)))return!1}if(i.strategic!==null&&d.strategic!==i.strategic)return!1;if(i.search){const T=i.search.toLowerCase(),E=(d.title||"").toLowerCase().includes(T),O=(d.description||"").toLowerCase().includes(T);if(!E&&!O)return!1}return!0})})(f),K=B.filter(a=>a?.status!=="done"),D=B.filter(a=>a?.status==="done");return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Tasks"}),!N&&e.jsxs(m,{onClick:()=>u(!0),className:"mt-4 sm:mt-0",children:[e.jsx(le,{className:"mr-2 h-4 w-4"}),"New Task"]})]}),w&&e.jsxs(U,{variant:"destructive",className:"mb-6",children:[e.jsx(W,{children:"Error"}),e.jsx(X,{children:w})]}),e.jsx(ne,{mode:"wait",children:N?e.jsx(z.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"mb-8",children:e.jsx(Y,{componentName:"Task Creation Form",children:e.jsx(h.Suspense,{fallback:e.jsx(Z,{}),children:e.jsx(je,{onCreateTask:F,initialTaskData:r})})})}):e.jsxs(z.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[e.jsx(ye,{filters:l,setFilters:t,availableTags:o}),v?e.jsxs("div",{className:"text-center p-12",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-indigo-600 border-t-transparent rounded-full mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading tasks..."})]}):e.jsx(e.Fragment,{children:B.length===0?e.jsxs("div",{className:"text-center p-12 border border-dashed rounded-lg",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No tasks found"}),e.jsx("p",{className:"text-gray-500",children:f.length===0?"Create your first task to get started":"Try adjusting your filters to see more tasks"}),f.length>0&&e.jsx(m,{variant:"outline",className:"mt-4",onClick:()=>t({status:[],priority:[],type:[],search:"",tags:[],strategic:null,groupBy:"none"}),children:"Clear all filters"})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{children:e.jsx(he,{tasks:K,onEditTask:J,onDeleteTask:_,onStatusChange:P,groupBy:l.groupBy==="none"?null:l.groupBy})}),D.length>0&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2 text-gray-600",children:[e.jsx(ce,{className:"h-5 w-5"}),"Completed Tasks (",D.length,")"]}),e.jsx("div",{className:"bg-white rounded-lg border shadow-sm overflow-hidden",children:e.jsxs(xe,{children:[e.jsx(ue,{children:e.jsxs(q,{children:[e.jsx(b,{children:"Task"}),e.jsx(b,{children:"Type"}),e.jsx(b,{children:"Completed Date"}),e.jsx(b,{className:"w-[100px]",children:"Actions"})]})}),e.jsx(ge,{children:D.map(a=>e.jsxs(q,{children:[e.jsxs(A,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:a.title}),a.project&&e.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["in ",a.project]})]}),a.tags?.length>0&&e.jsx("div",{className:"flex gap-1 mt-1",children:a.tags.map(n=>e.jsx(S,{variant:"secondary",className:"text-xs",children:n},n))})]}),e.jsx(A,{children:e.jsx(S,{variant:"outline",children:a.type})}),e.jsx(A,{children:pe(new Date(a.updated_date),"MMM d, yyyy")}),e.jsx(A,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>P(a,"todo"),title:"Mark as Todo",children:e.jsx(oe,{className:"h-4 w-4"})}),e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>_(a),className:"text-red-500",title:"Delete",children:e.jsx(de,{className:"h-4 w-4"})})]})})]},a.id))})]})})]})]})})]})})]})})}export{_e as default};
