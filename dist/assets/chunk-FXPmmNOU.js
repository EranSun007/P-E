const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TaskCreationForm-NRsPR7xV.js","assets/chunk-8WlaufA8.js","assets/chunk-pjYta8vt.js","assets/chunk-KzYfAQy1.js","assets/index-BK5E59O8.js","assets/chunk-BQPSriyy.js","assets/index-CO3VviEi.css","assets/chunk-DSRmHbBO.js","assets/chunk-DktN3Kjy.js","assets/chunk-N38jzkpe.js","assets/chunk-Cg2ZZDgQ.js","assets/chunk-BdHZTqfh.js","assets/chunk-UjCvYLMJ.js","assets/MeetingDetailView-DYbFoxDx.js","assets/chunk-CkTSnDel.js","assets/chunk-Bw8oe1_L.js","assets/chunk-cjCmUzJ1.js","assets/chunk-kzSEtJwL.js","assets/chunk-DTiRvVQj.js","assets/chunk-CJViCmxo.js","assets/calendarSynchronizationService-A8-_sGLl.js","assets/calendarService-BLiLHtBa.js","assets/WeeklyMeetingSidebar-BS5JlWOt.js"])))=>i.map(i=>d[i]);
import{c as T,B as M,u as Pt,T as Xe,d as Je,e as Wt,O as Ut,D as zt,_ as xe,C as Oe,f as Ze,F as Bt,r as $e}from"./index-BK5E59O8.js";import{a1 as Yt,a2 as Ht,a3 as Gt,j as e,a4 as Kt,a5 as dt,d as ue,a6 as be,a7 as Pe,a8 as We,a9 as Ue,aa as ut,Y as Fe,Q as qt,i as Qt,X as pe,M as et,ab as Xt,ac as Jt,p as tt,o as st,ad as Zt,ae as es}from"./chunk-8WlaufA8.js";import{a as m,j as ts}from"./chunk-pjYta8vt.js";import{B as F,D as De,a as Ie,b as at,c as rt}from"./chunk-Cg2ZZDgQ.js";import{E as ss}from"./chunk-kzSEtJwL.js";import{C as as}from"./chunk-DTiRvVQj.js";import{A as ke}from"./chunk-cjCmUzJ1.js";import{A as nt}from"./chunk-Bw8oe1_L.js";import{CalendarSynchronizationService as se}from"./calendarSynchronizationService-A8-_sGLl.js";import{E as ae}from"./chunk-CJViCmxo.js";import{s as Te,e as it,p as E,f as L,b as ot,d as lt,g as ct,i as W,h as Me,j as Ae,k as rs,l as ns,m as is,n as Ve}from"./chunk-BQPSriyy.js";const os=Yt,ls=Ht,cs=Gt,mt=m.forwardRef(({className:S,sideOffset:t=4,...s},i)=>e.jsx(Kt,{children:e.jsx(dt,{ref:i,sideOffset:t,className:T("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",S),...s})}));mt.displayName=dt.displayName;class d{static VIEW_MODES={MEETINGS:"meetings",OUT_OF_OFFICE:"out_of_office",DUTIES:"duties",BIRTHDAYS:"birthdays",ALL_EVENTS:"all_events"};static STORAGE_KEY="calendar_view_mode_preference";static DEFAULT_VIEW_MODE=d.VIEW_MODES.ALL_EVENTS;#e=d.DEFAULT_VIEW_MODE;#t=[];constructor(){this.#e=this.loadViewPreference()}getCurrentViewMode(){return this.#e}setViewMode(t){if(!this.isValidViewMode(t))throw new Error(`Invalid view mode: ${t}. Valid modes are: ${Object.values(d.VIEW_MODES).join(", ")}`);const s=this.#e;this.#e=t,this.saveViewPreference(t),this.#l(t,s)}isValidViewMode(t){return Object.values(d.VIEW_MODES).includes(t)}filterEventsForCurrentView(t){return this.filterEventsForView(t,this.#e)}filterEventsForView(t,s){if(!this.isValidViewMode(s))throw new Error(`Invalid view mode: ${s}`);if(!Array.isArray(t))return console.warn("ViewModeManager: events parameter is not an array, returning empty array"),[];switch(s){case d.VIEW_MODES.MEETINGS:return this.#s(t);case d.VIEW_MODES.OUT_OF_OFFICE:return this.#a(t);case d.VIEW_MODES.DUTIES:return this.#r(t);case d.VIEW_MODES.BIRTHDAYS:return this.#n(t);case d.VIEW_MODES.ALL_EVENTS:return this.#i(t);default:return console.warn(`ViewModeManager: Unknown view mode ${s}, returning all events`),t}}getEventCounts(t){return Array.isArray(t)?{[d.VIEW_MODES.MEETINGS]:this.#s(t).length,[d.VIEW_MODES.OUT_OF_OFFICE]:this.#a(t).length,[d.VIEW_MODES.DUTIES]:this.#r(t).length,[d.VIEW_MODES.BIRTHDAYS]:this.#n(t).length,[d.VIEW_MODES.ALL_EVENTS]:this.#i(t).length}:this.#o()}saveViewPreference(t){try{localStorage.setItem(d.STORAGE_KEY,t)}catch(s){console.warn("ViewModeManager: Failed to save view preference to localStorage:",s)}}loadViewPreference(){try{const t=localStorage.getItem(d.STORAGE_KEY);if(t&&this.isValidViewMode(t))return t}catch(t){console.warn("ViewModeManager: Failed to load view preference from localStorage:",t)}return d.DEFAULT_VIEW_MODE}clearViewPreference(){try{localStorage.removeItem(d.STORAGE_KEY),this.#e=d.DEFAULT_VIEW_MODE}catch(t){console.warn("ViewModeManager: Failed to clear view preference from localStorage:",t)}}addViewModeChangeListener(t){if(typeof t!="function")throw new Error("Listener must be a function");return this.#t.push(t),()=>{const s=this.#t.indexOf(t);s>-1&&this.#t.splice(s,1)}}getAvailableViewModes(){return[{id:d.VIEW_MODES.MEETINGS,label:"Meetings",description:"View all scheduled meetings and one-on-ones",icon:"calendar"},{id:d.VIEW_MODES.OUT_OF_OFFICE,label:"Out of Office",description:"View team member out-of-office periods",icon:"user-x"},{id:d.VIEW_MODES.DUTIES,label:"Duties",description:"View team member duty assignments",icon:"shield"},{id:d.VIEW_MODES.BIRTHDAYS,label:"Birthdays",description:"View team member birthdays",icon:"cake"},{id:d.VIEW_MODES.ALL_EVENTS,label:"All Events",description:"View all calendar events combined",icon:"calendar-days"}]}#s(t){return t.filter(s=>s.event_type==="meeting"||s.event_type==="one_on_one")}#a(t){return t.filter(s=>s.event_type==="out_of_office")}#r(t){return t.filter(s=>s.event_type==="duty")}#n(t){return t.filter(s=>s.event_type==="birthday")}#i(t){return t}#o(){return{[d.VIEW_MODES.MEETINGS]:0,[d.VIEW_MODES.OUT_OF_OFFICE]:0,[d.VIEW_MODES.DUTIES]:0,[d.VIEW_MODES.BIRTHDAYS]:0,[d.VIEW_MODES.ALL_EVENTS]:0}}#l(t,s){this.#t.forEach(i=>{try{i(t,s)}catch(l){console.error("ViewModeManager: Error in view mode change listener:",l)}})}}const J=new d;function ds({currentViewMode:S,onViewModeChange:t,eventCounts:s={},className:i="",disabled:l=!1}){const[o,n]=m.useState(-1),v=m.useRef([]),j=p=>{switch(p){case d.VIEW_MODES.MEETINGS:return ue;case d.VIEW_MODES.OUT_OF_OFFICE:return Ue;case d.VIEW_MODES.DUTIES:return We;case d.VIEW_MODES.BIRTHDAYS:return Pe;case d.VIEW_MODES.ALL_EVENTS:return be;default:return ue}},D=d.prototype.getAvailableViewModes(),_=(p,A)=>{switch(p.key){case"ArrowLeft":p.preventDefault();const N=A>0?A-1:D.length-1;n(N),v.current[N]?.focus();break;case"ArrowRight":p.preventDefault();const V=A<D.length-1?A+1:0;n(V),v.current[V]?.focus();break;case"Enter":case" ":p.preventDefault(),l||t(D[A].id);break;case"Home":p.preventDefault(),n(0),v.current[0]?.focus();break;case"End":p.preventDefault();const z=D.length-1;n(z),v.current[z]?.focus();break}},K=p=>{l||t(p)};return m.useEffect(()=>{n(-1)},[S]),e.jsx("div",{className:T("flex items-center space-x-1 bg-gray-100 rounded-lg p-1",l&&"opacity-50 cursor-not-allowed",i),role:"tablist","aria-label":"Calendar view modes",children:D.map((p,A)=>{const N=j(p.id),V=S===p.id,z=s[p.id]||0;return e.jsxs(M,{ref:re=>v.current[A]=re,variant:V?"default":"ghost",size:"sm",className:T("relative flex items-center space-x-2 px-3 py-2 text-sm font-medium transition-all duration-200","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1",V&&"bg-white shadow-sm text-blue-600",!V&&"text-gray-600 hover:text-gray-900 hover:bg-gray-50",l&&"cursor-not-allowed opacity-50"),onClick:()=>K(p.id),onKeyDown:re=>_(re,A),disabled:l,role:"tab","aria-selected":V,"aria-controls":`calendar-panel-${p.id}`,tabIndex:o===A?0:-1,title:p.description,children:[e.jsx(N,{className:"h-4 w-4","aria-hidden":"true"}),e.jsx("span",{children:p.label}),z>0&&e.jsx(F,{variant:V?"secondary":"outline",className:T("ml-1 text-xs min-w-[1.25rem] h-5 flex items-center justify-center",V&&"bg-blue-100 text-blue-700 border-blue-200",!V&&"bg-gray-200 text-gray-600 border-gray-300"),"aria-label":`${z} ${p.label.toLowerCase()}`,children:z>99?"99+":z})]},p.id)})})}const ht=({viewMode:S,onCreateTask:t=null,onAddTeamMember:s=null,onManageDuties:i=null,className:l="",size:o="md",context:n="calendar"})=>{const j=(()=>{switch(S){case d.VIEW_MODES.MEETINGS:return{icon:ue,title:n==="sidebar"?"No meetings today":"No meetings scheduled",description:n==="sidebar"?"No meetings are scheduled for this date.":"You don't have any meetings or one-on-ones scheduled. Create a task to schedule your first meeting.",actionLabel:"Create Meeting Task",onAction:t,suggestions:["Schedule a one-on-one with a team member","Plan your next team meeting","Block time for important discussions"]};case d.VIEW_MODES.OUT_OF_OFFICE:return{icon:Ue,title:n==="sidebar"?"No one is out today":"No out-of-office periods",description:n==="sidebar"?"No team members are out of office on this date.":"No team members have scheduled out-of-office periods. Manage team availability to track time off.",actionLabel:"Manage Team",onAction:s,suggestions:["Add team members to track their availability","Schedule upcoming vacation time","Plan around team member absences"]};case d.VIEW_MODES.DUTIES:return{icon:We,title:n==="sidebar"?"No duties assigned today":"No duty assignments",description:n==="sidebar"?"No duty assignments are scheduled for this date.":"No team member duties are currently assigned. Set up duty rotations to track responsibilities.",actionLabel:"Manage Duties",onAction:i,suggestions:["Set up DevOps duty rotations","Assign on-call responsibilities","Track team member duties"]};case d.VIEW_MODES.BIRTHDAYS:return{icon:Pe,title:n==="sidebar"?"No birthdays today":"No birthdays this month",description:n==="sidebar"?"No team member birthdays are on this date.":"No team member birthdays are scheduled. Add team members with birthday information to celebrate together.",actionLabel:"Add Team Members",onAction:s,suggestions:["Add team member birthday information","Plan birthday celebrations","Never miss a team member's special day"]};case d.VIEW_MODES.ALL_EVENTS:default:return{icon:be,title:n==="sidebar"?"Nothing scheduled today":"Your calendar is empty",description:n==="sidebar"?"No tasks or events are scheduled for this date.":"You don't have any events, meetings, or tasks scheduled. Start organizing your work and team activities.",actionLabel:"Create Task",onAction:t,suggestions:["Schedule your first meeting","Add team member information","Create tasks to stay organized"]}}})();return n==="sidebar"?e.jsxs("div",{className:T("text-center p-6",l),children:[e.jsx(j.icon,{className:"h-8 w-8 text-gray-400 mx-auto mb-3"}),e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:j.title}),e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:j.description}),j.onAction&&e.jsxs(M,{onClick:j.onAction,variant:"outline",size:"sm",className:"text-xs",children:[e.jsx(Fe,{className:"h-3 w-3 mr-1"}),j.actionLabel]})]}):e.jsxs("div",{className:T("space-y-6",l),children:[e.jsx(ss,{icon:j.icon,title:j.title,description:j.description,actionLabel:j.actionLabel,onAction:j.onAction,size:o}),j.suggestions&&j.suggestions.length>0&&e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3 text-center",children:"Quick suggestions:"}),e.jsx("ul",{className:"space-y-2",children:j.suggestions.map((D,_)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm text-gray-600",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full mt-2 flex-shrink-0"}),e.jsx("span",{children:D})]},_))})]})]})},us=({viewMode:S,onCreateTask:t,onAddTeamMember:s,onManageDuties:i,className:l=""})=>e.jsx("div",{className:T("flex items-center justify-center min-h-[400px] bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",l),children:e.jsx(ht,{viewMode:S,onCreateTask:t,onAddTeamMember:s,onManageDuties:i,context:"calendar",size:"lg"})}),ms=({viewMode:S,onCreateTask:t,className:s=""})=>e.jsx(ht,{viewMode:S,onCreateTask:t,context:"sidebar",className:s}),hs=({className:S=""})=>e.jsx("div",{className:T("flex items-center justify-center min-h-[400px] bg-gray-50 rounded-lg border-2 border-dashed border-gray-200",S),children:e.jsxs("div",{className:"text-center",children:[e.jsx(ut,{className:"h-12 w-12 text-gray-400 mx-auto mb-4 animate-pulse"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Loading calendar..."}),e.jsx("p",{className:"text-gray-500",children:"Please wait while we load your events and tasks."})]})});class Re{static async getAgendaCountsForTeamMember(t){try{if(!t)return{count:0,unresolvedCount:0,hasUnresolved:!1};const s=await nt.getByTeamMember(t);if(!Array.isArray(s))return{count:0,unresolvedCount:0,hasUnresolved:!1};const i=s.length,o=s.filter(n=>n.status==="pending"||n.status==="in_progress").length;return{count:i,unresolvedCount:o,hasUnresolved:o>0,items:s}}catch(s){return console.error("Error getting agenda counts for team member:",s),{count:0,unresolvedCount:0,hasUnresolved:!1}}}static async getAgendaCountsForTeamMembers(t){try{if(!Array.isArray(t)||t.length===0)return{};const s={},i=t.map(async o=>{const n=await this.getAgendaCountsForTeamMember(o);return{teamMemberId:o,count:n}});return(await Promise.all(i)).forEach(({teamMemberId:o,count:n})=>{s[o]=n}),s}catch(s){return console.error("Error getting agenda counts for team members:",s),{}}}static async getAgendaCountsForCalendarEvents(t){try{if(!Array.isArray(t))return{};const s=t.filter(n=>n.event_type==="one_on_one"&&n.team_member_id);if(s.length===0)return{};const i=[...new Set(s.map(n=>n.team_member_id))],l=await this.getAgendaCountsForTeamMembers(i),o={};return s.forEach(n=>{const v=l[n.team_member_id];v&&(o[n.id]={...v,teamMemberId:n.team_member_id})}),o}catch(s){return console.error("Error getting agenda counts for calendar events:",s),{}}}static async hasAgendaItems(t){try{return!t||t.event_type!=="one_on_one"||!t.team_member_id?!1:(await this.getAgendaCountsForTeamMember(t.team_member_id)).count>0}catch(s){return console.error("Error checking if event has agenda items:",s),!1}}static async getAgendaItemsForNextMeeting(t){try{if(!t)return[];const s=await nt.getForNextMeeting(t);return Array.isArray(s)?s:[]}catch(s){return console.error("Error getting agenda items for next meeting:",s),[]}}}function gs({count:S=0,unresolvedCount:t=0,hasUnresolved:s=!1,size:i="xs",className:l=""}){if(S===0)return null;const o={xs:"text-xs px-1.5 py-0.5 h-5",sm:"text-xs px-2 py-0.5 h-6"},n={xs:"h-2.5 w-2.5",sm:"h-3 w-3"},v=T("inline-flex items-center gap-1 font-medium rounded-full border",o[i],s?"bg-orange-100 text-orange-800 border-orange-300":"bg-green-100 text-green-800 border-green-300",l),j=s?ut:qt,D=s?t:S;return e.jsxs(F,{className:v,variant:"outline",children:[e.jsx(j,{className:n[i]}),e.jsx("span",{children:D})]})}function fs({count:S=0,hasUnresolved:t=!1,className:s=""}){if(S===0)return null;const i=T("inline-flex items-center justify-center min-w-[18px] h-[18px] text-xs font-bold rounded-full border",t?"bg-orange-500 text-white border-orange-600":"bg-green-500 text-white border-green-600",s);return e.jsx("div",{className:i,children:S>99?"99+":S})}const Le=768;function ys(){const[S,t]=m.useState(void 0);return m.useEffect(()=>{const s=window.matchMedia(`(max-width: ${Le-1}px)`),i=()=>{t(window.innerWidth<Le)};return s.addEventListener("change",i),t(window.innerWidth<Le),()=>s.removeEventListener("change",i)},[]),!!S}class g{static EVENT_COLORS={one_on_one:{primary:"#f97316",background:"#fed7aa",light:"#fef3c7",border:"#fb923c",text:"#ea580c",hover:"#fdba74"},meeting:{primary:"#3b82f6",background:"#bfdbfe",light:"#dbeafe",border:"#60a5fa",text:"#2563eb",hover:"#93c5fd"},birthday:{primary:"#ec4899",background:"#f9a8d4",light:"#fce7f3",border:"#f472b6",text:"#db2777",hover:"#f8bbd9"},duty:{primary:"#8b5cf6",background:"#c4b5fd",light:"#ede9fe",border:"#a78bfa",text:"#7c3aed",hover:"#ddd6fe"},out_of_office:{primary:"#f97316",background:"#fed7aa",light:"#fef3c7",border:"#fb923c",text:"#ea580c",hover:"#fdba74"},default:{primary:"#6366f1",background:"#c7d2fe",light:"#e0e7ff",border:"#818cf8",text:"#4f46e5",hover:"#a5b4fc"}};static EVENT_ICONS={one_on_one:Qt,meeting:ue,birthday:Pe,duty:We,out_of_office:Ue,default:be};static EVENT_LABELS={one_on_one:"1:1",meeting:"Meeting",birthday:"Birthday",duty:"Duty",out_of_office:"OOO",default:"Event"};static VARIANTS={DEFAULT:"default",COMPACT:"compact",SIDEBAR:"sidebar"};static getEventStyling(t,s=g.VARIANTS.DEFAULT){if(!t)throw new Error("Event object is required");const i=t.event_type||"default",l=g.EVENT_COLORS[i]||g.EVENT_COLORS.default,o=g.EVENT_ICONS[i]||g.EVENT_ICONS.default,n=g.EVENT_LABELS[i]||g.EVENT_LABELS.default;return{colors:{primary:l.primary,background:l.background,light:l.light,border:l.border,text:l.text,hover:l.hover},icon:o,label:n,className:g.generateEventClassName(i,s),style:{color:l.text,backgroundColor:l.light,borderColor:l.border},badgeStyle:{borderColor:l.primary+"50",color:l.primary},hoverStyle:{backgroundColor:l.hover}}}static generateEventClassName(t,s=g.VARIANTS.DEFAULT){const i="transition-all duration-200 cursor-pointer",l="border-l-2";let o="";switch(s){case g.VARIANTS.COMPACT:o="text-xs p-1 rounded truncate";break;case g.VARIANTS.SIDEBAR:o="text-sm p-2 rounded-md truncate";break;case g.VARIANTS.DEFAULT:default:o="text-xs p-1 rounded truncate";break}let n="";switch(t){case"one_on_one":n="bg-orange-100 text-orange-800 border-orange-400 hover:bg-orange-200 hover:shadow-sm";break;case"meeting":n="bg-blue-100 text-blue-800 border-blue-400 hover:bg-blue-200 hover:shadow-sm";break;case"birthday":n="bg-pink-100 text-pink-800 border-pink-400 hover:bg-pink-200 hover:shadow-sm";break;case"duty":n="bg-purple-100 text-purple-800 border-purple-400 hover:bg-purple-200 hover:shadow-sm";break;case"out_of_office":n="bg-orange-100 text-orange-800 border-orange-400 hover:bg-orange-200 hover:shadow-sm";break;default:n="bg-indigo-100 text-indigo-800 border-indigo-400 hover:bg-indigo-200 hover:shadow-sm";break}return`${i} ${o} ${l} ${n}`.trim()}static getEventTypeColors(){return{...g.EVENT_COLORS}}static getEventTypeIcons(){return{...g.EVENT_ICONS}}static getEventTypeLabels(){return{...g.EVENT_LABELS}}static getEventCardStyling(t){if(!t)throw new Error("Event object is required");const s=t.event_type||"default",i=g.EVENT_COLORS[s]||g.EVENT_COLORS.default,l="p-3 border rounded-md cursor-pointer transition-colors";let o="";switch(s){case"birthday":o="border-pink-200 bg-pink-50 hover:bg-pink-100";break;case"one_on_one":o="border-orange-200 bg-orange-50 hover:bg-orange-100";break;case"meeting":o="border-blue-200 bg-blue-50 hover:bg-blue-100";break;case"out_of_office":o="border-orange-200 bg-orange-50 hover:bg-orange-100";break;case"duty":o="border-purple-200 bg-purple-50 hover:bg-purple-100";break;default:o="border-indigo-200 bg-indigo-50 hover:bg-indigo-100";break}return{className:`${l} ${o}`,colors:i,icon:g.EVENT_ICONS[s]||g.EVENT_ICONS.default}}static getMultiDayEventStyling(t,s,i=g.VARIANTS.DEFAULT){const l=g.getEventStyling(t,i);let o="",n="";switch(s){case"start":o="rounded-r-none border-r-0",n="▶ ";break;case"middle":o="rounded-none border-r-0 border-l-0",n="─ ";break;case"end":o="rounded-l-none border-l-0",n="◀ ";break}return{...l,className:`${l.className} ${o}`.trim(),titlePrefix:n,isMultiDay:s!=="single",position:s}}static isValidEventType(t){return!t||typeof t!="string"||t.trim()===""?!1:Object.keys(g.EVENT_COLORS).includes(t)||t==="default"}static isValidVariant(t){return Object.values(g.VARIANTS).includes(t)}static getAccessibilityInfo(t){const s=g.EVENT_COLORS[t]||g.EVENT_COLORS.default;return{hasGoodContrast:!0,backgroundColor:s.light,textColor:s.text,borderColor:s.border,ariaLabel:`${g.EVENT_LABELS[t]||"Event"} calendar event`}}}class de{static syncStatus={isRunning:!1,lastSync:null,lastError:null,syncResults:null,periodicSyncInterval:null};static listeners=new Set;static addStatusListener(t){this.listeners.add(t)}static removeStatusListener(t){this.listeners.delete(t)}static notifyListeners(t){this.listeners.forEach(s=>{try{s(t)}catch(i){console.warn("Error in sync status listener:",i)}})}static getSyncStatus(){return{...this.syncStatus}}static updateStatus(t){this.syncStatus={...this.syncStatus,...t},this.notifyListeners(this.getSyncStatus())}static startPeriodicSync(t=5*60*1e3){this.stopPeriodicSync(),console.log(`Starting periodic calendar sync with ${t}ms interval`),this.syncStatus.periodicSyncInterval=setInterval(async()=>{try{await this.performBackgroundSync()}catch(s){console.warn("Periodic sync failed:",s),this.updateStatus({lastError:s.message,lastSync:new Date().toISOString()})}},t),this.performBackgroundSync().catch(s=>{console.warn("Initial periodic sync failed:",s)})}static stopPeriodicSync(){this.syncStatus.periodicSyncInterval&&(clearInterval(this.syncStatus.periodicSyncInterval),this.syncStatus.periodicSyncInterval=null,console.log("Stopped periodic calendar sync"))}static async performBackgroundSync(){if(this.syncStatus.isRunning)return console.log("Sync already running, skipping background sync"),this.syncStatus.syncResults;try{this.updateStatus({isRunning:!0,lastError:null});const[t,s]=await Promise.all([se.syncOneOnOneMeetings({createMissing:!0,updateExisting:!1}),se.ensureOneOnOneVisibility({createMissing:!0})]),i={timestamp:new Date().toISOString(),sync:t,visibility:s,summary:{success:t.summary.success&&s.summary.success,totalOperations:t.summary.createdCount+s.summary.createdCount,errors:[...t.errors||[],...s.errors||[]]}};return this.updateStatus({isRunning:!1,lastSync:new Date().toISOString(),syncResults:i,lastError:null}),i.summary.totalOperations>0&&console.log("Background sync completed with changes:",{syncCreated:t.summary.createdCount,visibilityCreated:s.summary.createdCount,errors:i.summary.errors.length}),i}catch(t){throw console.error("Background sync failed:",t),this.updateStatus({isRunning:!1,lastSync:new Date().toISOString(),lastError:t.message}),t}}static async manualSync(t={}){const{createMissing:s=!0,updateExisting:i=!0,repairBroken:l=!0,showProgress:o=!0}=t;if(this.syncStatus.isRunning)throw new Error("Sync is already running. Please wait for it to complete.");try{this.updateStatus({isRunning:!0,lastError:null}),o&&console.log("Starting manual calendar synchronization...");const n=await se.validateEventConsistency();o&&console.log("Validation completed:",{totalIssues:n.summary.totalIssues,isConsistent:n.summary.isConsistent});let v=null;!n.summary.isConsistent&&l&&(v=await se.repairMissingEvents({repairOrphaned:!0,repairMissing:!0,repairBroken:!0,removeDuplicates:!0}),o&&console.log("Repair completed:",{totalRepairs:v.summary.totalRepairs}));const j=await se.syncOneOnOneMeetings({createMissing:s,updateExisting:i}),D=await se.ensureOneOnOneVisibility({createMissing:s}),_={timestamp:new Date().toISOString(),validation:n,repair:v,sync:j,visibility:D,summary:{success:j.summary.success&&D.summary.success,totalChanges:(v?.summary.totalRepairs||0)+j.summary.createdCount+j.summary.updatedCount+D.summary.createdCount,userMessage:this.generateUserMessage(n,v,j,D)}};return this.updateStatus({isRunning:!1,lastSync:new Date().toISOString(),syncResults:_,lastError:null}),o&&console.log("Manual sync completed:",_.summary.userMessage),_}catch(n){throw console.error("Manual sync failed:",n),this.updateStatus({isRunning:!1,lastSync:new Date().toISOString(),lastError:n.message}),n}}static generateUserMessage(t,s,i,l){const o=[];if(t.summary.isConsistent&&i.summary.createdCount===0&&l.summary.createdCount===0)return"Calendar is already synchronized. No changes needed.";s&&s.summary.totalRepairs>0&&o.push(`Fixed ${s.summary.totalRepairs} data consistency issue(s)`),i.summary.createdCount>0&&o.push(`Created ${i.summary.createdCount} missing calendar event(s)`),i.summary.updatedCount>0&&o.push(`Updated ${i.summary.updatedCount} calendar event(s)`),l.summary.createdCount>0&&o.push(`Ensured visibility for ${l.summary.createdCount} meeting(s)`);const n=(i.errors?.length||0)+(l.errors?.length||0);return n>0&&o.push(`${n} error(s) occurred during sync`),o.length>0?`Synchronization completed: ${o.join(", ")}.`:"Synchronization completed successfully."}static getSyncStatistics(){const t=this.getSyncStatus();return{isRunning:t.isRunning,lastSync:t.lastSync,lastError:t.lastError,hasPeriodicSync:t.periodicSyncInterval!==null,lastSyncResults:t.syncResults?{success:t.syncResults.summary?.success||!1,totalChanges:t.syncResults.summary?.totalOperations||0,message:t.syncResults.summary?.userMessage||"No details available"}:null}}static initialize(){this.startPeriodicSync(),typeof window<"u"&&window.addEventListener("beforeunload",()=>{this.stopPeriodicSync()})}static cleanup(){this.stopPeriodicSync(),this.listeners.clear()}}const ps=m.lazy(()=>$e(()=>xe(()=>import("./TaskCreationForm-NRsPR7xV.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12])),3,1e3)),xs=m.lazy(()=>$e(()=>xe(()=>import("./MeetingDetailView-DYbFoxDx.js"),__vite__mapDeps([13,1,2,4,5,6,10,14,15,16,7,8,17,18,19,20,21])),3,1e3)),bs=m.lazy(()=>$e(()=>xe(()=>import("./WeeklyMeetingSidebar-BS5JlWOt.js"),__vite__mapDeps([22,1,2,10,5,4,6,19,17,18,16,7,15,8,20,21])),3,1e3));function Es(){const[S,t]=m.useState([]),[s,i]=m.useState([]),[l,o]=m.useState([]),[n,v]=m.useState([]),[j,D]=m.useState([]),[_,K]=m.useState(new Date),[p,A]=m.useState(new Date),[N,V]=m.useState(null),[z,re]=m.useState(null),[gt,Z]=m.useState(!1),[B,ft]=m.useState(J.getCurrentViewMode()),[R,Ee]=m.useState(!0),[me,ne]=m.useState({}),[ze,he]=m.useState(!1),[Se,ge]=m.useState(null),[fe,yt]=m.useState(new Date),[pt,xt]=m.useState([]),[q,ie]=m.useState(!0),$=ys(),[C,bt]=m.useState({events:[],tasks:[],teamMembers:[],outOfOffice:[],duties:[],lastUpdated:null,loadedDateRanges:new Set}),[we,Be]=m.useState(null),[I,Ye]=m.useState(de.getSyncStatus()),[Et,Ne]=m.useState(!1),je=ts(),{toast:St}=Pt(),wt=async()=>ae.wrapOperation(async()=>{Ne(!0);const a=await de.manualSync({createMissing:!0,updateExisting:!0,repairBroken:!0,showProgress:!0});return a.summary.success&&a.summary.totalChanges>0&&await ee(!0),a},{operationName:"Manual Calendar Sync",showLoading:!0,showSuccess:!0,successMessage:"Calendar synchronized successfully",retryOptions:{maxRetries:2,baseDelay:2e3,onRetry:(a,c,f)=>{console.log(`Retrying sync operation (attempt ${c}) in ${f}ms...`),St({title:"Retrying Sync",description:`Attempting to sync again (attempt ${c})...`,duration:2e3})}},errorOptions:{severity:ae.SEVERITY.HIGH,context:{source:"manual_sync_button"}}}).catch(a=>{throw Ne(!0),a});m.useEffect(()=>(ee(),de.initialize(),de.addStatusListener(Ye),()=>{de.removeStatusListener(Ye)}),[]),m.useEffect(()=>{const a=_.getFullYear(),c=`${a}`;!C.loadedDateRanges.has(c)&&!C.loadedDateRanges.has(`${a-1}`)&&!C.loadedDateRanges.has(`${a+1}`)&&ee(!1,_),yt(_)},[_]),m.useEffect(()=>{It()},[s,fe,B]),m.useEffect(()=>{ie(!$)},[$]);const ee=async(a=!1,c=null)=>ae.wrapOperation(async()=>{Ee(!0),Be(null);const h=Date.now(),r=5*60*1e3,y=c||_;if(!a&&C.lastUpdated&&h-C.lastUpdated<r&&C.events.length>0){t(C.tasks),i(C.events),o(C.teamMembers),v(C.outOfOffice),D(C.duties);const w=await Re.getAgendaCountsForCalendarEvents(C.events);ne(w),Ee(!1);return}const x=[Xe.list().catch(w=>(console.warn("Failed to load tasks:",w),C.tasks||[])),Je.list().catch(w=>(console.warn("Failed to load calendar events:",w),C.events||[])),Wt.list().catch(w=>(console.warn("Failed to load team members:",w),C.teamMembers||[])),Ut.list().catch(w=>(console.warn("Failed to load out of office records:",w),C.outOfOffice||[])),zt.list().catch(w=>(console.warn("Failed to load duties:",w),C.duties||[]))],[u,Y,te,P,O]=await Promise.all(x);t(u),o(te),v(P),D(O);const k=y.getFullYear(),Q=[k-1,k,k+1];try{for(const w of Q)await as.synchronizeAllEvents({includeBirthdays:!0,includeDuties:!0,includeOutOfOffice:!0,year:w})}catch(w){console.warn("Failed to synchronize some calendar events:",w)}try{const{CalendarSynchronizationService:w}=await xe(async()=>{const{CalendarSynchronizationService:ve}=await import("./calendarSynchronizationService-A8-_sGLl.js");return{CalendarSynchronizationService:ve}},__vite__mapDeps([20,4,1,2,5,6,21,19]));await w.ensureOneOnOneVisibility({createMissing:!0})}catch(w){console.warn("Failed to synchronize OneOnOne meetings:",w)}let X;try{X=await Je.list()}catch(w){console.warn("Failed to reload calendar events after sync:",w),X=Y}i(X);try{const w=await Re.getAgendaCountsForCalendarEvents(X);ne(w)}catch(w){console.warn("Failed to load agenda counts:",w),ne({})}bt({events:X,tasks:u,teamMembers:te,outOfOffice:P,duties:O,lastUpdated:h,loadedDateRanges:new Set([`${k-1}`,`${k}`,`${k+1}`])})},{operationName:"Load Calendar Data",showLoading:!1,showSuccess:!1,retryOptions:{maxRetries:2,baseDelay:1e3,shouldRetry:(h,r)=>!(h.message?.includes("validation")||h.message?.includes("invalid"))},errorOptions:{severity:ae.SEVERITY.MEDIUM,showToast:!1,context:{forceRefresh:a,targetMonth:c?.toISOString()}}}).catch(h=>{if(console.error("Failed to load calendar data:",h),Be(h.message||"Failed to load calendar data"),C.events.length>0){t(C.tasks),i(C.events),o(C.teamMembers),v(C.outOfOffice),D(C.duties);try{const r=Re.getAgendaCountsForCalendarEvents(C.events);ne(r)}catch{ne({})}}}).finally(()=>{Ee(!1)}),Nt=async()=>{await ee(!0)},He=async()=>{await ee(!0,_)},jt=async a=>{if(!a){Z(!1);return}return ae.wrapOperation(async()=>{await Xe.create({...a,due_date:a.due_date||p.toISOString()}),await Nt(),Z(!1)},{operationName:"Create Task",showLoading:!0,showSuccess:!0,successMessage:"Task created successfully",retryOptions:{maxRetries:2},errorOptions:{severity:ae.SEVERITY.MEDIUM,context:{taskTitle:a.title,dueDate:a.due_date}}})},Ct=()=>{const a=ns(_);K(a)},vt=()=>{const a=is(_,1);K(a)},_t=a=>{A(a)},Ge=a=>{V(a)},Ce=a=>{re(a),a.event_type==="one_on_one"&&a.team_member_id&&(ge(a),he(!0))},Ke=()=>{he(!1),ge(null)},Ot=a=>{je(`/team/${a}`),he(!1),ge(null)},Dt=a=>{ft(a),J.setViewMode(a)},It=()=>{const a=Te(fe,{weekStartsOn:1}),c=it(fe,{weekStartsOn:1}),f=s.filter(r=>{if(!r.start_date)return!1;try{const y=E(r.start_date),x=r.end_date?E(r.end_date):y;return y>=a&&y<=c||x>=a&&x<=c||y<=a&&x>=c}catch(y){return console.warn("Invalid date in calendar event:",r.id,y),!1}}),h=J.filterEventsForView(f,B);xt(h)},kt=(a,c)=>{K(c),A(c),Ce(a),$&&ie(!1)},Tt=a=>{K(a),A(a),$&&ie(!1)},ye=()=>{ie(!q)},oe=a=>{if(!a.start_date||!a.end_date)return!1;const c=E(a.start_date),f=E(a.end_date);return Ve(f,c)>0},Mt=(a,c)=>{if(!oe(a))return"single";const f=E(a.start_date),h=E(a.end_date);return W(c,f)?"start":W(c,h)?"end":Me(c,f)&&Ae(c,h)?"middle":"none"},qe=a=>{const c=l.find(u=>u.id===a.team_member_id),f=a.start_date?L(E(a.start_date),"h:mm a"):"",h=a.end_date?L(E(a.end_date),"h:mm a"):"",r=me[a.id],y=g.getEventStyling(a),x={title:a.title,time:null,details:[],actions:[],styling:y,eventType:y.label};switch(!a.all_day&&f&&(x.time=h&&h!==f?`${f} - ${h}`:f),a.event_type){case"one_on_one":c&&(x.details.push(`1:1 with ${c.name}`),r&&r.count>0?r.hasUnresolved?x.details.push(`${r.unresolvedCount} pending agenda items`):x.details.push(`${r.count} agenda items ready`):x.details.push("No agenda items yet"),x.actions.push("Click to view team member profile"));break;case"out_of_office":if(c&&(x.details.push(`${c.name} is out of office`),oe(a))){const u=Ve(E(a.end_date),E(a.start_date))+1;x.details.push(`Duration: ${u} day${u>1?"s":""}`)}break;case"duty":if(c&&(x.details.push(`Duty assignment for ${c.name}`),oe(a))){const u=Ve(E(a.end_date),E(a.start_date))+1;x.details.push(`Duration: ${u} day${u>1?"s":""}`)}break;case"birthday":c&&x.details.push(`Wish ${c.name} a happy birthday!`);break}return a.description&&a.description!==a.title&&x.details.push(a.description),x},At=a=>{const c=lt(a),f=ct(a);return s.filter(h=>{if(!h.start_date)return!1;try{const r=E(h.start_date),y=h.end_date?E(h.end_date):r;return r>=c&&r<=f||y>=c&&y<=f||r<=c&&y>=f}catch(r){return console.warn("Invalid date in calendar event:",h.id,r),!1}})},Vt=()=>{const a=At(_),c=J.getEventCounts(a);return e.jsxs("div",{className:"space-y-4 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-xl font-semibold",children:L(_,"MMMM yyyy")}),$&&e.jsx(M,{variant:"outline",size:"icon",onClick:ye,title:q?"Hide weekly meetings":"Show weekly meetings",children:q?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(et,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(M,{variant:"outline",size:"icon",onClick:Ct,disabled:R,children:e.jsx(Xt,{className:"h-4 w-4"})}),e.jsx(M,{variant:"outline",size:"icon",onClick:()=>K(new Date),disabled:R,children:"Today"}),e.jsx(M,{variant:"outline",size:"icon",onClick:vt,disabled:R,children:e.jsx(Jt,{className:"h-4 w-4"})}),e.jsx(M,{variant:"outline",size:"icon",onClick:He,disabled:R,title:"Refresh calendar data",children:e.jsx(ue,{className:"h-4 w-4"})}),e.jsx(M,{variant:"outline",size:"icon",onClick:wt,disabled:R||I.isRunning,title:I.isRunning?"Sync in progress...":"Sync calendar events",className:T(I.lastError&&"border-red-200 text-red-600",I.lastSync&&!I.lastError&&"border-green-200 text-green-600"),children:I.isRunning?e.jsx(tt,{className:"h-4 w-4 animate-spin"}):I.lastError?e.jsx(st,{className:"h-4 w-4"}):e.jsx(tt,{className:"h-4 w-4"})}),!$&&e.jsx(M,{variant:"outline",size:"icon",onClick:ye,title:q?"Hide weekly meetings":"Show weekly meetings",children:q?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(et,{className:"h-4 w-4"})})]})]}),we&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3 mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-red-600 text-sm",children:[e.jsx("strong",{children:"Error loading calendar data:"})," ",we]}),e.jsx(M,{variant:"outline",size:"sm",onClick:He,disabled:R,children:"Retry"})]})}),Et&&I.lastSync&&e.jsx("div",{className:T("border rounded-md p-3 mb-4",I.lastError?"bg-red-50 border-red-200":"bg-green-50 border-green-200"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[I.lastError?e.jsx(st,{className:"h-4 w-4 text-red-600"}):e.jsx(Zt,{className:"h-4 w-4 text-green-600"}),e.jsx("div",{className:T("text-sm",I.lastError?"text-red-600":"text-green-600"),children:I.lastError?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Sync failed:"})," ",I.lastError]}):e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Sync completed"}),I.syncResults?.summary?.userMessage&&e.jsxs(e.Fragment,{children:[": ",I.syncResults.summary.userMessage]})]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:I.lastSync&&new Date(I.lastSync).toLocaleTimeString()}),e.jsx(M,{variant:"ghost",size:"sm",onClick:()=>Ne(!1),children:e.jsx(pe,{className:"h-3 w-3"})})]})]})}),e.jsx("div",{className:"flex justify-center",children:e.jsx(ds,{currentViewMode:B,onViewModeChange:Dt,eventCounts:c,disabled:R})})]})},Rt=()=>{const a="EEEE",c=[],f=Te(_);for(let h=0;h<7;h++)c.push(e.jsx("div",{className:"font-medium text-sm py-2 text-center",children:L(ot(f,h),a)},h));return e.jsx("div",{className:"grid grid-cols-7 mb-2",children:c})},Lt=()=>{const a=lt(_),c=ct(a),f=Te(a),h=it(c),r="d",y=[];let x=[],u=f;const Y=s.filter(O=>{if(!O.start_date)return!1;try{const k=E(O.start_date),Q=O.end_date?E(O.end_date):k;return k>=f&&k<=h||Q>=f&&Q<=h||k<=f&&Q>=h}catch(k){return console.warn("Invalid date in calendar event:",O.id,k),!1}}),P=J.filterEventsForView(Y,B).length>0||S.some(O=>O.due_date&&E(O.due_date)>=f&&E(O.due_date)<=h);if(!R&&!P)return e.jsx(us,{viewMode:B,onCreateTask:()=>Z(!0),onAddTeamMember:()=>je("/team"),onManageDuties:()=>je("/team")});for(;u<=h;){for(let O=0;O<7;O++){const k=L(u,r),Q=u,X=S.filter(b=>b.due_date&&W(E(b.due_date),u)),w=Y.filter(b=>{if(!b.start_date)return!1;const H=E(b.start_date),G=b.end_date?E(b.end_date):H;return W(H,u)||W(G,u)||Me(u,H)&&Ae(u,G)}),ve=J.filterEventsForView(w,B);x.push(e.jsxs("div",{className:T("min-h-[120px] p-2 border border-gray-200 relative",!rs(u,a)&&"text-gray-400 bg-gray-50",W(u,p)&&"bg-blue-50","hover:bg-blue-50 cursor-pointer transition-colors"),onClick:()=>_t(Q),children:[e.jsx("div",{className:"font-medium text-right",children:k}),e.jsxs("div",{className:"mt-2 space-y-1 max-h-[90px] overflow-y-auto",children:[X.map(b=>e.jsx("div",{className:T("text-xs p-1 rounded truncate",b.type==="meeting"&&"bg-blue-100 text-blue-800",b.type==="metric"&&"bg-green-100 text-green-800",b.type==="action"&&"bg-purple-100 text-purple-800",b.type==="generic"&&"bg-gray-100 text-gray-800"),onClick:H=>{H.stopPropagation(),Ge(b)},children:b.title},`task-${b.id}`)),ve.map(b=>{const H=Mt(b,u);if(H==="none")return null;const G=oe(b)?g.getMultiDayEventStyling(b,H,g.VARIANTS.DEFAULT):g.getEventStyling(b,g.VARIANTS.DEFAULT),Qe=G.icon,U=qe(b),$t=G.titlePrefix?`${G.titlePrefix}${b.title}`:b.title,le=me[b.id];return e.jsx(os,{children:e.jsxs(ls,{children:[e.jsx(cs,{asChild:!0,children:e.jsx("div",{className:G.className,style:G.style,onClick:ce=>{ce.stopPropagation(),Ce(b)},"aria-label":g.getAccessibilityInfo(b.event_type).ariaLabel,children:e.jsxs("div",{className:"flex items-center justify-between gap-1",children:[e.jsxs("div",{className:"flex items-center gap-1 min-w-0",children:[e.jsx(Qe,{className:"h-3 w-3 flex-shrink-0","aria-hidden":"true"}),e.jsx("span",{className:"truncate",children:$t})]}),b.event_type==="one_on_one"&&le&&le.count>0&&e.jsx(fs,{count:le.unresolvedCount||le.count,hasUnresolved:le.hasUnresolved,className:"flex-shrink-0 ml-1"})]})})}),e.jsx(mt,{side:"top",className:"max-w-xs",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"h-4 w-4 flex-shrink-0",style:{color:U.styling.colors.primary}}),e.jsx("p",{className:"font-medium",children:U.title}),e.jsx(F,{variant:"outline",className:"text-xs",style:{borderColor:U.styling.colors.primary+"50",color:U.styling.colors.primary},children:U.eventType})]}),U.time&&e.jsx("p",{className:"text-xs",children:U.time}),U.details.map((ce,_e)=>e.jsx("p",{className:"text-xs text-gray-600",children:ce},_e)),U.actions.map((ce,_e)=>e.jsx("p",{className:"text-xs text-gray-500 italic",children:ce},_e))]})})]})},`event-${b.id}-${u.toString()}`)})]}),W(u,new Date)&&e.jsx(F,{className:"absolute top-1 left-1 bg-red-500 text-white",children:"Today"})]},u.toString())),u=ot(u,1)}y.push(e.jsx("div",{className:"grid grid-cols-7",children:x},u.toString())),x=[]}return e.jsx("div",{className:"mb-4",children:y})},Ft=()=>{const a=S.filter(r=>r.due_date&&W(E(r.due_date),p)),c=s.filter(r=>{if(!r.start_date)return!1;try{const y=E(r.start_date),x=r.end_date?E(r.end_date):y;return W(y,p)||W(x,p)||Me(p,y)&&Ae(p,x)}catch(y){return console.warn("Invalid date in calendar event:",r.id,y),!1}}),f=J.filterEventsForView(c,B);return a.length>0||f.length>0?e.jsxs("div",{className:"space-y-3",children:[f.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-1",children:[e.jsx(be,{className:"h-4 w-4"}),"Events (",f.length,")"]}),e.jsx("div",{className:"space-y-2",children:f.map(r=>{const y=g.getEventCardStyling(r),x=y.icon,u=qe(r),Y=l.find(O=>O.id===r.team_member_id),te=oe(r),P=me[r.id];return e.jsxs("div",{className:y.className,onClick:()=>Ce(r),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{className:"h-4 w-4",style:{color:y.colors.primary}}),e.jsx("h4",{className:"font-medium",children:r.title}),te&&e.jsx(F,{variant:"secondary",className:"text-xs",children:"Multi-day"}),r.event_type==="one_on_one"&&P&&P.count>0&&e.jsx(gs,{count:P.count,unresolvedCount:P.unresolvedCount,hasUnresolved:P.hasUnresolved,size:"sm"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[u.time&&e.jsx("span",{className:"text-xs text-gray-500",children:u.time}),e.jsx(F,{variant:"outline",style:{borderColor:y.colors.primary+"50",color:y.colors.primary},children:u.eventType})]})]}),u.details.length>0&&e.jsx("div",{className:"mt-2 space-y-1",children:u.details.map((O,k)=>e.jsx("p",{className:"text-sm text-gray-600",children:O},k))}),te&&e.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[L(E(r.start_date),"MMM d")," - ",L(E(r.end_date),"MMM d")]}),Y&&(r.event_type==="one_on_one"||r.event_type==="meeting")&&e.jsx("div",{className:"mt-3 pt-2 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx(ke,{teamMemberId:Y.id,teamMemberName:Y.name,sourceItem:{title:r.title,description:r.description||`${r.event_type==="one_on_one"?"1:1 meeting":"Meeting"} on ${L(E(r.start_date),"MMM d, yyyy")}`,type:r.event_type,id:r.id,date:r.start_date},variant:"outline",size:"sm"}),r.event_type==="one_on_one"&&e.jsxs(M,{variant:"outline",size:"sm",onClick:()=>{ge(r),he(!0)},children:[e.jsx(es,{className:"h-4 w-4 mr-1"}),"Meeting Details"]})]})})]},r.id)})})]}),a.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-1",children:[e.jsx(Fe,{className:"h-4 w-4"}),"Tasks (",a.length,")"]}),e.jsx("div",{className:"space-y-2",children:a.map(r=>{const y=Array.isArray(r.stakeholders)?r.stakeholders:[],x=l.filter(u=>y.includes(u.name));return e.jsxs("div",{className:"p-3 border rounded-md hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>Ge(r),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium",children:r.title}),e.jsx(F,{variant:"outline",children:r.type})]}),r.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r.description}),x.length>0&&e.jsx("div",{className:"mt-3 pt-2 border-t border-gray-200 space-y-2",children:x.map(u=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:u.name}),e.jsx(ke,{teamMemberId:u.id,teamMemberName:u.name,sourceItem:{title:r.title,description:r.description,type:"task",id:r.id,priority:r.priority,status:r.status,due_date:r.due_date},variant:"outline",size:"sm"})]},u.id))})]},r.id)})})]})]}):e.jsx(ms,{viewMode:B,onCreateTask:()=>Z(!0)})};return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col xl:flex-row space-y-6 xl:space-y-0 xl:space-x-6",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Calendar"}),e.jsxs(M,{onClick:()=>Z(!0),disabled:R,children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),"New Task"]})]}),R?e.jsx(hs,{}):e.jsxs(e.Fragment,{children:[Vt(),Rt(),Lt()]})]}),e.jsxs("div",{className:"xl:w-80",children:[e.jsxs("div",{className:"bg-white rounded-md border p-4 sticky top-4",children:[e.jsx("h2",{className:"font-semibold mb-4 pb-2 border-b",children:L(p,"MMMM d, yyyy")}),Ft()]}),q&&e.jsxs("div",{className:T("mt-6",$&&"fixed inset-0 z-50 bg-white p-4 overflow-y-auto"),children:[$&&e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Weekly Meetings"}),e.jsx(M,{variant:"ghost",size:"icon",onClick:ye,children:e.jsx(pe,{className:"h-4 w-4"})})]}),e.jsx(Oe,{componentName:"Weekly Meeting Sidebar",inline:!0,children:e.jsx(m.Suspense,{fallback:e.jsx(Ze,{}),children:e.jsx(bs,{currentWeek:fe,meetings:pt,onMeetingClick:kt,onDateNavigate:Tt,agendaCounts:me,isLoading:R,error:we,onRetry:()=>ee(!0),className:T($&&"static")})})})]})]})]}),$&&q&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:ye,"aria-hidden":"true"}),e.jsx(De,{open:gt,onOpenChange:Z,children:e.jsxs(Ie,{className:"sm:max-w-lg",children:[e.jsx(at,{children:e.jsxs(rt,{children:["Add Task for ",L(p,"MMMM d, yyyy")]})}),e.jsx(Oe,{componentName:"Task Creation Form",children:e.jsx(m.Suspense,{fallback:e.jsx(Bt,{}),children:e.jsx(ps,{onCreateTask:jt,initialTaskData:{due_date:p.toISOString(),status:"todo",priority:"medium",type:"generic"}})})})]})}),e.jsx(De,{open:ze,onOpenChange:Ke,children:e.jsx(Ie,{className:"sm:max-w-3xl max-h-[90vh] overflow-y-auto",children:e.jsx(Oe,{componentName:"Meeting Detail View",children:e.jsx(m.Suspense,{fallback:e.jsx(Ze,{}),children:e.jsx(xs,{event:Se,teamMember:Se?l.find(a=>a.id===Se.team_member_id):null,isOpen:ze,onClose:Ke,onNavigateToProfile:Ot})})})})}),e.jsx(De,{open:!!N,onOpenChange:()=>V(null),children:N&&e.jsxs(Ie,{className:"sm:max-w-lg",children:[e.jsx(at,{children:e.jsx(rt,{children:"Task Details"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:N.title}),e.jsxs("div",{className:"flex items-center mt-2 space-x-2",children:[e.jsx(F,{children:N.type}),e.jsxs(F,{variant:"outline",children:[N.priority," priority"]}),N.strategic&&e.jsx(F,{variant:"secondary",children:"Strategic"})]})]}),N.description&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-gray-500",children:"Description"}),e.jsx("p",{children:N.description})]}),N.due_date&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-gray-500",children:"Due Date"}),e.jsx("p",{children:L(E(N.due_date),"PPpp")})]}),N.stakeholders?.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-gray-500",children:"Stakeholders"}),e.jsx("p",{children:N.stakeholders.join(", ")}),e.jsx("div",{className:"mt-3 space-y-2",children:N.stakeholders.map(a=>{const c=l.find(f=>f.name===a);return c?e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsx("span",{className:"text-sm font-medium",children:c.name}),e.jsx(ke,{teamMemberId:c.id,teamMemberName:c.name,sourceItem:{title:N.title,description:N.description,type:"task",id:N.id,priority:N.priority,status:N.status,due_date:N.due_date},variant:"outline",size:"sm"})]},c.id):null})})]}),N.tags?.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-gray-500",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:N.tags.map((a,c)=>e.jsx(F,{variant:"secondary",children:a},c))})]})]})]})})]})})}const Ts=Object.freeze(Object.defineProperty({__proto__:null,default:Es},Symbol.toStringTag,{value:"Module"}));export{Re as A,gs as C,g as E,fs as a,Ts as b};
