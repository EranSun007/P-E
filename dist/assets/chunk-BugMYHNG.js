import{j as e,aw as U,bg as z,U as L,bh as Y,bi as K,bj as J,D as $,aK as W,bc as X,T as Z}from"./chunk-BlD_ekKQ.js";import{a as g}from"./chunk-BKwDNIOR.js";import{D as O,a as ee,b as ae,c as se,e as te,d as re,B as S}from"./chunk-CmitwiBI.js";import{G as le,l as ne,L as c,I,q as de,B as F,d as oe}from"./index-BPpXP9wP.js";import{R as ce,a as A}from"./chunk-fsVcrzvE.js";import{S as k,a as P,b as R,c as V,d as q}from"./chunk-DBni0BOz.js";import{b as C,r as Q,p as x}from"./chunk-P_BNsj9B.js";import{D as ie,a as me,b as xe,d as B}from"./chunk-D-Q6W0fT.js";import{A as be,a as ue,b as he,c as ge,d as pe,e as _e,f as je,g as ye,h as ve}from"./chunk-DVqya-Gr.js";import{a as fe}from"./chunk-uiVOWrDz.js";const G=[{value:"vacation",label:"Vacation",icon:U,color:"blue"},{value:"sick",label:"Sick Leave",icon:z,color:"red"},{value:"personal",label:"Personal Day",icon:L,color:"purple"},{value:"conference",label:"Conference",icon:Y,color:"green"},{value:"learning",label:"Learning",icon:K,color:"amber"},{value:"army_reserve",label:"Army Reserve",icon:J,color:"slate"},{value:"other",label:"Other",icon:$,color:"orange"}],Ee=({open:t,onOpenChange:b,onSubmit:p,initialData:d=null,preselectedTeamMemberId:u=null,preselectedDate:_=null,isLoading:o=!1})=>{const[s,l]=g.useState({team_member_id:"",type:"other",start_date:"",end_date:"",half_day:null,notes:""}),[j,i]=g.useState([]),[D,y]=g.useState(!1),[n,h]=g.useState({});g.useEffect(()=>{t&&f()},[t]),g.useEffect(()=>{if(t){if(d)l({team_member_id:d.team_member_id||"",type:d.type||"other",start_date:d.start_date?d.start_date.split("T")[0]:"",end_date:d.end_date?d.end_date.split("T")[0]:"",half_day:d.half_day||null,notes:d.notes||""});else{const a=_?C(_,"yyyy-MM-dd"):C(new Date,"yyyy-MM-dd");l({team_member_id:u||"",type:"other",start_date:a,end_date:a,half_day:null,notes:""})}h({})}},[t,d,u,_]);const f=async()=>{y(!0);try{const a=await le.list();i(Array.isArray(a)?a:[])}catch(a){ne.error("Failed to load team members",{error:String(a)}),i([])}finally{y(!1)}},r=(a,v)=>{l(M=>({...M,[a]:v})),n[a]&&h(M=>({...M,[a]:""}))},m=()=>{const a={};return s.team_member_id||(a.team_member_id="Team member is required"),s.type||(a.type="Type is required"),s.start_date||(a.start_date="Start date is required"),s.end_date||(a.end_date="End date is required"),s.start_date&&s.end_date&&s.start_date>s.end_date&&(a.end_date="End date must be on or after start date"),h(a),Object.keys(a).length===0},N=async a=>{if(a.preventDefault(),!m())return;const v={team_member_id:s.team_member_id,type:s.type,start_date:s.start_date,end_date:s.end_date,half_day:s.half_day,notes:s.notes.trim()||null,status:"approved"};await p(v)},T=!!d,w=G.find(a=>a.value===s.type),E=()=>{if(!s.start_date||!s.end_date)return null;const a=Q(new Date(s.end_date),new Date(s.start_date))+1;return s.half_day?"0.5 day":a===1?"1 day":`${a} days`};return e.jsx(O,{open:t,onOpenChange:b,children:e.jsxs(ee,{className:"sm:max-w-lg",children:[e.jsxs(ae,{children:[e.jsx(se,{children:T?"Edit Time Off":"Add Time Off"}),e.jsx(te,{children:T?"Update the time off details.":"Record time off for a team member."})]}),e.jsxs("form",{onSubmit:N,className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"team_member",children:"Team Member *"}),e.jsxs(k,{value:s.team_member_id,onValueChange:a=>r("team_member_id",a),disabled:o||D,children:[e.jsx(P,{className:n.team_member_id?"border-destructive":"",children:e.jsx(R,{placeholder:D?"Loading...":j.length===0?"No team members found":"Select team member"})}),e.jsx(V,{children:j.map(a=>e.jsxs(q,{value:a.id,children:[a.name," ",a.department?`(${a.department})`:""]},a.id))})]}),n.team_member_id&&e.jsx("p",{className:"text-sm text-destructive",children:n.team_member_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"type",children:"Type *"}),e.jsxs(k,{value:s.type,onValueChange:a=>r("type",a),disabled:o,children:[e.jsx(P,{className:n.type?"border-destructive":"",children:e.jsx(R,{placeholder:"Select type"})}),e.jsx(V,{children:G.map(a=>{const v=a.icon;return e.jsx(q,{value:a.value,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(v,{className:`h-4 w-4 text-${a.color}-500`}),a.label]})},a.value)})})]}),n.type&&e.jsx("p",{className:"text-sm text-destructive",children:n.type})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"start_date",children:"Start Date *"}),e.jsx(I,{id:"start_date",type:"date",value:s.start_date,onChange:a=>{r("start_date",a.target.value),s.end_date&&a.target.value>s.end_date&&r("end_date",a.target.value)},disabled:o,className:n.start_date?"border-destructive":""}),n.start_date&&e.jsx("p",{className:"text-sm text-destructive",children:n.start_date})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"end_date",children:"End Date *"}),e.jsx(I,{id:"end_date",type:"date",value:s.end_date,onChange:a=>r("end_date",a.target.value),disabled:o,min:s.start_date,className:n.end_date?"border-destructive":""}),n.end_date&&e.jsx("p",{className:"text-sm text-destructive",children:n.end_date})]})]}),s.start_date===s.end_date&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Duration"}),e.jsxs(ce,{value:s.half_day||"full",onValueChange:a=>r("half_day",a==="full"?null:a),className:"flex gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{value:"full",id:"full"}),e.jsx(c,{htmlFor:"full",className:"font-normal",children:"Full Day"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{value:"morning",id:"morning"}),e.jsx(c,{htmlFor:"morning",className:"font-normal",children:"Morning Only"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{value:"afternoon",id:"afternoon"}),e.jsx(c,{htmlFor:"afternoon",className:"font-normal",children:"Afternoon Only"})]})]})]}),E()&&e.jsx("div",{className:"p-3 bg-gray-50 rounded-md border",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Duration:"})," ",E(),w&&e.jsxs("span",{className:`ml-2 text-${w.color}-600`,children:["(",w.label,")"]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"notes",children:"Notes (optional)"}),e.jsx(de,{id:"notes",placeholder:"Any additional details...",value:s.notes,onChange:a=>r("notes",a.target.value),disabled:o,rows:2})]})]}),e.jsxs(re,{children:[e.jsx(F,{variant:"outline",onClick:()=>b(!1),disabled:o,children:"Cancel"}),e.jsx(F,{onClick:N,disabled:o,children:o?"Saving...":T?"Update":"Add Time Off"})]})]})})},H={vacation:{label:"Vacation",icon:U,bgClass:"bg-blue-100",textClass:"text-blue-800",borderClass:"border-blue-200",badgeClass:"bg-blue-100 text-blue-800"},sick:{label:"Sick Leave",icon:z,bgClass:"bg-red-100",textClass:"text-red-800",borderClass:"border-red-200",badgeClass:"bg-red-100 text-red-800"},personal:{label:"Personal Day",icon:L,bgClass:"bg-purple-100",textClass:"text-purple-800",borderClass:"border-purple-200",badgeClass:"bg-purple-100 text-purple-800"},conference:{label:"Conference",icon:Y,bgClass:"bg-green-100",textClass:"text-green-800",borderClass:"border-green-200",badgeClass:"bg-green-100 text-green-800"},learning:{label:"Learning",icon:K,bgClass:"bg-amber-100",textClass:"text-amber-800",borderClass:"border-amber-200",badgeClass:"bg-amber-100 text-amber-800"},army_reserve:{label:"Army Reserve",icon:J,bgClass:"bg-slate-100",textClass:"text-slate-800",borderClass:"border-slate-300",badgeClass:"bg-slate-100 text-slate-800"},other:{label:"Other",icon:$,bgClass:"bg-orange-100",textClass:"text-orange-800",borderClass:"border-orange-200",badgeClass:"bg-orange-100 text-orange-800"}},Ie=({timeOff:t,onEdit:b,onDelete:p,compact:d=!1,showTeamMember:u=!0,isLoading:_=!1,index:o=0})=>{const{isPresentationMode:s}=oe(),l=H[t.type]||H.other,j=l.icon,i=s?fe(t.team_member_name,o,"Team Member"):t.team_member_name,y=(()=>{if(t.half_day)return"½ day";if(t.start_date&&t.end_date){const r=Q(x(t.end_date),x(t.start_date))+1;return r===1?"1 day":`${r} days`}return null})(),n=()=>{if(!t.start_date)return"No date";const r=C(x(t.start_date),"MMM d");if(!t.end_date||t.start_date===t.end_date)return t.half_day?`${r} (${t.half_day==="morning"?"AM":"PM"})`:r;const m=C(x(t.end_date),"MMM d");return`${r} - ${m}`},h=()=>{const r=new Date;r.setHours(0,0,0,0);const m=x(t.start_date),N=x(t.end_date);return r>=m&&r<=N},f=()=>{const r=new Date;r.setHours(0,0,0,0);const m=x(t.end_date);return r>m};return d?e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded-md ${l.bgClass} ${l.borderClass} border ${f()?"opacity-60":""}`,children:[e.jsx(j,{className:`h-4 w-4 ${l.textClass}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[u&&e.jsx("div",{className:`text-sm font-medium ${l.textClass} truncate`,children:i}),e.jsxs("div",{className:"text-xs text-gray-600",children:[l.label," · ",n()]})]}),h()&&e.jsx(S,{variant:"outline",className:"text-[10px] px-1 py-0 bg-green-100 text-green-700 border-green-200",children:"Now"})]}):e.jsx("div",{className:`p-3 rounded-lg border ${l.borderClass} ${f()?"opacity-60":""}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:`p-2 rounded-lg ${l.bgClass}`,children:e.jsx(j,{className:`h-5 w-5 ${l.textClass}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[u&&e.jsx("span",{className:"font-medium",children:i}),e.jsx(S,{variant:"outline",className:l.badgeClass,children:l.label}),h()&&e.jsx(S,{variant:"outline",className:"bg-green-100 text-green-700 border-green-200",children:"Active"})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx($,{className:"h-3 w-3"}),n()]}),y&&e.jsxs("span",{className:"text-xs",children:["(",y,")"]})]}),t.notes&&!s&&e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:t.notes})]})]}),!s&&(b||p)&&e.jsxs(ie,{children:[e.jsx(me,{asChild:!0,children:e.jsx(F,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",disabled:_,children:e.jsx(W,{className:"h-4 w-4"})})}),e.jsxs(xe,{align:"end",children:[b&&e.jsxs(B,{onClick:()=>b(t),children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),"Edit"]}),p&&e.jsxs(be,{children:[e.jsx(ue,{asChild:!0,children:e.jsxs(B,{onSelect:r=>r.preventDefault(),className:"text-red-600",children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"Delete"]})}),e.jsxs(he,{children:[e.jsxs(ge,{children:[e.jsx(pe,{children:"Delete Time Off?"}),e.jsxs(_e,{children:["This will permanently delete the ",l.label.toLowerCase()," entry",u&&i?` for ${i}`:"",". This action cannot be undone."]})]}),e.jsxs(je,{children:[e.jsx(ye,{children:"Cancel"}),e.jsx(ve,{onClick:()=>p(t.id),className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})]})]})]})]})})};export{Ee as T,Ie as a};
