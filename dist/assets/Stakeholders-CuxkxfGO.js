import{j as e,Y as C,J as H,g as U}from"./chunk-DHGN2BiO.js";import{a as t}from"./chunk-pjYta8vt.js";import{S as j,e as V,B as m,I as c,g as _,i as J,j as Q,h as O,L as i}from"./index-ByFAet0J.js";import{B as w,D as Y,a as q,b as G,c as K,d as W}from"./chunk-C6AVtkQH.js";import{S as A,a as D,b as E,c as L,d}from"./chunk-D3uHh-f_.js";import{A as X}from"./chunk-UtEqcWk6.js";import"./chunk-CZDJnSNg.js";import"./chunk-Dt0Bnklg.js";import"./chunk-PmtS5Ynq.js";function ce(){const[v,g]=t.useState([]),[x,F]=t.useState([]),[$,f]=t.useState(!0),[z,r]=t.useState(!1),[y,I]=t.useState(""),[N,u]=t.useState(null),[o,b]=t.useState(null),[l,n]=t.useState({name:"",role:"",email:"",phone:"",company:"",influence_level:"medium",engagement_level:"active",contact_info:"",notes:"",tags:[]});t.useEffect(()=>{S()},[]);const S=async()=>{f(!0),u(null);try{const[a,s]=await Promise.all([j.list(),V.list()]);if(!a)g([]);else{const p=Array.isArray(a)?a:[];g(p)}const h=Array.isArray(s)?s:[];F(h)}catch(a){console.error("Failed to load stakeholders:",a),u("Failed to load stakeholders"),g([])}finally{f(!1)}},M=()=>{n({name:"",role:"",email:"",phone:"",company:"",influence_level:"medium",engagement_level:"active",contact_info:"",notes:"",tags:[]}),b(null),r(!0)},P=a=>{n({name:a.name||"",role:a.role||"",email:a.email||"",phone:a.phone||"",company:a.company||a.organization||"",influence_level:a.influence_level||a.influence||"medium",engagement_level:a.engagement_level||"active",contact_info:a.contact_info||"",notes:a.notes||a.description||"",tags:Array.isArray(a.tags)?a.tags:[]}),b(a),r(!0)},R=async()=>{try{o?await j.update(o.id,l):await j.create(l),r(!1),S()}catch(a){console.error(`Failed to ${o?"update":"create"} stakeholder:`,a),u(`Failed to ${o?"update":"create"} stakeholder`)}};if($)return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto text-center",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-indigo-600 border-t-transparent rounded-full mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading stakeholders..."})]})});const T=(v||[]).filter(a=>{if(!a)return!1;const s=(y||"").toLowerCase(),h=(a.name||"").toLowerCase(),p=(a.role||"").toLowerCase(),B=(a.company||a.organization||"").toLowerCase();return h.includes(s)||p.includes(s)||B.includes(s)});return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Stakeholders"}),e.jsxs(m,{onClick:M,children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),"Add Stakeholder"]})]}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx(H,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(c,{placeholder:"Search stakeholders...",value:y,onChange:a=>I(a.target.value),className:"pl-9"})]}),N&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 text-red-600 rounded-md",children:N}),v.length===0?e.jsxs(_,{className:"text-center p-12",children:[e.jsx(U,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No stakeholders yet"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Create your first stakeholder to get started"}),e.jsxs(m,{onClick:()=>r(!0),children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),"Add First Stakeholder"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:T.map(a=>a&&e.jsxs(_,{children:[e.jsxs(J,{children:[e.jsx(Q,{children:a.name||"Unnamed Stakeholder"}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(w,{className:(a.influence_level||a.influence)==="high"?"bg-red-100 text-red-800":(a.influence_level||a.influence)==="medium"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800",children:[a.influence_level||a.influence||"medium"," influence"]}),e.jsx(w,{className:a.engagement_level==="active"?"bg-green-100 text-green-800":a.engagement_level==="passive"?"bg-gray-100 text-gray-800":"bg-orange-100 text-orange-800",children:a.engagement_level||"active"})]})]}),e.jsxs(O,{children:[a.role&&e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:a.role}),(a.company||a.organization)&&e.jsx("p",{className:"text-sm text-gray-500 mb-2",children:a.company||a.organization}),a.email&&e.jsx("p",{className:"text-sm text-blue-600 mb-1",children:a.email}),(a.notes||a.description)&&e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:a.notes||a.description}),e.jsxs("div",{className:"mt-3 flex flex-col gap-2",children:[e.jsx(m,{size:"sm",variant:"outline",onClick:()=>P(a),children:"Edit"}),x.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Add to team member agendas:"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[x.slice(0,3).map(s=>e.jsx(X,{teamMemberId:s.id,teamMemberName:s.name,sourceItem:{title:`Stakeholder: ${a.name}`,description:`${a.role?`${a.role} - `:""}${a.company||a.organization||""}${a.notes||a.description?` | ${a.notes||a.description}`:""}`,type:"stakeholder",id:a.id,influence_level:a.influence_level||a.influence,engagement_level:a.engagement_level},variant:"ghost",size:"xs",showAgendaAction:!0,showPersonalFileAction:!0},s.id)),x.length>3&&e.jsxs("span",{className:"text-xs text-gray-400",children:["+",x.length-3," more"]})]})]})]})]})]},a.id||Math.random()))}),e.jsx(Y,{open:z,onOpenChange:r,children:e.jsxs(q,{children:[e.jsx(G,{children:e.jsx(K,{children:o?"Edit Stakeholder":"Add New Stakeholder"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Name"}),e.jsx(c,{value:l.name,onChange:a=>n(s=>({...s,name:a.target.value})),placeholder:"Enter full name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Role"}),e.jsx(c,{value:l.role,onChange:a=>n(s=>({...s,role:a.target.value})),placeholder:"Job title or role"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Company"}),e.jsx(c,{value:l.company,onChange:a=>n(s=>({...s,company:a.target.value})),placeholder:"Company name"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Email"}),e.jsx(c,{type:"email",value:l.email,onChange:a=>n(s=>({...s,email:a.target.value})),placeholder:"Email address"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Phone"}),e.jsx(c,{type:"tel",value:l.phone,onChange:a=>n(s=>({...s,phone:a.target.value})),placeholder:"Phone number"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Influence Level"}),e.jsxs(A,{value:l.influence_level,onValueChange:a=>n(s=>({...s,influence_level:a})),children:[e.jsx(D,{children:e.jsx(E,{placeholder:"Select influence level"})}),e.jsxs(L,{children:[e.jsx(d,{value:"low",children:"Low"}),e.jsx(d,{value:"medium",children:"Medium"}),e.jsx(d,{value:"high",children:"High"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Engagement Level"}),e.jsxs(A,{value:l.engagement_level,onValueChange:a=>n(s=>({...s,engagement_level:a})),children:[e.jsx(D,{children:e.jsx(E,{placeholder:"Select engagement level"})}),e.jsxs(L,{children:[e.jsx(d,{value:"active",children:"Active"}),e.jsx(d,{value:"passive",children:"Passive"}),e.jsx(d,{value:"resistant",children:"Resistant"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Contact Info"}),e.jsx(c,{value:l.contact_info,onChange:a=>n(s=>({...s,contact_info:a.target.value})),placeholder:"Additional contact information"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Notes"}),e.jsx(c,{value:l.notes,onChange:a=>n(s=>({...s,notes:a.target.value})),placeholder:"Additional notes about this stakeholder"})]})]}),e.jsxs(W,{children:[e.jsx(m,{variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(m,{onClick:R,children:o?"Update Stakeholder":"Create Stakeholder"})]})]})})]})})}export{ce as default};
