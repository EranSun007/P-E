const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TeamMemberDeletionDialog-X0aB__-X.js","assets/chunk-DHGN2BiO.js","assets/chunk-pjYta8vt.js","assets/chunk-C6AVtkQH.js","assets/chunk-CZDJnSNg.js","assets/index-ByFAet0J.js","assets/index-zbygvEX7.css","assets/chunk-PmtS5Ynq.js","assets/chunk-D7j8sKMm.js"])))=>i.map(i=>d[i]);
import{c as xe,e as T,T as pe,B as C,A as ge,b as ue,I as g,g as je,i as ve,p as fe,q as ye,s as Ne,j as Ce,k as we,h as ke,l as be,L as x,C as De,f as Te,m as H,r as Ae,_ as Me}from"./index-ByFAet0J.js";import{j as e,ad as Se,Y as Q,J as Fe,ai as Ee,aj as Pe,a0 as _e,ao as Ie,ap as Le,aq as Be,a5 as $e,ar as Ge}from"./chunk-DHGN2BiO.js";import{j as Re,a as r}from"./chunk-pjYta8vt.js";import{A as Ue}from"./chunk-zMH1QFF_.js";import{E as Oe}from"./chunk-DSBO3d0u.js";import{A as Ve}from"./chunk-bOf-e9Xy.js";import{B as w,D as Y,a as J,b as ze,c as qe,d as He}from"./chunk-C6AVtkQH.js";import{T as Qe,a as Ye,b as Je,c as Ke}from"./chunk-CMJ2xOR1.js";import{T as We}from"./chunk-Dt0Bnklg.js";import{S as Xe,a as Ze,b as ea,c as aa,d as A}from"./chunk-D3uHh-f_.js";import{D as sa,a as ta,b as la,d as K}from"./chunk-DebkpaDS.js";import{T as ra}from"./chunk-BxZc7glH.js";import{C as L}from"./chunk-BKHKgTH6.js";import"./chunk-CZDJnSNg.js";import"./chunk-BdHZTqfh.js";import"./chunk-DZDJsQre.js";const na=({totalGoals:u=0,activeGoals:k=0,completedGoals:j=0,pausedGoals:v=0,onClick:M,className:B,size:S="default"})=>{if(u===0)return null;const $=u===1?"1 Goal":`${u} Goals`,F={sm:"text-xs h-5 px-2",default:"text-sm h-6 px-2",lg:"text-sm h-7 px-3"},d=()=>k>0?"default":j>0?"secondary":"outline",E=e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium",children:"Goal Breakdown"}),k>0&&e.jsxs("div",{className:"text-sm",children:[k," Active"]}),j>0&&e.jsxs("div",{className:"text-sm",children:[j," Completed"]}),v>0&&e.jsxs("div",{className:"text-sm",children:[v," Paused"]})]});return e.jsx(Qe,{children:e.jsxs(Ye,{children:[e.jsx(Je,{asChild:!0,children:e.jsxs(w,{variant:d(),className:xe("goals-badge flex items-center gap-1 cursor-pointer hover:bg-accent transition-colors",F[S],B),onClick:M,children:[e.jsx(Se,{className:"h-3 w-3"}),$]})}),e.jsx(Ke,{children:E})]})})},ia=r.lazy(()=>Ae(()=>Me(()=>import("./TeamMemberDeletionDialog-X0aB__-X.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])),3,1e3));function ka(){const u=Re(),[k,j]=r.useState([]),[v,M]=r.useState([]),[B,S]=r.useState({}),[$,F]=r.useState({}),[d,E]=r.useState(""),[W,f]=r.useState(!1),[p,G]=r.useState(null),[X,R]=r.useState(!0),[P,y]=r.useState(!1),[Z,_]=r.useState(null),[U,b]=r.useState(null),[c,D]=r.useState({name:"",role:"",email:"",phone:"",department:"",availability:"full_time",skills:[],notes:"",avatar:""});r.useEffect(()=>{I()},[]);const I=async()=>{R(!0),b(null);try{const a=await T.list().catch(()=>[]),t=await pe.list().catch(()=>[]);j(t||[]);let s={};try{s=await Ue.getAgendaSummaryForAllMembers()}catch(h){console.error("Failed to load agenda data:",h)}S(s);let n={};try{n=(await Oe.getAllGoals()).reduce((o,i)=>(o[i.employeeId]||(o[i.employeeId]={total:0,active:0,completed:0,paused:0}),o[i.employeeId].total++,i.status==="active"?o[i.employeeId].active++:i.status==="completed"?o[i.employeeId].completed++:i.status==="paused"&&o[i.employeeId].paused++,o),{})}catch(h){console.error("Failed to load goals data:",h)}F(n);const l=(a||[]).map(h=>{const o=(t||[]).filter(N=>(N.metadata?.meeting?.participants||[]).includes(h.name));let i=null;o.length>0&&(i=o.reduce((N,he)=>{const q=new Date(he.created_date);return!N||q>N?q:N},null));const de=s[h.id]||{count:0,recentItems:[],hasUnresolved:!1},me=n[h.id]||{total:0,active:0,completed:0,paused:0};return{...h,tasks:o,taskCount:o.length,lastActivity:i?i.toISOString():null,agenda:de,goals:me}});M(l)}catch(a){console.error("Failed to load team members:",a),b("Failed to load team members. Please try again.")}finally{R(!1)}},O=()=>{D({name:"",role:"",email:"",phone:"",department:"",availability:"full_time",skills:[],notes:"",avatar:""}),G(null),f(!0)},ee=a=>{a&&(D({name:a.name||"",role:a.role||"",email:a.email||"",phone:a.phone||"",department:a.department||"",availability:a.availability||"full_time",skills:Array.isArray(a.skills)?a.skills:[],notes:a.notes||"",avatar:a.avatar||""}),G(a),f(!0))},m=(a,t)=>{if(a==="skills"){const s=Array.isArray(t)?t:[];D(n=>({...n,[a]:s}))}else D(s=>({...s,[a]:t}))},ae=async()=>{try{let a;const t=p?{...p}:null;if(p){a=await T.update(p.id,c);try{await L.handleTeamMemberUpdate(p.id,a,t)}catch(s){console.error("Failed to update birthday events:",s)}}else{a=await T.create(c);try{await L.handleTeamMemberCreation(a)}catch(s){console.error("Failed to generate birthday events:",s)}}f(!1),await I()}catch(a){console.error("Failed to save team member:",a),b("Failed to save team member. Please try again.")}},se=a=>{_(a),y(!0)},te=async(a,t)=>{try{try{await L.handleTeamMemberDeletion(a)}catch(s){console.error("Failed to clean up calendar events:",s)}await T.delete(a),y(!1),_(null),await I()}catch(s){console.error("Failed to delete team member:",s),b("Failed to delete team member. Please try again.")}},le=()=>{y(!1),_(null)},V=d?v.filter(a=>a.name.toLowerCase().includes(d.toLowerCase())||(a.role||"").toLowerCase().includes(d.toLowerCase())||(a.department||"").toLowerCase().includes(d.toLowerCase())||Array.isArray(a.skills)&&a.skills.some(t=>t.toLowerCase().includes(d.toLowerCase()))):v,re=a=>a.split(" ").map(t=>t[0]).join("").toUpperCase().substring(0,2),ne=a=>{const t=["bg-blue-100 text-blue-800","bg-green-100 text-green-800","bg-purple-100 text-purple-800","bg-pink-100 text-pink-800","bg-yellow-100 text-yellow-800","bg-indigo-100 text-indigo-800","bg-red-100 text-red-800","bg-orange-100 text-orange-800"],s=a.split("").reduce((n,l)=>n+l.charCodeAt(0),0)%t.length;return t[s]},ie=a=>{if(!a)return"No recent activity";const t=new Date(a),n=new Date-t,l=Math.floor(n/(1e3*60*60*24));return l===0?"Today":l===1?"Yesterday":l<7?`${l} days ago`:l<30?`${Math.floor(l/7)} week${Math.floor(l/7)>1?"s":""} ago`:l<365?`${Math.floor(l/30)} month${Math.floor(l/30)>1?"s":""} ago`:`${Math.floor(l/365)} year${Math.floor(l/365)>1?"s":""} ago`},oe=a=>{const t={full_time:"bg-green-100 text-green-800",part_time:"bg-blue-100 text-blue-800",contractor:"bg-orange-100 text-orange-800",remote:"bg-purple-100 text-purple-800"},s={full_time:"Full-time",part_time:"Part-time",contractor:"Contractor",remote:"Remote"};return e.jsx(w,{className:t[a]||"bg-gray-100 text-gray-800",children:s[a]||a})},z=a=>{u(H("TeamMemberProfile")+`?id=${a}`)},ce=a=>{u(H("TeamMemberProfile")+`?id=${a}&tab=goals`)};return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Team Members"}),e.jsxs(C,{onClick:O,children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Add Team Member"]})]}),U&&e.jsx(ge,{variant:"destructive",className:"mb-6",children:e.jsx(ue,{children:U})}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx(Fe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(g,{placeholder:"Search team members by name, role, department, or skills...",value:d,onChange:a=>E(a.target.value),className:"pl-9"})]}),X?e.jsxs("div",{className:"text-center p-12",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-indigo-600 border-t-transparent rounded-full mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading team members..."})]}):V.length===0?e.jsx("div",{className:"text-center p-12 border border-dashed rounded-lg",children:d?e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No team members found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your search term"})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No team members yet"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Add team members to track participants in meetings and collaboration"}),e.jsxs(C,{onClick:O,children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Add First Team Member"]})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:V.map(a=>{const t=ne(a.name);return e.jsxs(je,{className:"overflow-hidden",children:[e.jsxs(ve,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-4 cursor-pointer group",onClick:()=>z(a.id),children:[e.jsxs(fe,{className:`h-12 w-12 ${a.avatar?"":t} ring-2 ring-white transition-transform group-hover:scale-105`,children:[a.avatar?e.jsx(ye,{src:a.avatar,alt:a.name}):null,e.jsx(Ne,{children:re(a.name)})]}),e.jsxs("div",{children:[e.jsx(Ce,{className:"group-hover:text-indigo-600 transition-colors",children:a.name}),a.role&&e.jsx(we,{className:"mt-1",children:a.role})]})]}),e.jsxs(sa,{children:[e.jsx(ta,{asChild:!0,children:e.jsx(C,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(Ee,{className:"h-4 w-4"})})}),e.jsxs(la,{align:"end",children:[e.jsxs(K,{onClick:()=>ee(a),children:[e.jsx(Pe,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(K,{onClick:()=>se(a),className:"text-red-600",children:[e.jsx(_e,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 flex-wrap",children:[a.department&&e.jsxs(w,{variant:"outline",className:"flex items-center gap-1",children:[e.jsx(Ie,{className:"h-3 w-3"}),a.department]}),a.availability&&oe(a.availability),a.agenda&&e.jsx(Ve,{count:a.agenda.count,unresolvedCount:a.agenda.hasUnresolved?a.agenda.count:0,hasUnresolved:a.agenda.hasUnresolved,onClick:()=>z(a.id),memberName:a.name,size:"sm"}),a.goals&&a.goals.total>0&&e.jsx(na,{totalGoals:a.goals.total,activeGoals:a.goals.active,completedGoals:a.goals.completed,pausedGoals:a.goals.paused,onClick:()=>ce(a.id),size:"sm"})]})]}),e.jsxs(ke,{className:"space-y-4",children:[Array.isArray(a.skills)&&a.skills.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-500 mb-2 flex items-center gap-1",children:[e.jsx(Le,{className:"h-3.5 w-3.5"}),"Skills"]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:Array.isArray(a.skills)&&a.skills.map((s,n)=>e.jsx(w,{variant:"outline",className:"text-xs",children:s},n))})]}),a.notes&&e.jsx("p",{className:"text-sm text-gray-600",children:a.notes}),Array.isArray(a.tasks)&&a.tasks.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:"Recent Meetings"}),e.jsx("div",{className:"space-y-2",children:a.tasks.filter(s=>s.type==="meeting").sort((s,n)=>new Date(n.created_date)-new Date(s.created_date)).slice(0,2).map(s=>e.jsx("div",{className:"p-2 bg-gray-50 rounded-md text-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"truncate",children:s.title}),e.jsxs(w,{variant:"outline",className:"ml-2 flex items-center gap-1 whitespace-nowrap",children:[e.jsx(Be,{className:"h-3 w-3"}),s.status]})]})},s.id))})]}),e.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx($e,{className:"h-3 w-3"}),ie(a.lastActivity)]}),a.taskCount>0&&e.jsxs("span",{children:[a.taskCount," meetings"]})]})]}),a.email&&e.jsx(be,{className:"border-t pt-4",children:e.jsxs("a",{href:`mailto:${a.email}`,className:"text-sm text-blue-600 hover:underline flex items-center gap-1",children:[e.jsx(Ge,{className:"h-3.5 w-3.5"}),a.email]})})]},a.id)})})]}),e.jsx(Y,{open:W,onOpenChange:f,children:e.jsxs(J,{className:"sm:max-w-md",children:[e.jsx(ze,{children:e.jsx(qe,{children:p?"Edit Team Member":"Add Team Member"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"name",children:"Name"}),e.jsx(g,{id:"name",value:c.name,onChange:a=>m("name",a.target.value),placeholder:"Full name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"role",children:"Role / Position"}),e.jsx(g,{id:"role",value:c.role,onChange:a=>m("role",a.target.value),placeholder:"e.g. Product Manager"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"department",children:"Department"}),e.jsx(g,{id:"department",value:c.department,onChange:a=>m("department",a.target.value),placeholder:"e.g. Engineering"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"email",children:"Email"}),e.jsx(g,{id:"email",type:"email",value:c.email,onChange:a=>m("email",a.target.value),placeholder:"Email address"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"phone",children:"Phone"}),e.jsx(g,{id:"phone",type:"tel",value:c.phone,onChange:a=>m("phone",a.target.value),placeholder:"Phone number"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"availability",children:"Availability"}),e.jsxs(Xe,{value:c.availability,onValueChange:a=>m("availability",a),children:[e.jsx(Ze,{children:e.jsx(ea,{placeholder:"Select availability"})}),e.jsxs(aa,{children:[e.jsx(A,{value:"full_time",children:"Full-time"}),e.jsx(A,{value:"part_time",children:"Part-time"}),e.jsx(A,{value:"contractor",children:"Contractor"}),e.jsx(A,{value:"remote",children:"Remote"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"skills",children:"Skills"}),e.jsx(ra,{value:c.skills||[],onChange:a=>m("skills",a),placeholder:"Enter skills, press Enter or comma to add"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Press Enter or comma after each skill"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"avatar",children:"Avatar URL (optional)"}),e.jsx(g,{id:"avatar",value:c.avatar,onChange:a=>m("avatar",a.target.value),placeholder:"https://example.com/avatar.jpg"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"notes",children:"Notes"}),e.jsx(We,{id:"notes",value:c.notes,onChange:a=>m("notes",a.target.value),placeholder:"Additional information about this team member",rows:3})]})]}),e.jsxs(He,{children:[e.jsx(C,{variant:"outline",onClick:()=>f(!1),children:"Cancel"}),e.jsx(C,{onClick:ae,children:p?"Update":"Add"})]})]})}),P&&e.jsx(De,{componentName:"Team Member Deletion Dialog",children:e.jsx(r.Suspense,{fallback:e.jsx(Y,{open:P,onOpenChange:y,children:e.jsx(J,{children:e.jsx(Te,{})})}),children:e.jsx(ia,{open:P,onOpenChange:y,teamMember:Z,onConfirm:te,onCancel:le})})})]})}export{ka as default};
